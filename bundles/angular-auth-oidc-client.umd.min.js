!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common"),require("@angular/http"),require("rxjs/add/operator/map"),require("rxjs/add/operator/catch"),require("rxjs/add/observable/throw"),require("rxjs/add/observable/interval"),require("rxjs/add/observable/timer"),require("@angular/router"),require("jsrsasign")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@angular/common","@angular/http","rxjs/add/operator/map","rxjs/add/operator/catch","rxjs/add/observable/throw","rxjs/add/observable/interval","rxjs/add/observable/timer","@angular/router","jsrsasign"],e):e(t.angularAuthOidcClient={},t.ng.core,t.ng.common,t.ng.http,t.Rx.Observable.prototype,t.Rx.Observable.prototype,t.Rx.Observable,t.Rx.Observable.prototype,t.Rx.Observable.prototype,t.ng.router,t.jsrsasign)}(this,function(t,e,r,i,n,o,s,c,u,a,h){"use strict";function l(t,e){return e={exports:{}},t(e,e.exports),e.exports}function p(){try{return $.apply(this,arguments)}catch(t){return it.errorObject.e=t,it.errorObject}}function f(t){return t.reduce(function(t,e){return t.concat(e instanceof st.UnsubscriptionError?e.errors:e)},[])}function d(t){return t?1===t.length?t[0]:function(e){return t.reduce(function(t,e){return e(t)},e)}:mt.noop}function b(t){var e=t.value,r=t.subject;r.next(e),r.complete()}function y(t){var e=t.err;t.subject.error(e)}function m(t){var e=this,r=t.source,i=t.subscriber,n=t.context,o=r,s=o.callbackFunc,c=o.args,u=o.scheduler,a=r.subject;if(!a){a=r.subject=new At.AsyncSubject;var h=function t(){for(var r=[],i=0;i<arguments.length;i++)r[i-0]=arguments[i];var n=t.source,o=n.selector,s=n.subject,c=r.shift();if(c)e.add(u.schedule(_,0,{err:c,subject:s}));else if(o){var a=nt.tryCatch(o).apply(this,r);a===it.errorObject?e.add(u.schedule(_,0,{err:it.errorObject.e,subject:s})):e.add(u.schedule(v,0,{value:a,subject:s}))}else{var h=r.length<=1?r[0]:r;e.add(u.schedule(v,0,{value:h,subject:s}))}};h.source=r;nt.tryCatch(s).apply(n,c.concat(h))===it.errorObject&&e.add(u.schedule(_,0,{err:it.errorObject.e,subject:a}))}e.add(a.subscribe(i))}function v(t){var e=t.value,r=t.subject;r.next(e),r.complete()}function _(t){var e=t.err;t.subject.error(e)}function g(t){var e=t.value,r=t.subscriber;r.closed||(r.next(e),r.complete())}function w(t){var e=t.err,r=t.subscriber;r.closed||r.error(e)}function S(t){var e=+t.length;return isNaN(e)?0:0!==e&&function(t){return"number"==typeof t&&Z.root.isFinite(t)}(e)?(e=function(t){var e=+t;if(0===e)return e;if(isNaN(e))return e;return e<0?-1:1}(e)*Math.floor(Math.abs(e)))<=0?0:e>fe?fe:e:e}function O(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var r=Number.POSITIVE_INFINITY,i=null,n=t[t.length-1];return zt.isScheduler(n)?(i=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(r=t.pop())):"number"==typeof n&&(r=t.pop()),null===i&&1===t.length&&t[0]instanceof _t.Observable?t[0]:De.mergeAll(r)(new qt.ArrayObservable(t,i))}function x(t){var e=t.obj,r=t.keys,i=t.length,n=t.index,o=t.subscriber;if(n!==i){var s=r[n];o.next([s,e[s]]),t.index=n+1,this.schedule(t)}else o.complete()}function C(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var r=t[t.length-1];return"function"==typeof r&&t.pop(),new qt.ArrayObservable(t).lift(new $r(r))}function k(t,e){return void 0===e&&(e=null),new wi({method:"GET",url:t,headers:e})}function j(t,e,r){return new wi({method:"POST",url:t,body:e,headers:r})}function I(t,e){return new wi({method:"DELETE",url:t,headers:e})}function T(t,e,r){return new wi({method:"PUT",url:t,body:e,headers:r})}function E(t,e,r){return new wi({method:"PATCH",url:t,body:e,headers:r})}function P(t,e){return _i(new wi({method:"GET",url:t,responseType:"json",headers:e}))}function A(t,e){switch(t){case"json":return"response"in e?e.responseType?e.response:JSON.parse(e.response||e.responseText||"null"):JSON.parse(e.responseText||"null");case"xml":return e.responseXML;case"text":default:return"response"in e?e.response:e.responseText}}function N(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];for(var i=e.length,n=0;n<i;n++){var o=e[n];for(var s in o)o.hasOwnProperty(s)&&(t[s]=o[s])}return t}function F(t){return t.Object.assign||N}function V(t){var e=t.subscriber,r=t.context;r&&e.closeContext(r),e.closed||(t.context=e.openContext(),t.context.closeAction=this.schedule(t,t.bufferTimeSpan))}function D(t){var e=t.bufferCreationInterval,r=t.bufferTimeSpan,i=t.subscriber,n=t.scheduler,o=i.openContext();i.closed||(i.add(o.closeAction=n.schedule(z,r,{subscriber:i,context:o})),this.schedule(t,e))}function z(t){var e=t.subscriber,r=t.context;e.closeContext(r)}function R(t){t.debouncedNext()}function W(){return function(){function t(){this._values=[]}return t.prototype.add=function(t){this.has(t)||this._values.push(t)},t.prototype.has=function(t){return-1!==this._values.indexOf(t)},Object.defineProperty(t.prototype,"size",{get:function(){return this._values.length},enumerable:!0,configurable:!0}),t.prototype.clear=function(){this._values.length=0},t}()}function M(t){var e=t.subscriber,r=t.period;e.notifyNext(),this.schedule(t,r)}function L(){return new Et.Subject}function U(t){t.subscriber.clearThrottle()}function q(t,e,r){return t.push(e),t}function B(t){var e=t.subscriber,r=t.windowTimeSpan,i=t.window;i&&e.closeWindow(i),t.window=e.openWindow(),this.schedule(t,r)}function K(t){var e=t.windowTimeSpan,r=t.subscriber,i=t.scheduler,n=t.windowCreationInterval,o={action:this,subscription:null},s={subscriber:r,window:r.openWindow(),context:o};o.subscription=i.schedule(H,e,s),this.add(o.subscription),this.schedule(t,n)}function H(t){var e=t.subscriber,r=t.window,i=t.context;i&&i.action&&i.subscription&&i.action.remove(i.subscription),e.closeWindow(r)}var Y="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},G="undefined"!=typeof window&&window,J="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,X=G||void 0!==Y&&Y||J,Q=X;!function(){if(!X)throw new Error("RxJS could not find any global context (window, self, global)")}();var $,Z={root:Q},tt={isFunction:function(t){return"function"==typeof t}},et={isArray:Array.isArray||function(t){return t&&"number"==typeof t.length}},rt={isObject:function(t){return null!=t&&"object"==typeof t}},it={errorObject:{e:{}}},nt={tryCatch:function(t){return $=t,p}},ot=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},st={UnsubscriptionError:function(t){function e(e){t.call(this),this.errors=e;var r=Error.call(this,e?e.length+" errors occurred during unsubscription:\n  "+e.map(function(t,e){return e+1+") "+t.toString()}).join("\n  "):"");this.name=r.name="UnsubscriptionError",this.stack=r.stack,this.message=r.message}return ot(e,t),e}(Error)},ct={Subscription:function(){function t(t){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}return t.prototype.unsubscribe=function(){var t,e=!1;if(!this.closed){var r=this._parent,i=this._parents,n=this._unsubscribe,o=this._subscriptions;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;for(var s=-1,c=i?i.length:0;r;)r.remove(this),r=++s<c&&i[s]||null;if(tt.isFunction(n)){nt.tryCatch(n).call(this)===it.errorObject&&(e=!0,t=t||(it.errorObject.e instanceof st.UnsubscriptionError?f(it.errorObject.e.errors):[it.errorObject.e]))}if(et.isArray(o))for(s=-1,c=o.length;++s<c;){var u=o[s];if(rt.isObject(u)){if(nt.tryCatch(u.unsubscribe).call(u)===it.errorObject){e=!0,t=t||[];var a=it.errorObject.e;a instanceof st.UnsubscriptionError?t=t.concat(f(a.errors)):t.push(a)}}}if(e)throw new st.UnsubscriptionError(t)}},t.prototype.add=function(e){if(!e||e===t.EMPTY)return t.EMPTY;if(e===this)return this;var r=e;switch(typeof e){case"function":r=new t(e);case"object":if(r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if("function"!=typeof r._addParent){var i=r;(r=new t)._subscriptions=[i]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}return(this._subscriptions||(this._subscriptions=[])).push(r),r._addParent(this),r},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var r=e.indexOf(t);-1!==r&&e.splice(r,1)}},t.prototype._addParent=function(t){var e=this._parent,r=this._parents;e&&e!==t?r?-1===r.indexOf(t)&&r.push(t):this._parents=[t]:this._parent=t},t.EMPTY=function(t){return t.closed=!0,t}(new t),t}()},ut={empty:{closed:!0,next:function(t){},error:function(t){throw t},complete:function(){}}},at=l(function(t,e){var r=Z.root.Symbol;e.rxSubscriber="function"==typeof r&&"function"==typeof r.for?r.for("rxSubscriber"):"@@rxSubscriber",e.$$rxSubscriber=e.rxSubscriber}),ht=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},lt=function(t){function e(r,i,n){switch(t.call(this),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=ut.empty;break;case 1:if(!r){this.destination=ut.empty;break}if("object"==typeof r){r instanceof e?(this.destination=r,this.destination.add(this)):(this.syncErrorThrowable=!0,this.destination=new ft(this,r));break}default:this.syncErrorThrowable=!0,this.destination=new ft(this,r,i,n)}}return ht(e,t),e.prototype[at.rxSubscriber]=function(){return this},e.create=function(t,r,i){var n=new e(t,r,i);return n.syncErrorThrowable=!1,n},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parent,e=this._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=t,this._parents=e,this},e}(ct.Subscription),pt=lt,ft=function(t){function e(e,r,i,n){t.call(this),this._parentSubscriber=e;var o,s=this;tt.isFunction(r)?o=r:r&&(o=r.next,i=r.error,n=r.complete,r!==ut.empty&&(s=Object.create(r),tt.isFunction(s.unsubscribe)&&this.add(s.unsubscribe.bind(s)),s.unsubscribe=this.unsubscribe.bind(this))),this._context=s,this._next=o,this._error=i,this._complete=n}return ht(e,t),e.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber;if(this._error)e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else{if(!e.syncErrorThrowable)throw this.unsubscribe(),t;e.syncErrorValue=t,e.syncErrorThrown=!0,this.unsubscribe()}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var r=function(){return t._complete.call(t._context)};e.syncErrorThrowable?(this.__tryOrSetError(e,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){throw this.unsubscribe(),t}},e.prototype.__tryOrSetError=function(t,e,r){try{e.call(this._context,r)}catch(e){return t.syncErrorValue=e,t.syncErrorThrown=!0,!0}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(lt),dt={Subscriber:pt},bt={toSubscriber:function(t,e,r){if(t){if(t instanceof dt.Subscriber)return t;if(t[at.rxSubscriber])return t[at.rxSubscriber]()}return t||e||r?new dt.Subscriber(t,e,r):new dt.Subscriber(ut.empty)}},yt=l(function(t,e){function r(t){var e,r=t.Symbol;return"function"==typeof r?r.observable?e=r.observable:(e=r("observable"),r.observable=e):e="@@observable",e}e.getSymbolObservable=r,e.observable=r(Z.root),e.$$observable=e.observable}),mt={noop:function(){}},vt={pipe:function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return d(t)},pipeFromArray:d},_t={Observable:function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var r=new t;return r.source=this,r.operator=e,r},t.prototype.subscribe=function(t,e,r){var i=this.operator,n=bt.toSubscriber(t,e,r);if(i?i.call(n,this.source):n.add(this.source?this._subscribe(n):this._trySubscribe(n)),n.syncErrorThrowable&&(n.syncErrorThrowable=!1,n.syncErrorThrown))throw n.syncErrorValue;return n},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){t.syncErrorThrown=!0,t.syncErrorValue=e,t.error(e)}},t.prototype.forEach=function(t,e){var r=this;if(e||(Z.root.Rx&&Z.root.Rx.config&&Z.root.Rx.config.Promise?e=Z.root.Rx.config.Promise:Z.root.Promise&&(e=Z.root.Promise)),!e)throw new Error("no Promise impl found");return new e(function(e,i){var n;n=r.subscribe(function(e){if(n)try{t(e)}catch(t){i(t),n.unsubscribe()}else t(e)},i,e)})},t.prototype._subscribe=function(t){return this.source.subscribe(t)},t.prototype[yt.observable]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return 0===t.length?this:vt.pipeFromArray(t)(this)},t.prototype.toPromise=function(t){var e=this;if(t||(Z.root.Rx&&Z.root.Rx.config&&Z.root.Rx.config.Promise?t=Z.root.Rx.config.Promise:Z.root.Promise&&(t=Z.root.Promise)),!t)throw new Error("no Promise impl found");return new t(function(t,r){var i;e.subscribe(function(t){return i=t},function(t){return r(t)},function(){return t(i)})})},t.create=function(e){return new t(e)},t}()},gt=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},wt={ObjectUnsubscribedError:function(t){function e(){var e=t.call(this,"object unsubscribed");this.name=e.name="ObjectUnsubscribedError",this.stack=e.stack,this.message=e.message}return gt(e,t),e}(Error)},St=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Ot={SubjectSubscription:function(t){function e(e,r){t.call(this),this.subject=e,this.subscriber=r,this.closed=!1}return St(e,t),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var r=e.indexOf(this.subscriber);-1!==r&&e.splice(r,1)}}},e}(ct.Subscription)},xt=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Ct=function(t){function e(e){t.call(this,e),this.destination=e}return xt(e,t),e}(dt.Subscriber),kt=Ct,jt=function(t){function e(){t.call(this),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}return xt(e,t),e.prototype[at.rxSubscriber]=function(){return new Ct(this)},e.prototype.lift=function(t){var e=new Tt(this,this);return e.operator=t,e},e.prototype.next=function(t){if(this.closed)throw new wt.ObjectUnsubscribedError;if(!this.isStopped)for(var e=this.observers,r=e.length,i=e.slice(),n=0;n<r;n++)i[n].next(t)},e.prototype.error=function(t){if(this.closed)throw new wt.ObjectUnsubscribedError;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,r=e.length,i=e.slice(),n=0;n<r;n++)i[n].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new wt.ObjectUnsubscribedError;this.isStopped=!0;for(var t=this.observers,e=t.length,r=t.slice(),i=0;i<e;i++)r[i].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(e){if(this.closed)throw new wt.ObjectUnsubscribedError;return t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){if(this.closed)throw new wt.ObjectUnsubscribedError;return this.hasError?(t.error(this.thrownError),ct.Subscription.EMPTY):this.isStopped?(t.complete(),ct.Subscription.EMPTY):(this.observers.push(t),new Ot.SubjectSubscription(this,t))},e.prototype.asObservable=function(){var t=new _t.Observable;return t.source=this,t},e.create=function(t,e){return new Tt(t,e)},e}(_t.Observable),It=jt,Tt=function(t){function e(e,r){t.call(this),this.destination=e,this.source=r}return xt(e,t),e.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},e.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):ct.Subscription.EMPTY},e}(jt),Et={SubjectSubscriber:kt,Subject:It,AnonymousSubject:Tt},Pt=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},At={AsyncSubject:function(t){function e(){t.apply(this,arguments),this.value=null,this.hasNext=!1,this.hasCompleted=!1}return Pt(e,t),e.prototype._subscribe=function(e){return this.hasError?(e.error(this.thrownError),ct.Subscription.EMPTY):this.hasCompleted&&this.hasNext?(e.next(this.value),e.complete(),ct.Subscription.EMPTY):t.prototype._subscribe.call(this,e)},e.prototype.next=function(t){this.hasCompleted||(this.value=t,this.hasNext=!0)},e.prototype.error=function(e){this.hasCompleted||t.prototype.error.call(this,e)},e.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&t.prototype.next.call(this,this.value),t.prototype.complete.call(this)},e}(Et.Subject)},Nt=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Ft={bindCallback:{BoundCallbackObservable:function(t){function e(e,r,i,n,o){t.call(this),this.callbackFunc=e,this.selector=r,this.args=i,this.context=n,this.scheduler=o}return Nt(e,t),e.create=function(t,r,i){return void 0===r&&(r=void 0),function(){for(var n=[],o=0;o<arguments.length;o++)n[o-0]=arguments[o];return new e(t,r,n,this,i)}},e.prototype._subscribe=function(t){var r=this.callbackFunc,i=this.args,n=this.scheduler,o=this.subject;if(n)return n.schedule(e.dispatch,0,{source:this,subscriber:t,context:this.context});if(!o){o=this.subject=new At.AsyncSubject;var s=function t(){for(var e=[],r=0;r<arguments.length;r++)e[r-0]=arguments[r];var i=t.source,n=i.selector,o=i.subject;if(n){var s=nt.tryCatch(n).apply(this,e);s===it.errorObject?o.error(it.errorObject.e):(o.next(s),o.complete())}else o.next(e.length<=1?e[0]:e),o.complete()};s.source=this;nt.tryCatch(r).apply(this.context,i.concat(s))===it.errorObject&&o.error(it.errorObject.e)}return o.subscribe(t)},e.dispatch=function(t){var e=this,r=t.source,i=t.subscriber,n=t.context,o=r.callbackFunc,s=r.args,c=r.scheduler,u=r.subject;if(!u){u=r.subject=new At.AsyncSubject;var a=function t(){for(var r=[],i=0;i<arguments.length;i++)r[i-0]=arguments[i];var n=t.source,o=n.selector,s=n.subject;if(o){var u=nt.tryCatch(o).apply(this,r);u===it.errorObject?e.add(c.schedule(y,0,{err:it.errorObject.e,subject:s})):e.add(c.schedule(b,0,{value:u,subject:s}))}else{var a=r.length<=1?r[0]:r;e.add(c.schedule(b,0,{value:a,subject:s}))}};a.source=r;nt.tryCatch(o).apply(n,s.concat(a))===it.errorObject&&u.error(it.errorObject.e)}e.add(u.subscribe(i))},e}(_t.Observable)}.BoundCallbackObservable.create};_t.Observable.bindCallback=Ft.bindCallback;var Vt=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Dt={bindNodeCallback:{BoundNodeCallbackObservable:function(t){function e(e,r,i,n,o){t.call(this),this.callbackFunc=e,this.selector=r,this.args=i,this.context=n,this.scheduler=o}return Vt(e,t),e.create=function(t,r,i){return void 0===r&&(r=void 0),function(){for(var n=[],o=0;o<arguments.length;o++)n[o-0]=arguments[o];return new e(t,r,n,this,i)}},e.prototype._subscribe=function(t){var e=this.callbackFunc,r=this.args,i=this.scheduler,n=this.subject;if(i)return i.schedule(m,0,{source:this,subscriber:t,context:this.context});if(!n){n=this.subject=new At.AsyncSubject;var o=function t(){for(var e=[],r=0;r<arguments.length;r++)e[r-0]=arguments[r];var i=t.source,n=i.selector,o=i.subject,s=e.shift();if(s)o.error(s);else if(n){var c=nt.tryCatch(n).apply(this,e);c===it.errorObject?o.error(it.errorObject.e):(o.next(c),o.complete())}else o.next(e.length<=1?e[0]:e),o.complete()};o.source=this;nt.tryCatch(e).apply(this.context,r.concat(o))===it.errorObject&&n.error(it.errorObject.e)}return n.subscribe(t)},e}(_t.Observable)}.BoundNodeCallbackObservable.create};_t.Observable.bindNodeCallback=Dt.bindNodeCallback;var zt={isScheduler:function(t){return t&&"function"==typeof t.schedule}},Rt=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Wt={ScalarObservable:function(t){function e(e,r){t.call(this),this.value=e,this.scheduler=r,this._isScalar=!0,r&&(this._isScalar=!1)}return Rt(e,t),e.create=function(t,r){return new e(t,r)},e.dispatch=function(t){var e=t.done,r=t.value,i=t.subscriber;e?i.complete():(i.next(r),i.closed||(t.done=!0,this.schedule(t)))},e.prototype._subscribe=function(t){var r=this.value,i=this.scheduler;if(i)return i.schedule(e.dispatch,0,{done:!1,value:r,subscriber:t});t.next(r),t.closed||t.complete()},e}(_t.Observable)},Mt=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Lt={EmptyObservable:function(t){function e(e){t.call(this),this.scheduler=e}return Mt(e,t),e.create=function(t){return new e(t)},e.dispatch=function(t){t.subscriber.complete()},e.prototype._subscribe=function(t){var r=this.scheduler;if(r)return r.schedule(e.dispatch,0,{subscriber:t});t.complete()},e}(_t.Observable)},Ut=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},qt={ArrayObservable:function(t){function e(e,r){t.call(this),this.array=e,this.scheduler=r,r||1!==e.length||(this._isScalar=!0,this.value=e[0])}return Ut(e,t),e.create=function(t,r){return new e(t,r)},e.of=function(){for(var t=[],r=0;r<arguments.length;r++)t[r-0]=arguments[r];var i=t[t.length-1];zt.isScheduler(i)?t.pop():i=null;var n=t.length;return n>1?new e(t,i):1===n?new Wt.ScalarObservable(t[0],i):new Lt.EmptyObservable(i)},e.dispatch=function(t){var e=t.array,r=t.index,i=t.count,n=t.subscriber;r>=i?n.complete():(n.next(e[r]),n.closed||(t.index=r+1,this.schedule(t)))},e.prototype._subscribe=function(t){var r=this.array,i=r.length,n=this.scheduler;if(n)return n.schedule(e.dispatch,0,{array:r,index:0,count:i,subscriber:t});for(var o=0;o<i&&!t.closed;o++)t.next(r[o]);t.complete()},e}(_t.Observable)},Bt=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Kt={OuterSubscriber:function(t){function e(){t.apply(this,arguments)}return Bt(e,t),e.prototype.notifyNext=function(t,e,r,i,n){this.destination.next(e)},e.prototype.notifyError=function(t,e){this.destination.error(t)},e.prototype.notifyComplete=function(t){this.destination.complete()},e}(dt.Subscriber)},Ht={isArrayLike:function(t){return t&&"number"==typeof t.length}},Yt={isPromise:function(t){return t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}},Gt=l(function(t,e){function r(t){var e=t.Symbol;if("function"==typeof e)return e.iterator||(e.iterator=e("iterator polyfill")),e.iterator;var r=t.Set;if(r&&"function"==typeof(new r)["@@iterator"])return"@@iterator";var i=t.Map;if(i)for(var n=Object.getOwnPropertyNames(i.prototype),o=0;o<n.length;++o){var s=n[o];if("entries"!==s&&"size"!==s&&i.prototype[s]===i.prototype.entries)return s}return"@@iterator"}e.symbolIteratorPonyfill=r,e.iterator=r(Z.root),e.$$iterator=e.iterator}),Jt=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Xt={InnerSubscriber:function(t){function e(e,r,i){t.call(this),this.parent=e,this.outerValue=r,this.outerIndex=i,this.index=0}return Jt(e,t),e.prototype._next=function(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)},e.prototype._error=function(t){this.parent.notifyError(t,this),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},e}(dt.Subscriber)},Qt={subscribeToResult:function(t,e,r,i){var n=new Xt.InnerSubscriber(t,r,i);if(n.closed)return null;if(e instanceof _t.Observable)return e._isScalar?(n.next(e.value),n.complete(),null):(n.syncErrorThrowable=!0,e.subscribe(n));if(Ht.isArrayLike(e)){for(var o=0,s=e.length;o<s&&!n.closed;o++)n.next(e[o]);n.closed||n.complete()}else{if(Yt.isPromise(e))return e.then(function(t){n.closed||(n.next(t),n.complete())},function(t){return n.error(t)}).then(null,function(t){Z.root.setTimeout(function(){throw t})}),n;if(e&&"function"==typeof e[Gt.iterator])for(var c=e[Gt.iterator]();;){var u=c.next();if(u.done){n.complete();break}if(n.next(u.value),n.closed)break}else if(e&&"function"==typeof e[yt.observable]){var a=e[yt.observable]();if("function"==typeof a.subscribe)return a.subscribe(new Xt.InnerSubscriber(t,r,i));n.error(new TypeError("Provided object does not correctly implement Symbol.observable"))}else{var h="You provided "+(rt.isObject(e)?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.";n.error(new TypeError(h))}}return null}},$t=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Zt={},te=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var r=null;return"function"==typeof t[t.length-1]&&(r=t.pop()),1===t.length&&et.isArray(t[0])&&(t=t[0].slice()),function(e){return e.lift.call(new qt.ArrayObservable([e].concat(t)),new ee(r))}},ee=function(){function t(t){this.project=t}return t.prototype.call=function(t,e){return e.subscribe(new ie(t,this.project))},t}(),re=ee,ie=function(t){function e(e,r){t.call(this,e),this.project=r,this.active=0,this.values=[],this.observables=[]}return $t(e,t),e.prototype._next=function(t){this.values.push(Zt),this.observables.push(t)},e.prototype._complete=function(){var t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(var r=0;r<e;r++){var i=t[r];this.add(Qt.subscribeToResult(this,i,i,r))}}},e.prototype.notifyComplete=function(t){0==(this.active-=1)&&this.destination.complete()},e.prototype.notifyNext=function(t,e,r,i,n){var o=this.values,s=o[r],c=this.toRespond?s===Zt?--this.toRespond:this.toRespond:0;o[r]=e,0===c&&(this.project?this._tryProject(o):this.destination.next(o.slice()))},e.prototype._tryProject=function(t){var e;try{e=this.project.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(Kt.OuterSubscriber),ne={combineLatest:te,CombineLatestOperator:re,CombineLatestSubscriber:ie},oe={combineLatest:function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var r=null,i=null;return zt.isScheduler(t[t.length-1])&&(i=t.pop()),"function"==typeof t[t.length-1]&&(r=t.pop()),1===t.length&&et.isArray(t[0])&&(t=t[0]),new qt.ArrayObservable(t,i).lift(new ne.CombineLatestOperator(r))}};_t.Observable.combineLatest=oe.combineLatest;var se={of:qt.ArrayObservable.of},ce=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},ue={PromiseObservable:function(t){function e(e,r){t.call(this),this.promise=e,this.scheduler=r}return ce(e,t),e.create=function(t,r){return new e(t,r)},e.prototype._subscribe=function(t){var e=this,r=this.promise,i=this.scheduler;if(null==i)this._isScalar?t.closed||(t.next(this.value),t.complete()):r.then(function(r){e.value=r,e._isScalar=!0,t.closed||(t.next(r),t.complete())},function(e){t.closed||t.error(e)}).then(null,function(t){Z.root.setTimeout(function(){throw t})});else if(this._isScalar){if(!t.closed)return i.schedule(g,0,{value:this.value,subscriber:t})}else r.then(function(r){e.value=r,e._isScalar=!0,t.closed||t.add(i.schedule(g,0,{value:r,subscriber:t}))},function(e){t.closed||t.add(i.schedule(w,0,{err:e,subscriber:t}))}).then(null,function(t){Z.root.setTimeout(function(){throw t})})},e}(_t.Observable)},ae=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},he=function(t){function e(e,r){if(t.call(this),this.scheduler=r,null==e)throw new Error("iterator cannot be null.");this.iterator=function(t){var e=t[Gt.iterator];if(!e&&"string"==typeof t)return new le(t);if(!e&&void 0!==t.length)return new pe(t);if(!e)throw new TypeError("object is not iterable");return t[Gt.iterator]()}(e)}return ae(e,t),e.create=function(t,r){return new e(t,r)},e.dispatch=function(t){var e=t.index,r=t.hasError,i=t.iterator,n=t.subscriber;if(r)n.error(t.error);else{var o=i.next();o.done?n.complete():(n.next(o.value),t.index=e+1,n.closed?"function"==typeof i.return&&i.return():this.schedule(t))}},e.prototype._subscribe=function(t){var r=this.iterator,i=this.scheduler;if(i)return i.schedule(e.dispatch,0,{index:0,iterator:r,subscriber:t});for(;;){var n=r.next();if(n.done){t.complete();break}if(t.next(n.value),t.closed){"function"==typeof r.return&&r.return();break}}},e}(_t.Observable),le=function(){function t(t,e,r){void 0===e&&(e=0),void 0===r&&(r=t.length),this.str=t,this.idx=e,this.len=r}return t.prototype[Gt.iterator]=function(){return this},t.prototype.next=function(){return this.idx<this.len?{done:!1,value:this.str.charAt(this.idx++)}:{done:!0,value:void 0}},t}(),pe=function(){function t(t,e,r){void 0===e&&(e=0),void 0===r&&(r=S(t)),this.arr=t,this.idx=e,this.len=r}return t.prototype[Gt.iterator]=function(){return this},t.prototype.next=function(){return this.idx<this.len?{done:!1,value:this.arr[this.idx++]}:{done:!0,value:void 0}},t}(),fe=Math.pow(2,53)-1,de={IteratorObservable:he},be=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},ye={ArrayLikeObservable:function(t){function e(e,r){t.call(this),this.arrayLike=e,this.scheduler=r,r||1!==e.length||(this._isScalar=!0,this.value=e[0])}return be(e,t),e.create=function(t,r){var i=t.length;return 0===i?new Lt.EmptyObservable:1===i?new Wt.ScalarObservable(t[0],r):new e(t,r)},e.dispatch=function(t){var e=t.arrayLike,r=t.index,i=t.length,n=t.subscriber;n.closed||(r>=i?n.complete():(n.next(e[r]),t.index=r+1,this.schedule(t)))},e.prototype._subscribe=function(t){var r=this.arrayLike,i=this.scheduler,n=r.length;if(i)return i.schedule(e.dispatch,0,{arrayLike:r,index:0,length:n,subscriber:t});for(var o=0;o<n&&!t.closed;o++)t.next(r[o]);t.complete()},e}(_t.Observable)},me={Notification:function(){function t(t,e,r){this.kind=t,this.value=e,this.error=r,this.hasValue="N"===t}return t.prototype.observe=function(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}},t.prototype.do=function(t,e,r){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return r&&r()}},t.prototype.accept=function(t,e,r){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,r)},t.prototype.toObservable=function(){switch(this.kind){case"N":return _t.Observable.of(this.value);case"E":return _t.Observable.throw(this.error);case"C":return _t.Observable.empty()}throw new Error("unexpected notification kind value")},t.createNext=function(e){return void 0!==e?new t("N",e):t.undefinedValueNotification},t.createError=function(e){return new t("E",void 0,e)},t.createComplete=function(){return t.completeNotification},t.completeNotification=new t("C"),t.undefinedValueNotification=new t("N",void 0),t}()},ve=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},_e=function(t,e){return void 0===e&&(e=0),function(r){return r.lift(new ge(t,e))}},ge=function(){function t(t,e){void 0===e&&(e=0),this.scheduler=t,this.delay=e}return t.prototype.call=function(t,e){return e.subscribe(new Se(t,this.scheduler,this.delay))},t}(),we=ge,Se=function(t){function e(e,r,i){void 0===i&&(i=0),t.call(this,e),this.scheduler=r,this.delay=i}return ve(e,t),e.dispatch=function(t){var e=t.notification,r=t.destination;e.observe(r),this.unsubscribe()},e.prototype.scheduleMessage=function(t){this.add(this.scheduler.schedule(e.dispatch,this.delay,new xe(t,this.destination)))},e.prototype._next=function(t){this.scheduleMessage(me.Notification.createNext(t))},e.prototype._error=function(t){this.scheduleMessage(me.Notification.createError(t))},e.prototype._complete=function(){this.scheduleMessage(me.Notification.createComplete())},e}(dt.Subscriber),Oe=Se,xe=function(){return function(t,e){this.notification=t,this.destination=e}}(),Ce={observeOn:_e,ObserveOnOperator:we,ObserveOnSubscriber:Oe,ObserveOnMessage:xe},ke=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},je={FromObservable:function(t){function e(e,r){t.call(this,null),this.ish=e,this.scheduler=r}return ke(e,t),e.create=function(t,r){if(null!=t){if("function"==typeof t[yt.observable])return t instanceof _t.Observable&&!r?t:new e(t,r);if(et.isArray(t))return new qt.ArrayObservable(t,r);if(Yt.isPromise(t))return new ue.PromiseObservable(t,r);if("function"==typeof t[Gt.iterator]||"string"==typeof t)return new de.IteratorObservable(t,r);if(Ht.isArrayLike(t))return new ye.ArrayLikeObservable(t,r)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")},e.prototype._subscribe=function(t){var e=this.ish,r=this.scheduler;return null==r?e[yt.observable]().subscribe(t):e[yt.observable]().subscribe(new Ce.ObserveOnSubscriber(t,r,0))},e}(_t.Observable)},Ie={from:je.FromObservable.create},Te=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Ee=function(t,e,r){return void 0===r&&(r=Number.POSITIVE_INFINITY),function(i){return"number"==typeof e&&(r=e,e=null),i.lift(new Pe(t,e,r))}},Pe=function(){function t(t,e,r){void 0===r&&(r=Number.POSITIVE_INFINITY),this.project=t,this.resultSelector=e,this.concurrent=r}return t.prototype.call=function(t,e){return e.subscribe(new Ne(t,this.project,this.resultSelector,this.concurrent))},t}(),Ae=Pe,Ne=function(t){function e(e,r,i,n){void 0===n&&(n=Number.POSITIVE_INFINITY),t.call(this,e),this.project=r,this.resultSelector=i,this.concurrent=n,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}return Te(e,t),e.prototype._next=function(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)},e.prototype._tryNext=function(t){var e,r=this.index++;try{e=this.project(t,r)}catch(t){return void this.destination.error(t)}this.active++,this._innerSub(e,t,r)},e.prototype._innerSub=function(t,e,r){this.add(Qt.subscribeToResult(this,t,e,r))},e.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete()},e.prototype.notifyNext=function(t,e,r,i,n){this.resultSelector?this._notifyResultSelector(t,e,r,i):this.destination.next(e)},e.prototype._notifyResultSelector=function(t,e,r,i){var n;try{n=this.resultSelector(t,e,r,i)}catch(t){return void this.destination.error(t)}this.destination.next(n)},e.prototype.notifyComplete=function(t){var e=this.buffer;this.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},e}(Kt.OuterSubscriber),Fe={mergeMap:Ee,MergeMapOperator:Ae,MergeMapSubscriber:Ne},Ve={identity:function(t){return t}},De={mergeAll:function(t){return void 0===t&&(t=Number.POSITIVE_INFINITY),Fe.mergeMap(Ve.identity,null,t)}},ze={concatAll:function(){return De.mergeAll(1)}},Re={concat:function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return 1===t.length||2===t.length&&zt.isScheduler(t[1])?Ie.from(t[0]):ze.concatAll()(se.of.apply(void 0,t))}};_t.Observable.concat=Re.concat;var We=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Me=function(t){function e(e){t.call(this),this.observableFactory=e}return We(e,t),e.create=function(t){return new e(t)},e.prototype._subscribe=function(t){return new Le(t,this.observableFactory)},e}(_t.Observable),Le=function(t){function e(e,r){t.call(this,e),this.factory=r,this.tryDefer()}return We(e,t),e.prototype.tryDefer=function(){try{this._callFactory()}catch(t){this._error(t)}},e.prototype._callFactory=function(){var t=this.factory();t&&this.add(Qt.subscribeToResult(this,t))},e}(Kt.OuterSubscriber),Ue={defer:{DeferObservable:Me}.DeferObservable.create};_t.Observable.defer=Ue.defer;var qe={empty:Lt.EmptyObservable.create};_t.Observable.empty=qe.empty;var Be=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Ke=function(t){function e(e,r){t.call(this),this.sources=e,this.resultSelector=r}return Be(e,t),e.create=function(){for(var t=[],r=0;r<arguments.length;r++)t[r-0]=arguments[r];if(null===t||0===arguments.length)return new Lt.EmptyObservable;var i=null;return"function"==typeof t[t.length-1]&&(i=t.pop()),1===t.length&&et.isArray(t[0])&&(t=t[0]),0===t.length?new Lt.EmptyObservable:new e(t,i)},e.prototype._subscribe=function(t){return new He(t,this.sources,this.resultSelector)},e}(_t.Observable),He=function(t){function e(e,r,i){t.call(this,e),this.sources=r,this.resultSelector=i,this.completed=0,this.haveValues=0;var n=r.length;this.total=n,this.values=new Array(n);for(var o=0;o<n;o++){var s=r[o],c=Qt.subscribeToResult(this,s,null,o);c&&(c.outerIndex=o,this.add(c))}}return Be(e,t),e.prototype.notifyNext=function(t,e,r,i,n){this.values[r]=e,n._hasValue||(n._hasValue=!0,this.haveValues++)},e.prototype.notifyComplete=function(t){var e=this.destination,r=this.haveValues,i=this.resultSelector,n=this.values,o=n.length;if(t._hasValue){if(this.completed++,this.completed===o){if(r===o){var s=i?i.apply(this,n):n;e.next(s)}e.complete()}}else e.complete()},e}(Kt.OuterSubscriber),Ye={forkJoin:{ForkJoinObservable:Ke}.ForkJoinObservable.create};_t.Observable.forkJoin=Ye.forkJoin,_t.Observable.from=Ie.from;var Ge=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Je=Object.prototype.toString,Xe={fromEvent:{FromEventObservable:function(t){function e(e,r,i,n){t.call(this),this.sourceObj=e,this.eventName=r,this.selector=i,this.options=n}return Ge(e,t),e.create=function(t,r,i,n){return tt.isFunction(i)&&(n=i,i=void 0),new e(t,r,n,i)},e.setupSubscription=function(t,r,i,n,o){var s;if(function(t){return!!t&&"[object NodeList]"===Je.call(t)}(t)||function(t){return!!t&&"[object HTMLCollection]"===Je.call(t)}(t))for(var c=0,u=t.length;c<u;c++)e.setupSubscription(t[c],r,i,n,o);else if(function(t){return!!t&&"function"==typeof t.addEventListener&&"function"==typeof t.removeEventListener}(t)){var a=t;t.addEventListener(r,i,o),s=function(){return a.removeEventListener(r,i)}}else if(function(t){return!!t&&"function"==typeof t.on&&"function"==typeof t.off}(t)){var h=t;t.on(r,i),s=function(){return h.off(r,i)}}else{if(!function(t){return!!t&&"function"==typeof t.addListener&&"function"==typeof t.removeListener}(t))throw new TypeError("Invalid event target");var l=t;t.addListener(r,i),s=function(){return l.removeListener(r,i)}}n.add(new ct.Subscription(s))},e.prototype._subscribe=function(t){var r=this.sourceObj,i=this.eventName,n=this.options,o=this.selector;e.setupSubscription(r,i,o?function(){for(var e=[],r=0;r<arguments.length;r++)e[r-0]=arguments[r];var i=nt.tryCatch(o).apply(void 0,e);i===it.errorObject?t.error(it.errorObject.e):t.next(i)}:function(e){return t.next(e)},t,n)},e}(_t.Observable)}.FromEventObservable.create};_t.Observable.fromEvent=Xe.fromEvent;var Qe=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},$e={fromEventPattern:{FromEventPatternObservable:function(t){function e(e,r,i){t.call(this),this.addHandler=e,this.removeHandler=r,this.selector=i}return Qe(e,t),e.create=function(t,r,i){return new e(t,r,i)},e.prototype._subscribe=function(t){var e=this,r=this.removeHandler,i=this.selector?function(){for(var r=[],i=0;i<arguments.length;i++)r[i-0]=arguments[i];e._callSelector(t,r)}:function(e){t.next(e)},n=this._callAddHandler(i,t);tt.isFunction(r)&&t.add(new ct.Subscription(function(){r(i,n)}))},e.prototype._callSelector=function(t,e){try{var r=this.selector.apply(this,e);t.next(r)}catch(e){t.error(e)}},e.prototype._callAddHandler=function(t,e){try{return this.addHandler(t)||null}catch(t){e.error(t)}},e}(_t.Observable)}.FromEventPatternObservable.create};_t.Observable.fromEventPattern=$e.fromEventPattern;var Ze={fromPromise:ue.PromiseObservable.create};_t.Observable.fromPromise=Ze.fromPromise;var tr=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},er=function(t){return t},rr={generate:{GenerateObservable:function(t){function e(e,r,i,n,o){t.call(this),this.initialState=e,this.condition=r,this.iterate=i,this.resultSelector=n,this.scheduler=o}return tr(e,t),e.create=function(t,r,i,n,o){return 1==arguments.length?new e(t.initialState,t.condition,t.iterate,t.resultSelector||er,t.scheduler):void 0===n||zt.isScheduler(n)?new e(t,r,i,er,n):new e(t,r,i,n,o)},e.prototype._subscribe=function(t){var r=this.initialState;if(this.scheduler)return this.scheduler.schedule(e.dispatch,0,{subscriber:t,iterate:this.iterate,condition:this.condition,resultSelector:this.resultSelector,state:r});for(var i=this.condition,n=this.resultSelector,o=this.iterate;;){if(i){var s=void 0;try{s=i(r)}catch(e){return void t.error(e)}if(!s){t.complete();break}}var c=void 0;try{c=n(r)}catch(e){return void t.error(e)}if(t.next(c),t.closed)break;try{r=o(r)}catch(e){return void t.error(e)}}},e.dispatch=function(t){var e=t.subscriber,r=t.condition;if(!e.closed){if(t.needIterate)try{t.state=t.iterate(t.state)}catch(t){return void e.error(t)}else t.needIterate=!0;if(r){var i=void 0;try{i=r(t.state)}catch(t){return void e.error(t)}if(!i)return void e.complete();if(e.closed)return}var n;try{n=t.resultSelector(t.state)}catch(t){return void e.error(t)}if(!e.closed&&(e.next(n),!e.closed))return this.schedule(t)}},e}(_t.Observable)}.GenerateObservable.create};_t.Observable.generate=rr.generate;var ir=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},nr=function(t){function e(e,r,i){t.call(this),this.condition=e,this.thenSource=r,this.elseSource=i}return ir(e,t),e.create=function(t,r,i){return new e(t,r,i)},e.prototype._subscribe=function(t){var e=this.condition,r=this.thenSource,i=this.elseSource;return new or(t,e,r,i)},e}(_t.Observable),or=function(t){function e(e,r,i,n){t.call(this,e),this.condition=r,this.thenSource=i,this.elseSource=n,this.tryIf()}return ir(e,t),e.prototype.tryIf=function(){var t=this.condition,e=this.thenSource,r=this.elseSource;try{var i=t()?e:r;i?this.add(Qt.subscribeToResult(this,i)):this._complete()}catch(t){this._error(t)}},e}(Kt.OuterSubscriber),sr={_if:{IfObservable:nr}.IfObservable.create};_t.Observable.if=sr._if;var cr={isNumeric:function(t){return!et.isArray(t)&&t-parseFloat(t)+1>=0}},ur=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},ar={Action:function(t){function e(e,r){t.call(this)}return ur(e,t),e.prototype.schedule=function(t,e){return void 0===e&&(e=0),this},e}(ct.Subscription)},hr=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},lr={AsyncAction:function(t){function e(e,r){t.call(this,e,r),this.scheduler=e,this.work=r,this.pending=!1}return hr(e,t),e.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t,this.pending=!0;var r=this.id,i=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(i,r,e)),this.delay=e,this.id=this.id||this.requestAsyncId(i,this.id,e),this},e.prototype.requestAsyncId=function(t,e,r){return void 0===r&&(r=0),Z.root.setInterval(t.flush.bind(t,this),r)},e.prototype.recycleAsyncId=function(t,e,r){if(void 0===r&&(r=0),null!==r&&this.delay===r&&!1===this.pending)return e;Z.root.clearInterval(e)},e.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var r=this._execute(t,e);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,e){var r=!1,i=void 0;try{this.work(t)}catch(t){r=!0,i=!!t&&t||new Error(t)}if(r)return this.unsubscribe(),i},e.prototype._unsubscribe=function(){var t=this.id,e=this.scheduler,r=e.actions,i=r.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==i&&r.splice(i,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null},e}(ar.Action)},pr={Scheduler:function(){function t(e,r){void 0===r&&(r=t.now),this.SchedulerAction=e,this.now=r}return t.prototype.schedule=function(t,e,r){return void 0===e&&(e=0),new this.SchedulerAction(this,t).schedule(r,e)},t.now=Date.now?Date.now:function(){return+new Date},t}()},fr=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},dr={AsyncScheduler:function(t){function e(){t.apply(this,arguments),this.actions=[],this.active=!1,this.scheduled=void 0}return fr(e,t),e.prototype.flush=function(t){var e=this.actions;if(this.active)e.push(t);else{var r;this.active=!0;do{if(r=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,r){for(;t=e.shift();)t.unsubscribe();throw r}}},e}(pr.Scheduler)},br={async:new dr.AsyncScheduler(lr.AsyncAction)},yr=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mr={interval:{IntervalObservable:function(t){function e(e,r){void 0===e&&(e=0),void 0===r&&(r=br.async),t.call(this),this.period=e,this.scheduler=r,(!cr.isNumeric(e)||e<0)&&(this.period=0),r&&"function"==typeof r.schedule||(this.scheduler=br.async)}return yr(e,t),e.create=function(t,r){return void 0===t&&(t=0),void 0===r&&(r=br.async),new e(t,r)},e.dispatch=function(t){var e=t.index,r=t.subscriber,i=t.period;r.next(e),r.closed||(t.index+=1,this.schedule(t,i))},e.prototype._subscribe=function(t){var r=this.period,i=this.scheduler;t.add(i.schedule(e.dispatch,r,{index:0,subscriber:t,period:r}))},e}(_t.Observable)}.IntervalObservable.create};_t.Observable.interval=mr.interval;var vr={merge:function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return function(e){return e.lift.call(O.apply(void 0,[e].concat(t)))}},mergeStatic:O},_r={mergeStatic:vr.mergeStatic,merge:function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return vr.merge.apply(void 0,t)(this)}},gr={merge:_r.mergeStatic};_t.Observable.merge=gr.merge;var wr=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Sr=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];if(1===t.length){if(!et.isArray(t[0]))return t[0];t=t[0]}return new qt.ArrayObservable(t).lift(new Or)},Or=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new Cr(t))},t}(),xr=Or,Cr=function(t){function e(e){t.call(this,e),this.hasFirst=!1,this.observables=[],this.subscriptions=[]}return wr(e,t),e.prototype._next=function(t){this.observables.push(t)},e.prototype._complete=function(){var t=this.observables,e=t.length;if(0===e)this.destination.complete();else{for(var r=0;r<e&&!this.hasFirst;r++){var i=t[r],n=Qt.subscribeToResult(this,i,i,r);this.subscriptions&&this.subscriptions.push(n),this.add(n)}this.observables=null}},e.prototype.notifyNext=function(t,e,r,i,n){if(!this.hasFirst){this.hasFirst=!0;for(var o=0;o<this.subscriptions.length;o++)if(o!==r){var s=this.subscriptions[o];s.unsubscribe(),this.remove(s)}this.subscriptions=null}this.destination.next(e)},e}(Kt.OuterSubscriber),kr={race:Sr,RaceOperator:xr,RaceSubscriber:Cr};_t.Observable.race=kr.race;var jr=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Ir={never:{NeverObservable:function(t){function e(){t.call(this)}return jr(e,t),e.create=function(){return new e},e.prototype._subscribe=function(t){mt.noop()},e}(_t.Observable)}.NeverObservable.create};_t.Observable.never=Ir.never,_t.Observable.of=se.of;var Tr=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Er=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return 1===t.length&&et.isArray(t[0])&&(t=t[0]),function(e){return e.lift(new Ar(t))}},Pr=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var r=null;return 1===t.length&&et.isArray(t[0])&&(t=t[0]),r=t.shift(),new je.FromObservable(r,null).lift(new Ar(t))},Ar=function(){function t(t){this.nextSources=t}return t.prototype.call=function(t,e){return e.subscribe(new Nr(t,this.nextSources))},t}(),Nr=function(t){function e(e,r){t.call(this,e),this.destination=e,this.nextSources=r}return Tr(e,t),e.prototype.notifyError=function(t,e){this.subscribeToNextSource()},e.prototype.notifyComplete=function(t){this.subscribeToNextSource()},e.prototype._error=function(t){this.subscribeToNextSource()},e.prototype._complete=function(){this.subscribeToNextSource()},e.prototype.subscribeToNextSource=function(){var t=this.nextSources.shift();t?this.add(Qt.subscribeToResult(this,t)):this.destination.complete()},e}(Kt.OuterSubscriber),Fr={onErrorResumeNext:Er,onErrorResumeNextStatic:Pr},Vr={onErrorResumeNext:Fr.onErrorResumeNextStatic};_t.Observable.onErrorResumeNext=Vr.onErrorResumeNext;var Dr=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},zr={pairs:{PairsObservable:function(t){function e(e,r){t.call(this),this.obj=e,this.scheduler=r,this.keys=Object.keys(e)}return Dr(e,t),e.create=function(t,r){return new e(t,r)},e.prototype._subscribe=function(t){var e=this.keys,r=this.scheduler,i=e.length;if(r)return r.schedule(x,0,{obj:this.obj,keys:e,length:i,index:0,subscriber:t});for(var n=0;n<i;n++){var o=e[n];t.next([o,this.obj[o]])}t.complete()},e}(_t.Observable)}.PairsObservable.create};_t.Observable.pairs=zr.pairs;var Rr=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Wr={range:{RangeObservable:function(t){function e(e,r,i){t.call(this),this.start=e,this._count=r,this.scheduler=i}return Rr(e,t),e.create=function(t,r,i){return void 0===t&&(t=0),void 0===r&&(r=0),new e(t,r,i)},e.dispatch=function(t){var e=t.start,r=t.index,i=t.count,n=t.subscriber;r>=i?n.complete():(n.next(e),n.closed||(t.index=r+1,t.start=e+1,this.schedule(t)))},e.prototype._subscribe=function(t){var r=0,i=this.start,n=this._count,o=this.scheduler;if(o)return o.schedule(e.dispatch,0,{index:r,count:n,start:i,subscriber:t});for(;;){if(r++>=n){t.complete();break}if(t.next(i++),t.closed)break}},e}(_t.Observable)}.RangeObservable.create};_t.Observable.range=Wr.range;var Mr=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Lr=function(t){function e(e,r){t.call(this),this.resourceFactory=e,this.observableFactory=r}return Mr(e,t),e.create=function(t,r){return new e(t,r)},e.prototype._subscribe=function(t){var e,r=this.resourceFactory,i=this.observableFactory;try{return e=r(),new Ur(t,e,i)}catch(e){t.error(e)}},e}(_t.Observable),Ur=function(t){function e(e,r,i){t.call(this,e),this.resource=r,this.observableFactory=i,e.add(r),this.tryUse()}return Mr(e,t),e.prototype.tryUse=function(){try{var t=this.observableFactory.call(this,this.resource);t&&this.add(Qt.subscribeToResult(this,t))}catch(t){this._error(t)}},e}(Kt.OuterSubscriber),qr={using:{UsingObservable:Lr}.UsingObservable.create};_t.Observable.using=qr.using;var Br=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Kr={_throw:{ErrorObservable:function(t){function e(e,r){t.call(this),this.error=e,this.scheduler=r}return Br(e,t),e.create=function(t,r){return new e(t,r)},e.dispatch=function(t){var e=t.error;t.subscriber.error(e)},e.prototype._subscribe=function(t){var r=this.error,i=this.scheduler;if(t.syncErrorThrowable=!0,i)return i.schedule(e.dispatch,0,{error:r,subscriber:t});t.error(r)},e}(_t.Observable)}.ErrorObservable.create};_t.Observable.throw=Kr._throw;var Hr={isDate:function(t){return t instanceof Date&&!isNaN(+t)}},Yr=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Gr={timer:{TimerObservable:function(t){function e(e,r,i){void 0===e&&(e=0),t.call(this),this.period=-1,this.dueTime=0,cr.isNumeric(r)?this.period=Number(r)<1?1:Number(r):zt.isScheduler(r)&&(i=r),zt.isScheduler(i)||(i=br.async),this.scheduler=i,this.dueTime=Hr.isDate(e)?+e-this.scheduler.now():e}return Yr(e,t),e.create=function(t,r,i){return void 0===t&&(t=0),new e(t,r,i)},e.dispatch=function(t){var e=t.index,r=t.period,i=t.subscriber;if(i.next(e),!i.closed){if(-1===r)return i.complete();t.index=e+1,this.schedule(t,r)}},e.prototype._subscribe=function(t){var r=this.period,i=this.dueTime;return this.scheduler.schedule(e.dispatch,i,{index:0,period:r,subscriber:t})},e}(_t.Observable)}.TimerObservable.create};_t.Observable.timer=Gr.timer;var Jr=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Xr=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return function(e){return e.lift.call(C.apply(void 0,[e].concat(t)))}},Qr=C,$r=function(){function t(t){this.project=t}return t.prototype.call=function(t,e){return e.subscribe(new ti(t,this.project))},t}(),Zr=$r,ti=function(t){function e(e,r,i){void 0===i&&(i=Object.create(null)),t.call(this,e),this.iterators=[],this.active=0,this.project="function"==typeof r?r:null,this.values=i}return Jr(e,t),e.prototype._next=function(t){var e=this.iterators;et.isArray(t)?e.push(new ii(t)):"function"==typeof t[Gt.iterator]?e.push(new ri(t[Gt.iterator]())):e.push(new ni(this.destination,this,t))},e.prototype._complete=function(){var t=this.iterators,e=t.length;if(0!==e){this.active=e;for(var r=0;r<e;r++){var i=t[r];i.stillUnsubscribed?this.add(i.subscribe(i,r)):this.active--}}else this.destination.complete()},e.prototype.notifyInactive=function(){this.active--,0===this.active&&this.destination.complete()},e.prototype.checkIterators=function(){for(var t=this.iterators,e=t.length,r=this.destination,i=0;i<e;i++){if("function"==typeof(s=t[i]).hasValue&&!s.hasValue())return}var n=!1,o=[];for(i=0;i<e;i++){var s,c=(s=t[i]).next();if(s.hasCompleted()&&(n=!0),c.done)return void r.complete();o.push(c.value)}this.project?this._tryProject(o):r.next(o),n&&r.complete()},e.prototype._tryProject=function(t){var e;try{e=this.project.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(dt.Subscriber),ei=ti,ri=function(){function t(t){this.iterator=t,this.nextResult=t.next()}return t.prototype.hasValue=function(){return!0},t.prototype.next=function(){var t=this.nextResult;return this.nextResult=this.iterator.next(),t},t.prototype.hasCompleted=function(){var t=this.nextResult;return t&&t.done},t}(),ii=function(){function t(t){this.array=t,this.index=0,this.length=0,this.length=t.length}return t.prototype[Gt.iterator]=function(){return this},t.prototype.next=function(t){var e=this.index++,r=this.array;return e<this.length?{value:r[e],done:!1}:{value:null,done:!0}},t.prototype.hasValue=function(){return this.array.length>this.index},t.prototype.hasCompleted=function(){return this.array.length===this.index},t}(),ni=function(t){function e(e,r,i){t.call(this,e),this.parent=r,this.observable=i,this.stillUnsubscribed=!0,this.buffer=[],this.isComplete=!1}return Jr(e,t),e.prototype[Gt.iterator]=function(){return this},e.prototype.next=function(){var t=this.buffer;return 0===t.length&&this.isComplete?{value:null,done:!0}:{value:t.shift(),done:!1}},e.prototype.hasValue=function(){return this.buffer.length>0},e.prototype.hasCompleted=function(){return 0===this.buffer.length&&this.isComplete},e.prototype.notifyComplete=function(){this.buffer.length>0?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},e.prototype.notifyNext=function(t,e,r,i,n){this.buffer.push(e),this.parent.checkIterators()},e.prototype.subscribe=function(t,e){return Qt.subscribeToResult(this,this.observable,this,e)},e}(Kt.OuterSubscriber),oi={zip:Xr,zipStatic:Qr,ZipOperator:Zr,ZipSubscriber:ei},si={zip:oi.zipStatic};_t.Observable.zip=si.zip;var ci=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},ui=function(t,e){return function(r){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return r.lift(new ai(t,e))}},ai=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new li(t,this.project,this.thisArg))},t}(),hi=ai,li=function(t){function e(e,r,i){t.call(this,e),this.project=r,this.count=0,this.thisArg=i||this}return ci(e,t),e.prototype._next=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(dt.Subscriber),pi={map:ui,MapOperator:hi},fi=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},di=k,bi=j,yi=I,mi=T,vi=E,_i=pi.map(function(t,e){return t.response}),gi=P,wi=function(t){function e(e){t.call(this);var r={async:!0,createXHR:function(){return this.crossDomain?function(){if(Z.root.XMLHttpRequest)return new Z.root.XMLHttpRequest;if(Z.root.XDomainRequest)return new Z.root.XDomainRequest;throw new Error("CORS is not supported by your browser")}.call(this):function(){if(Z.root.XMLHttpRequest)return new Z.root.XMLHttpRequest;var t=void 0;try{for(var e=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],r=0;r<3;r++)try{if(t=e[r],new Z.root.ActiveXObject(t))break}catch(t){}return new Z.root.ActiveXObject(t)}catch(t){throw new Error("XMLHttpRequest is not supported by your browser")}}()},crossDomain:!1,withCredentials:!1,headers:{},method:"GET",responseType:"json",timeout:0};if("string"==typeof e)r.url=e;else for(var i in e)e.hasOwnProperty(i)&&(r[i]=e[i]);this.request=r}return fi(e,t),e.prototype._subscribe=function(t){return new Oi(t,this.request)},e.create=function(){var t=function(t){return new e(t)};return t.get=k,t.post=j,t.delete=I,t.put=T,t.patch=E,t.getJSON=P,t}(),e}(_t.Observable),Si=wi,Oi=function(t){function e(e,r){t.call(this,e),this.request=r,this.done=!1;var i=r.headers=r.headers||{};r.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest"),"Content-Type"in i||Z.root.FormData&&r.body instanceof Z.root.FormData||void 0===r.body||(i["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8"),r.body=this.serializeBody(r.body,r.headers["Content-Type"]),this.send()}return fi(e,t),e.prototype.next=function(t){this.done=!0;var e=this.xhr,r=this.request,i=this.destination,n=new Ci(t,e,r);i.next(n)},e.prototype.send=function(){var t=this.request,e=this.request,r=e.user,i=e.method,n=e.url,o=e.async,s=e.password,c=e.headers,u=e.body,a=t.createXHR,h=nt.tryCatch(a).call(t);if(h===it.errorObject)this.error(it.errorObject.e);else{this.xhr=h,this.setupEvents(h,t);if((r?nt.tryCatch(h.open).call(h,i,n,o,r,s):nt.tryCatch(h.open).call(h,i,n,o))===it.errorObject)return this.error(it.errorObject.e),null;if(o&&(h.timeout=t.timeout,h.responseType=t.responseType),"withCredentials"in h&&(h.withCredentials=!!t.withCredentials),this.setHeaders(h,c),(u?nt.tryCatch(h.send).call(h,u):nt.tryCatch(h.send).call(h))===it.errorObject)return this.error(it.errorObject.e),null}return h},e.prototype.serializeBody=function(t,e){if(!t||"string"==typeof t)return t;if(Z.root.FormData&&t instanceof Z.root.FormData)return t;if(e){var r=e.indexOf(";");-1!==r&&(e=e.substring(0,r))}switch(e){case"application/x-www-form-urlencoded":return Object.keys(t).map(function(e){return encodeURI(e)+"="+encodeURI(t[e])}).join("&");case"application/json":return JSON.stringify(t);default:return t}},e.prototype.setHeaders=function(t,e){for(var r in e)e.hasOwnProperty(r)&&t.setRequestHeader(r,e[r])},e.prototype.setupEvents=function(t,e){function r(t){var e=r.subscriber,i=r.progressSubscriber,n=r.request;i&&i.error(t),e.error(new Ti(this,n))}function i(t){var e=i.subscriber,r=i.progressSubscriber,n=i.request;if(4===this.readyState){var o=1223===this.status?204:this.status,s="text"===this.responseType?this.response||this.responseText:this.response;0===o&&(o=s?200:0),200<=o&&o<300?(r&&r.complete(),e.next(t),e.complete()):(r&&r.error(t),e.error(new ji("ajax error "+o,this,n)))}}var n=e.progressSubscriber;if(t.ontimeout=r,r.request=e,r.subscriber=this,r.progressSubscriber=n,t.upload&&"withCredentials"in t){if(n){var o;o=function(t){o.progressSubscriber.next(t)},Z.root.XDomainRequest?t.onprogress=o:t.upload.onprogress=o,o.progressSubscriber=n}var s;s=function(t){var e=s,r=e.progressSubscriber,i=e.subscriber,n=e.request;r&&r.error(t),i.error(new ji("ajax error",this,n))},t.onerror=s,s.request=e,s.subscriber=this,s.progressSubscriber=n}t.onreadystatechange=i,i.subscriber=this,i.progressSubscriber=n,i.request=e},e.prototype.unsubscribe=function(){var e=this.done,r=this.xhr;!e&&r&&4!==r.readyState&&"function"==typeof r.abort&&r.abort(),t.prototype.unsubscribe.call(this)},e}(dt.Subscriber),xi=Oi,Ci=function(){return function(t,e,r){this.originalEvent=t,this.xhr=e,this.request=r,this.status=e.status,this.responseType=e.responseType||r.responseType,this.response=A(this.responseType,e)}}(),ki=Ci,ji=function(t){function e(e,r,i){t.call(this,e),this.message=e,this.xhr=r,this.request=i,this.status=r.status,this.responseType=r.responseType||i.responseType,this.response=A(this.responseType,r)}return fi(e,t),e}(Error),Ii=ji,Ti=function(t){function e(e,r){t.call(this,"ajax timeout",e,r)}return fi(e,t),e}(ji),Ei={ajax:{ajaxGet:di,ajaxPost:bi,ajaxDelete:yi,ajaxPut:mi,ajaxPatch:vi,ajaxGetJSON:gi,AjaxObservable:Si,AjaxSubscriber:xi,AjaxResponse:ki,AjaxError:Ii,AjaxTimeoutError:Ti}.AjaxObservable.create};_t.Observable.ajax=Ei.ajax;var Pi=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Ai={QueueAction:function(t){function e(e,r){t.call(this,e,r),this.scheduler=e,this.work=r}return Pi(e,t),e.prototype.schedule=function(e,r){return void 0===r&&(r=0),r>0?t.prototype.schedule.call(this,e,r):(this.delay=r,this.state=e,this.scheduler.flush(this),this)},e.prototype.execute=function(e,r){return r>0||this.closed?t.prototype.execute.call(this,e,r):this._execute(e,r)},e.prototype.requestAsyncId=function(e,r,i){return void 0===i&&(i=0),null!==i&&i>0||null===i&&this.delay>0?t.prototype.requestAsyncId.call(this,e,r,i):e.flush(this)},e}(lr.AsyncAction)},Ni=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Fi=new({QueueScheduler:function(t){function e(){t.apply(this,arguments)}return Ni(e,t),e}(dr.AsyncScheduler)}.QueueScheduler)(Ai.QueueAction),Vi=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Di=function(t){function e(e,r,i){void 0===e&&(e=Number.POSITIVE_INFINITY),void 0===r&&(r=Number.POSITIVE_INFINITY),t.call(this),this.scheduler=i,this._events=[],this._bufferSize=e<1?1:e,this._windowTime=r<1?1:r}return Vi(e,t),e.prototype.next=function(e){var r=this._getNow();this._events.push(new zi(r,e)),this._trimBufferThenGetEvents(),t.prototype.next.call(this,e)},e.prototype._subscribe=function(t){var e,r=this._trimBufferThenGetEvents(),i=this.scheduler;if(this.closed)throw new wt.ObjectUnsubscribedError;this.hasError?e=ct.Subscription.EMPTY:this.isStopped?e=ct.Subscription.EMPTY:(this.observers.push(t),e=new Ot.SubjectSubscription(this,t)),i&&t.add(t=new Ce.ObserveOnSubscriber(t,i));for(var n=r.length,o=0;o<n&&!t.closed;o++)t.next(r[o].value);return this.hasError?t.error(this.thrownError):this.isStopped&&t.complete(),e},e.prototype._getNow=function(){return(this.scheduler||Fi).now()},e.prototype._trimBufferThenGetEvents=function(){for(var t=this._getNow(),e=this._bufferSize,r=this._windowTime,i=this._events,n=i.length,o=0;o<n&&!(t-i[o].time<r);)o++;return n>e&&(o=Math.max(o,n-e)),o>0&&i.splice(0,o),i},e}(Et.Subject),zi=function(){return function(t,e){this.time=t,this.value=e}}(),Ri={ReplaySubject:Di},Wi={assignImpl:N,getAssign:F,assign:F(Z.root)},Mi=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Li={webSocket:{WebSocketSubject:function(t){function e(e,r){if(e instanceof _t.Observable)t.call(this,r,e);else{if(t.call(this),this.WebSocketCtor=Z.root.WebSocket,this._output=new Et.Subject,"string"==typeof e?this.url=e:Wi.assign(this,e),!this.WebSocketCtor)throw new Error("no WebSocket constructor can be found");this.destination=new Ri.ReplaySubject}}return Mi(e,t),e.prototype.resultSelector=function(t){return JSON.parse(t.data)},e.create=function(t){return new e(t)},e.prototype.lift=function(t){var r=new e(this,this.destination);return r.operator=t,r},e.prototype._resetState=function(){this.socket=null,this.source||(this.destination=new Ri.ReplaySubject),this._output=new Et.Subject},e.prototype.multiplex=function(t,e,r){var i=this;return new _t.Observable(function(n){var o=nt.tryCatch(t)();o===it.errorObject?n.error(it.errorObject.e):i.next(o);var s=i.subscribe(function(t){var e=nt.tryCatch(r)(t);e===it.errorObject?n.error(it.errorObject.e):e&&n.next(t)},function(t){return n.error(t)},function(){return n.complete()});return function(){var t=nt.tryCatch(e)();t===it.errorObject?n.error(it.errorObject.e):i.next(t),s.unsubscribe()}})},e.prototype._connectSocket=function(){var t=this,e=this.WebSocketCtor,r=this._output,i=null;try{i=this.protocol?new e(this.url,this.protocol):new e(this.url),this.socket=i,this.binaryType&&(this.socket.binaryType=this.binaryType)}catch(t){return void r.error(t)}var n=new ct.Subscription(function(){t.socket=null,i&&1===i.readyState&&i.close()});i.onopen=function(e){var o=t.openObserver;o&&o.next(e);var s=t.destination;t.destination=dt.Subscriber.create(function(t){return 1===i.readyState&&i.send(t)},function(e){var n=t.closingObserver;n&&n.next(void 0),e&&e.code?i.close(e.code,e.reason):r.error(new TypeError("WebSocketSubject.error must be called with an object with an error code, and an optional reason: { code: number, reason: string }")),t._resetState()},function(){var e=t.closingObserver;e&&e.next(void 0),i.close(),t._resetState()}),s&&s instanceof Ri.ReplaySubject&&n.add(s.subscribe(t.destination))},i.onerror=function(e){t._resetState(),r.error(e)},i.onclose=function(e){t._resetState();var i=t.closeObserver;i&&i.next(e),e.wasClean?r.complete():r.error(e)},i.onmessage=function(e){var i=nt.tryCatch(t.resultSelector)(e);i===it.errorObject?r.error(it.errorObject.e):r.next(i)}},e.prototype._subscribe=function(t){var e=this,r=this.source;if(r)return r.subscribe(t);this.socket||this._connectSocket();var i=new ct.Subscription;return i.add(this._output.subscribe(t)),i.add(function(){var t=e.socket;0===e._output.observers.length&&(t&&1===t.readyState&&t.close(),e._resetState())}),i},e.prototype.unsubscribe=function(){var e=this.source,r=this.socket;r&&1===r.readyState&&(r.close(),this._resetState()),t.prototype.unsubscribe.call(this),e||(this.destination=new Ri.ReplaySubject)},e}(Et.AnonymousSubject)}.WebSocketSubject.create};_t.Observable.webSocket=Li.webSocket;var Ui=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},qi=function(t){return function(e){return e.lift(new Bi(t))}},Bi=function(){function t(t){this.closingNotifier=t}return t.prototype.call=function(t,e){return e.subscribe(new Ki(t,this.closingNotifier))},t}(),Ki=function(t){function e(e,r){t.call(this,e),this.buffer=[],this.add(Qt.subscribeToResult(this,r))}return Ui(e,t),e.prototype._next=function(t){this.buffer.push(t)},e.prototype.notifyNext=function(t,e,r,i,n){var o=this.buffer;this.buffer=[],this.destination.next(o)},e}(Kt.OuterSubscriber),Hi={buffer:qi},Yi={buffer:function(t){return Hi.buffer(t)(this)}};_t.Observable.prototype.buffer=Yi.buffer;var Gi=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Ji=function(t,e){return void 0===e&&(e=null),function(r){return r.lift(new Xi(t,e))}},Xi=function(){function t(t,e){this.bufferSize=t,this.startBufferEvery=e,this.subscriberClass=e&&t!==e?$i:Qi}return t.prototype.call=function(t,e){return e.subscribe(new this.subscriberClass(t,this.bufferSize,this.startBufferEvery))},t}(),Qi=function(t){function e(e,r){t.call(this,e),this.bufferSize=r,this.buffer=[]}return Gi(e,t),e.prototype._next=function(t){var e=this.buffer;e.push(t),e.length==this.bufferSize&&(this.destination.next(e),this.buffer=[])},e.prototype._complete=function(){var e=this.buffer;e.length>0&&this.destination.next(e),t.prototype._complete.call(this)},e}(dt.Subscriber),$i=function(t){function e(e,r,i){t.call(this,e),this.bufferSize=r,this.startBufferEvery=i,this.buffers=[],this.count=0}return Gi(e,t),e.prototype._next=function(t){var e=this.bufferSize,r=this.startBufferEvery,i=this.buffers,n=this.count;this.count++,n%r==0&&i.push([]);for(var o=i.length;o--;){var s=i[o];s.push(t),s.length===e&&(i.splice(o,1),this.destination.next(s))}},e.prototype._complete=function(){for(var e=this.buffers,r=this.destination;e.length>0;){var i=e.shift();i.length>0&&r.next(i)}t.prototype._complete.call(this)},e}(dt.Subscriber),Zi={bufferCount:Ji},tn={bufferCount:function(t,e){return void 0===e&&(e=null),Zi.bufferCount(t,e)(this)}};_t.Observable.prototype.bufferCount=tn.bufferCount;var en=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},rn=function(t){var e=arguments.length,r=br.async;zt.isScheduler(arguments[arguments.length-1])&&(r=arguments[arguments.length-1],e--);var i=null;e>=2&&(i=arguments[1]);var n=Number.POSITIVE_INFINITY;return e>=3&&(n=arguments[2]),function(e){return e.lift(new nn(t,i,n,r))}},nn=function(){function t(t,e,r,i){this.bufferTimeSpan=t,this.bufferCreationInterval=e,this.maxBufferSize=r,this.scheduler=i}return t.prototype.call=function(t,e){return e.subscribe(new sn(t,this.bufferTimeSpan,this.bufferCreationInterval,this.maxBufferSize,this.scheduler))},t}(),on=function(){return function(){this.buffer=[]}}(),sn=function(t){function e(e,r,i,n,o){t.call(this,e),this.bufferTimeSpan=r,this.bufferCreationInterval=i,this.maxBufferSize=n,this.scheduler=o,this.contexts=[];var s=this.openContext();if(this.timespanOnly=null==i||i<0,this.timespanOnly){var c={subscriber:this,context:s,bufferTimeSpan:r};this.add(s.closeAction=o.schedule(V,r,c))}else{var u={subscriber:this,context:s},a={bufferTimeSpan:r,bufferCreationInterval:i,subscriber:this,scheduler:o};this.add(s.closeAction=o.schedule(z,r,u)),this.add(o.schedule(D,i,a))}}return en(e,t),e.prototype._next=function(t){for(var e,r=this.contexts,i=r.length,n=0;n<i;n++){var o=r[n],s=o.buffer;s.push(t),s.length==this.maxBufferSize&&(e=o)}e&&this.onBufferFull(e)},e.prototype._error=function(e){this.contexts.length=0,t.prototype._error.call(this,e)},e.prototype._complete=function(){for(var e=this.contexts,r=this.destination;e.length>0;){var i=e.shift();r.next(i.buffer)}t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){this.contexts=null},e.prototype.onBufferFull=function(t){this.closeContext(t);var e=t.closeAction;if(e.unsubscribe(),this.remove(e),!this.closed&&this.timespanOnly){t=this.openContext();var r=this.bufferTimeSpan,i={subscriber:this,context:t,bufferTimeSpan:r};this.add(t.closeAction=this.scheduler.schedule(V,r,i))}},e.prototype.openContext=function(){var t=new on;return this.contexts.push(t),t},e.prototype.closeContext=function(t){this.destination.next(t.buffer);var e=this.contexts;(e?e.indexOf(t):-1)>=0&&e.splice(e.indexOf(t),1)},e}(dt.Subscriber),cn={bufferTime:rn},un={bufferTime:function(t){var e=arguments.length,r=br.async;zt.isScheduler(arguments[arguments.length-1])&&(r=arguments[arguments.length-1],e--);var i=null;e>=2&&(i=arguments[1]);var n=Number.POSITIVE_INFINITY;return e>=3&&(n=arguments[2]),cn.bufferTime(t,i,n,r)(this)}};_t.Observable.prototype.bufferTime=un.bufferTime;var an=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},hn=function(t,e){return function(r){return r.lift(new ln(t,e))}},ln=function(){function t(t,e){this.openings=t,this.closingSelector=e}return t.prototype.call=function(t,e){return e.subscribe(new pn(t,this.openings,this.closingSelector))},t}(),pn=function(t){function e(e,r,i){t.call(this,e),this.openings=r,this.closingSelector=i,this.contexts=[],this.add(Qt.subscribeToResult(this,r))}return an(e,t),e.prototype._next=function(t){for(var e=this.contexts,r=e.length,i=0;i<r;i++)e[i].buffer.push(t)},e.prototype._error=function(e){for(var r=this.contexts;r.length>0;){var i=r.shift();i.subscription.unsubscribe(),i.buffer=null,i.subscription=null}this.contexts=null,t.prototype._error.call(this,e)},e.prototype._complete=function(){for(var e=this.contexts;e.length>0;){var r=e.shift();this.destination.next(r.buffer),r.subscription.unsubscribe(),r.buffer=null,r.subscription=null}this.contexts=null,t.prototype._complete.call(this)},e.prototype.notifyNext=function(t,e,r,i,n){t?this.closeBuffer(t):this.openBuffer(e)},e.prototype.notifyComplete=function(t){this.closeBuffer(t.context)},e.prototype.openBuffer=function(t){try{var e=this.closingSelector.call(this,t);e&&this.trySubscribe(e)}catch(t){this._error(t)}},e.prototype.closeBuffer=function(t){var e=this.contexts;if(e&&t){var r=t.buffer,i=t.subscription;this.destination.next(r),e.splice(e.indexOf(t),1),this.remove(i),i.unsubscribe()}},e.prototype.trySubscribe=function(t){var e=this.contexts,r=new ct.Subscription,i={buffer:[],subscription:r};e.push(i);var n=Qt.subscribeToResult(this,t,i);!n||n.closed?this.closeBuffer(i):(n.context=i,this.add(n),r.add(n))},e}(Kt.OuterSubscriber),fn={bufferToggle:hn},dn={bufferToggle:function(t,e){return fn.bufferToggle(t,e)(this)}};_t.Observable.prototype.bufferToggle=dn.bufferToggle;var bn=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},yn=function(t){return function(e){return e.lift(new mn(t))}},mn=function(){function t(t){this.closingSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new vn(t,this.closingSelector))},t}(),vn=function(t){function e(e,r){t.call(this,e),this.closingSelector=r,this.subscribing=!1,this.openBuffer()}return bn(e,t),e.prototype._next=function(t){this.buffer.push(t)},e.prototype._complete=function(){var e=this.buffer;e&&this.destination.next(e),t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){this.buffer=null,this.subscribing=!1},e.prototype.notifyNext=function(t,e,r,i,n){this.openBuffer()},e.prototype.notifyComplete=function(){this.subscribing?this.complete():this.openBuffer()},e.prototype.openBuffer=function(){var t=this.closingSubscription;t&&(this.remove(t),t.unsubscribe());var e=this.buffer;this.buffer&&this.destination.next(e),this.buffer=[];var r=nt.tryCatch(this.closingSelector)();r===it.errorObject?this.error(it.errorObject.e):(t=new ct.Subscription,this.closingSubscription=t,this.add(t),this.subscribing=!0,t.add(Qt.subscribeToResult(this,r)),this.subscribing=!1)},e}(Kt.OuterSubscriber),_n={bufferWhen:yn},gn={bufferWhen:function(t){return _n.bufferWhen(t)(this)}};_t.Observable.prototype.bufferWhen=gn.bufferWhen;var wn=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Sn=function(t){return function(e){var r=new On(t),i=e.lift(r);return r.caught=i}},On=function(){function t(t){this.selector=t}return t.prototype.call=function(t,e){return e.subscribe(new xn(t,this.selector,this.caught))},t}(),xn=function(t){function e(e,r,i){t.call(this,e),this.selector=r,this.caught=i}return wn(e,t),e.prototype.error=function(e){if(!this.isStopped){var r=void 0;try{r=this.selector(e,this.caught)}catch(e){return void t.prototype.error.call(this,e)}this._unsubscribeAndRecycle(),this.add(Qt.subscribeToResult(this,r))}},e}(Kt.OuterSubscriber),Cn={catchError:Sn},kn={_catch:function(t){return Cn.catchError(t)(this)}};_t.Observable.prototype.catch=kn._catch,_t.Observable.prototype._catch=kn._catch;var jn={combineAll:function(t){return function(e){return e.lift(new ne.CombineLatestOperator(t))}}},In={combineAll:function(t){return jn.combineAll(t)(this)}};_t.Observable.prototype.combineAll=In.combineAll;var Tn={combineLatest:function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return ne.combineLatest.apply(void 0,t)(this)}};_t.Observable.prototype.combineLatest=Tn.combineLatest;var En={concat:function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return function(e){return e.lift.call(Re.concat.apply(void 0,[e].concat(t)))}}},Pn={concat:function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return En.concat.apply(void 0,t)(this)}};_t.Observable.prototype.concat=Pn.concat;var An={concatAll:function(){return ze.concatAll()(this)}};_t.Observable.prototype.concatAll=An.concatAll;var Nn={concatMap:function(t,e){return Fe.mergeMap(t,e,1)}},Fn={concatMap:function(t,e){return Nn.concatMap(t,e)(this)}};_t.Observable.prototype.concatMap=Fn.concatMap;var Vn={concatMapTo:function(t,e){return Nn.concatMap(function(){return t},e)}},Dn={concatMapTo:function(t,e){return Vn.concatMapTo(t,e)(this)}};_t.Observable.prototype.concatMapTo=Dn.concatMapTo;var zn=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Rn=function(t){return function(e){return e.lift(new Wn(t,e))}},Wn=function(){function t(t,e){this.predicate=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new Mn(t,this.predicate,this.source))},t}(),Mn=function(t){function e(e,r,i){t.call(this,e),this.predicate=r,this.source=i,this.count=0,this.index=0}return zn(e,t),e.prototype._next=function(t){this.predicate?this._tryPredicate(t):this.count++},e.prototype._tryPredicate=function(t){var e;try{e=this.predicate(t,this.index++,this.source)}catch(t){return void this.destination.error(t)}e&&this.count++},e.prototype._complete=function(){this.destination.next(this.count),this.destination.complete()},e}(dt.Subscriber),Ln={count:Rn},Un={count:function(t){return Ln.count(t)(this)}};_t.Observable.prototype.count=Un.count;var qn=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Bn=function(){return function(t){return t.lift(new Kn)}},Kn=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new Hn(t))},t}(),Hn=function(t){function e(e){t.call(this,e)}return qn(e,t),e.prototype._next=function(t){t.observe(this.destination)},e}(dt.Subscriber),Yn={dematerialize:Bn},Gn={dematerialize:function(){return Yn.dematerialize()(this)}};_t.Observable.prototype.dematerialize=Gn.dematerialize;var Jn=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Xn=function(t){return function(e){return e.lift(new Qn(t))}},Qn=function(){function t(t){this.durationSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new $n(t,this.durationSelector))},t}(),$n=function(t){function e(e,r){t.call(this,e),this.durationSelector=r,this.hasValue=!1,this.durationSubscription=null}return Jn(e,t),e.prototype._next=function(t){try{var e=this.durationSelector.call(this,t);e&&this._tryNext(t,e)}catch(t){this.destination.error(t)}},e.prototype._complete=function(){this.emitValue(),this.destination.complete()},e.prototype._tryNext=function(t,e){var r=this.durationSubscription;this.value=t,this.hasValue=!0,r&&(r.unsubscribe(),this.remove(r)),(r=Qt.subscribeToResult(this,e)).closed||this.add(this.durationSubscription=r)},e.prototype.notifyNext=function(t,e,r,i,n){this.emitValue()},e.prototype.notifyComplete=function(){this.emitValue()},e.prototype.emitValue=function(){if(this.hasValue){var e=this.value,r=this.durationSubscription;r&&(this.durationSubscription=null,r.unsubscribe(),this.remove(r)),this.value=null,this.hasValue=!1,t.prototype._next.call(this,e)}},e}(Kt.OuterSubscriber),Zn={debounce:Xn},to={debounce:function(t){return Zn.debounce(t)(this)}};_t.Observable.prototype.debounce=to.debounce;var eo=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},ro=function(t,e){return void 0===e&&(e=br.async),function(r){return r.lift(new io(t,e))}},io=function(){function t(t,e){this.dueTime=t,this.scheduler=e}return t.prototype.call=function(t,e){return e.subscribe(new no(t,this.dueTime,this.scheduler))},t}(),no=function(t){function e(e,r,i){t.call(this,e),this.dueTime=r,this.scheduler=i,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}return eo(e,t),e.prototype._next=function(t){this.clearDebounce(),this.lastValue=t,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(R,this.dueTime,this))},e.prototype._complete=function(){this.debouncedNext(),this.destination.complete()},e.prototype.debouncedNext=function(){this.clearDebounce(),this.hasValue&&(this.destination.next(this.lastValue),this.lastValue=null,this.hasValue=!1)},e.prototype.clearDebounce=function(){var t=this.debouncedSubscription;null!==t&&(this.remove(t),t.unsubscribe(),this.debouncedSubscription=null)},e}(dt.Subscriber),oo={debounceTime:ro},so={debounceTime:function(t,e){return void 0===e&&(e=br.async),oo.debounceTime(t,e)(this)}};_t.Observable.prototype.debounceTime=so.debounceTime;var co=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},uo=function(t){return void 0===t&&(t=null),function(e){return e.lift(new ao(t))}},ao=function(){function t(t){this.defaultValue=t}return t.prototype.call=function(t,e){return e.subscribe(new ho(t,this.defaultValue))},t}(),ho=function(t){function e(e,r){t.call(this,e),this.defaultValue=r,this.isEmpty=!0}return co(e,t),e.prototype._next=function(t){this.isEmpty=!1,this.destination.next(t)},e.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},e}(dt.Subscriber),lo={defaultIfEmpty:uo},po={defaultIfEmpty:function(t){return void 0===t&&(t=null),lo.defaultIfEmpty(t)(this)}};_t.Observable.prototype.defaultIfEmpty=po.defaultIfEmpty;var fo=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},bo=function(t,e){void 0===e&&(e=br.async);var r=Hr.isDate(t)?+t-e.now():Math.abs(t);return function(t){return t.lift(new yo(r,e))}},yo=function(){function t(t,e){this.delay=t,this.scheduler=e}return t.prototype.call=function(t,e){return e.subscribe(new mo(t,this.delay,this.scheduler))},t}(),mo=function(t){function e(e,r,i){t.call(this,e),this.delay=r,this.scheduler=i,this.queue=[],this.active=!1,this.errored=!1}return fo(e,t),e.dispatch=function(t){for(var e=t.source,r=e.queue,i=t.scheduler,n=t.destination;r.length>0&&r[0].time-i.now()<=0;)r.shift().notification.observe(n);if(r.length>0){var o=Math.max(0,r[0].time-i.now());this.schedule(t,o)}else e.active=!1},e.prototype._schedule=function(t){this.active=!0,this.add(t.schedule(e.dispatch,this.delay,{source:this,destination:this.destination,scheduler:t}))},e.prototype.scheduleNotification=function(t){if(!0!==this.errored){var e=this.scheduler,r=new vo(e.now()+this.delay,t);this.queue.push(r),!1===this.active&&this._schedule(e)}},e.prototype._next=function(t){this.scheduleNotification(me.Notification.createNext(t))},e.prototype._error=function(t){this.errored=!0,this.queue=[],this.destination.error(t)},e.prototype._complete=function(){this.scheduleNotification(me.Notification.createComplete())},e}(dt.Subscriber),vo=function(){return function(t,e){this.time=t,this.notification=e}}(),_o={delay:bo},go={delay:function(t,e){return void 0===e&&(e=br.async),_o.delay(t,e)(this)}};_t.Observable.prototype.delay=go.delay;var wo=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},So=function(t,e){return e?function(r){return new Co(r,e).lift(new Oo(t))}:function(e){return e.lift(new Oo(t))}},Oo=function(){function t(t){this.delayDurationSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new xo(t,this.delayDurationSelector))},t}(),xo=function(t){function e(e,r){t.call(this,e),this.delayDurationSelector=r,this.completed=!1,this.delayNotifierSubscriptions=[],this.values=[]}return wo(e,t),e.prototype.notifyNext=function(t,e,r,i,n){this.destination.next(t),this.removeSubscription(n),this.tryComplete()},e.prototype.notifyError=function(t,e){this._error(t)},e.prototype.notifyComplete=function(t){var e=this.removeSubscription(t);e&&this.destination.next(e),this.tryComplete()},e.prototype._next=function(t){try{var e=this.delayDurationSelector(t);e&&this.tryDelay(e,t)}catch(t){this.destination.error(t)}},e.prototype._complete=function(){this.completed=!0,this.tryComplete()},e.prototype.removeSubscription=function(t){t.unsubscribe();var e=this.delayNotifierSubscriptions.indexOf(t),r=null;return-1!==e&&(r=this.values[e],this.delayNotifierSubscriptions.splice(e,1),this.values.splice(e,1)),r},e.prototype.tryDelay=function(t,e){var r=Qt.subscribeToResult(this,t,e);r&&!r.closed&&(this.add(r),this.delayNotifierSubscriptions.push(r)),this.values.push(e)},e.prototype.tryComplete=function(){this.completed&&0===this.delayNotifierSubscriptions.length&&this.destination.complete()},e}(Kt.OuterSubscriber),Co=function(t){function e(e,r){t.call(this),this.source=e,this.subscriptionDelay=r}return wo(e,t),e.prototype._subscribe=function(t){this.subscriptionDelay.subscribe(new ko(t,this.source))},e}(_t.Observable),ko=function(t){function e(e,r){t.call(this),this.parent=e,this.source=r,this.sourceSubscribed=!1}return wo(e,t),e.prototype._next=function(t){this.subscribeToSource()},e.prototype._error=function(t){this.unsubscribe(),this.parent.error(t)},e.prototype._complete=function(){this.subscribeToSource()},e.prototype.subscribeToSource=function(){this.sourceSubscribed||(this.sourceSubscribed=!0,this.unsubscribe(),this.source.subscribe(this.parent))},e}(dt.Subscriber),jo={delayWhen:So},Io={delayWhen:function(t,e){return jo.delayWhen(t,e)(this)}};_t.Observable.prototype.delayWhen=Io.delayWhen;var To={minimalSetImpl:W,Set:Z.root.Set||W()},Eo=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Po=function(t,e){return function(r){return r.lift(new Ao(t,e))}},Ao=function(){function t(t,e){this.keySelector=t,this.flushes=e}return t.prototype.call=function(t,e){return e.subscribe(new No(t,this.keySelector,this.flushes))},t}(),No=function(t){function e(e,r,i){t.call(this,e),this.keySelector=r,this.values=new To.Set,i&&this.add(Qt.subscribeToResult(this,i))}return Eo(e,t),e.prototype.notifyNext=function(t,e,r,i,n){this.values.clear()},e.prototype.notifyError=function(t,e){this._error(t)},e.prototype._next=function(t){this.keySelector?this._useKeySelector(t):this._finalizeNext(t,t)},e.prototype._useKeySelector=function(t){var e,r=this.destination;try{e=this.keySelector(t)}catch(t){return void r.error(t)}this._finalizeNext(e,t)},e.prototype._finalizeNext=function(t,e){var r=this.values;r.has(t)||(r.add(t),this.destination.next(e))},e}(Kt.OuterSubscriber),Fo={distinct:Po,DistinctSubscriber:No},Vo={distinct:function(t,e){return Fo.distinct(t,e)(this)}};_t.Observable.prototype.distinct=Vo.distinct;var Do=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},zo=function(t,e){return function(r){return r.lift(new Ro(t,e))}},Ro=function(){function t(t,e){this.compare=t,this.keySelector=e}return t.prototype.call=function(t,e){return e.subscribe(new Wo(t,this.compare,this.keySelector))},t}(),Wo=function(t){function e(e,r,i){t.call(this,e),this.keySelector=i,this.hasKey=!1,"function"==typeof r&&(this.compare=r)}return Do(e,t),e.prototype.compare=function(t,e){return t===e},e.prototype._next=function(t){var e=t;if(this.keySelector&&(e=nt.tryCatch(this.keySelector)(t))===it.errorObject)return this.destination.error(it.errorObject.e);var r=!1;if(this.hasKey){if((r=nt.tryCatch(this.compare)(this.key,e))===it.errorObject)return this.destination.error(it.errorObject.e)}else this.hasKey=!0;!1===Boolean(r)&&(this.key=e,this.destination.next(t))},e}(dt.Subscriber),Mo={distinctUntilChanged:zo},Lo={distinctUntilChanged:function(t,e){return Mo.distinctUntilChanged(t,e)(this)}};_t.Observable.prototype.distinctUntilChanged=Lo.distinctUntilChanged;var Uo={distinctUntilKeyChanged:function(t,e){return Mo.distinctUntilChanged(function(r,i){return e?e(r[t],i[t]):r[t]===i[t]})}},qo={distinctUntilKeyChanged:function(t,e){return Uo.distinctUntilKeyChanged(t,e)(this)}};_t.Observable.prototype.distinctUntilKeyChanged=qo.distinctUntilKeyChanged;var Bo=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Ko=function(t,e,r){return function(i){return i.lift(new Ho(t,e,r))}},Ho=function(){function t(t,e,r){this.nextOrObserver=t,this.error=e,this.complete=r}return t.prototype.call=function(t,e){return e.subscribe(new Yo(t,this.nextOrObserver,this.error,this.complete))},t}(),Yo=function(t){function e(e,r,i,n){t.call(this,e);var o=new dt.Subscriber(r,i,n);o.syncErrorThrowable=!0,this.add(o),this.safeSubscriber=o}return Bo(e,t),e.prototype._next=function(t){var e=this.safeSubscriber;e.next(t),e.syncErrorThrown?this.destination.error(e.syncErrorValue):this.destination.next(t)},e.prototype._error=function(t){var e=this.safeSubscriber;e.error(t),e.syncErrorThrown?this.destination.error(e.syncErrorValue):this.destination.error(t)},e.prototype._complete=function(){var t=this.safeSubscriber;t.complete(),t.syncErrorThrown?this.destination.error(t.syncErrorValue):this.destination.complete()},e}(dt.Subscriber),Go={tap:Ko},Jo={_do:function(t,e,r){return Go.tap(t,e,r)(this)}};_t.Observable.prototype.do=Jo._do,_t.Observable.prototype._do=Jo._do;var Xo=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Qo=function(){return function(t){return t.lift(new $o)}},$o=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new Zo(t))},t}(),Zo=function(t){function e(e){t.call(this,e),this.hasCompleted=!1,this.hasSubscription=!1}return Xo(e,t),e.prototype._next=function(t){this.hasSubscription||(this.hasSubscription=!0,this.add(Qt.subscribeToResult(this,t)))},e.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete()},e.prototype.notifyComplete=function(t){this.remove(t),this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},e}(Kt.OuterSubscriber),ts={exhaust:Qo},es={exhaust:function(){return ts.exhaust()(this)}};_t.Observable.prototype.exhaust=es.exhaust;var rs=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},is=function(t,e){return function(r){return r.lift(new ns(t,e))}},ns=function(){function t(t,e){this.project=t,this.resultSelector=e}return t.prototype.call=function(t,e){return e.subscribe(new os(t,this.project,this.resultSelector))},t}(),os=function(t){function e(e,r,i){t.call(this,e),this.project=r,this.resultSelector=i,this.hasSubscription=!1,this.hasCompleted=!1,this.index=0}return rs(e,t),e.prototype._next=function(t){this.hasSubscription||this.tryNext(t)},e.prototype.tryNext=function(t){var e=this.index++,r=this.destination;try{var i=this.project(t,e);this.hasSubscription=!0,this.add(Qt.subscribeToResult(this,i,t,e))}catch(t){r.error(t)}},e.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete()},e.prototype.notifyNext=function(t,e,r,i,n){var o=this.resultSelector,s=this.destination;o?this.trySelectResult(t,e,r,i):s.next(e)},e.prototype.trySelectResult=function(t,e,r,i){var n=this.resultSelector,o=this.destination;try{var s=n(t,e,r,i);o.next(s)}catch(t){o.error(t)}},e.prototype.notifyError=function(t){this.destination.error(t)},e.prototype.notifyComplete=function(t){this.remove(t),this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},e}(Kt.OuterSubscriber),ss={exhaustMap:is},cs={exhaustMap:function(t,e){return ss.exhaustMap(t,e)(this)}};_t.Observable.prototype.exhaustMap=cs.exhaustMap;var us=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},as=function(t,e,r){return void 0===e&&(e=Number.POSITIVE_INFINITY),void 0===r&&(r=void 0),e=(e||0)<1?Number.POSITIVE_INFINITY:e,function(i){return i.lift(new hs(t,e,r))}},hs=function(){function t(t,e,r){this.project=t,this.concurrent=e,this.scheduler=r}return t.prototype.call=function(t,e){return e.subscribe(new ps(t,this.project,this.concurrent,this.scheduler))},t}(),ls=hs,ps=function(t){function e(e,r,i,n){t.call(this,e),this.project=r,this.concurrent=i,this.scheduler=n,this.index=0,this.active=0,this.hasCompleted=!1,i<Number.POSITIVE_INFINITY&&(this.buffer=[])}return us(e,t),e.dispatch=function(t){var e=t.subscriber,r=t.result,i=t.value,n=t.index;e.subscribeToProjection(r,i,n)},e.prototype._next=function(t){var r=this.destination;if(r.closed)this._complete();else{var i=this.index++;if(this.active<this.concurrent){r.next(t);var n=nt.tryCatch(this.project)(t,i);if(n===it.errorObject)r.error(it.errorObject.e);else if(this.scheduler){var o={subscriber:this,result:n,value:t,index:i};this.add(this.scheduler.schedule(e.dispatch,0,o))}else this.subscribeToProjection(n,t,i)}else this.buffer.push(t)}},e.prototype.subscribeToProjection=function(t,e,r){this.active++,this.add(Qt.subscribeToResult(this,t,e,r))},e.prototype._complete=function(){this.hasCompleted=!0,this.hasCompleted&&0===this.active&&this.destination.complete()},e.prototype.notifyNext=function(t,e,r,i,n){this._next(e)},e.prototype.notifyComplete=function(t){var e=this.buffer;this.remove(t),this.active--,e&&e.length>0&&this._next(e.shift()),this.hasCompleted&&0===this.active&&this.destination.complete()},e}(Kt.OuterSubscriber),fs={expand:as,ExpandOperator:ls,ExpandSubscriber:ps},ds={expand:function(t,e,r){return void 0===e&&(e=Number.POSITIVE_INFINITY),void 0===r&&(r=void 0),e=(e||0)<1?Number.POSITIVE_INFINITY:e,fs.expand(t,e,r)(this)}};_t.Observable.prototype.expand=ds.expand;var bs=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},ys={ArgumentOutOfRangeError:function(t){function e(){var e=t.call(this,"argument out of range");this.name=e.name="ArgumentOutOfRangeError",this.stack=e.stack,this.message=e.message}return bs(e,t),e}(Error)},ms=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},vs=function(t,e){return function(r){return r.lift(new _s(t,e))}},_s=function(){function t(t,e){if(this.index=t,this.defaultValue=e,t<0)throw new ys.ArgumentOutOfRangeError}return t.prototype.call=function(t,e){return e.subscribe(new gs(t,this.index,this.defaultValue))},t}(),gs=function(t){function e(e,r,i){t.call(this,e),this.index=r,this.defaultValue=i}return ms(e,t),e.prototype._next=function(t){0==this.index--&&(this.destination.next(t),this.destination.complete())},e.prototype._complete=function(){var t=this.destination;this.index>=0&&(void 0!==this.defaultValue?t.next(this.defaultValue):t.error(new ys.ArgumentOutOfRangeError)),t.complete()},e}(dt.Subscriber),ws={elementAt:vs},Ss={elementAt:function(t,e){return ws.elementAt(t,e)(this)}};_t.Observable.prototype.elementAt=Ss.elementAt;var Os=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},xs=function(t,e){return function(r){return r.lift(new Cs(t,e))}},Cs=function(){function t(t,e){this.predicate=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new ks(t,this.predicate,this.thisArg))},t}(),ks=function(t){function e(e,r,i){t.call(this,e),this.predicate=r,this.thisArg=i,this.count=0}return Os(e,t),e.prototype._next=function(t){var e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}e&&this.destination.next(t)},e}(dt.Subscriber),js={filter:xs},Is={filter:function(t,e){return js.filter(t,e)(this)}};_t.Observable.prototype.filter=Is.filter;var Ts=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Es=function(t){return function(e){return e.lift(new Ps(t))}},Ps=function(){function t(t){this.callback=t}return t.prototype.call=function(t,e){return e.subscribe(new As(t,this.callback))},t}(),As=function(t){function e(e,r){t.call(this,e),this.add(new ct.Subscription(r))}return Ts(e,t),e}(dt.Subscriber),Ns={finalize:Es},Fs={_finally:function(t){return Ns.finalize(t)(this)}};_t.Observable.prototype.finally=Fs._finally,_t.Observable.prototype._finally=Fs._finally;var Vs=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Ds=function(t,e){if("function"!=typeof t)throw new TypeError("predicate is not a function");return function(r){return r.lift(new zs(t,r,!1,e))}},zs=function(){function t(t,e,r,i){this.predicate=t,this.source=e,this.yieldIndex=r,this.thisArg=i}return t.prototype.call=function(t,e){return e.subscribe(new Ws(t,this.predicate,this.source,this.yieldIndex,this.thisArg))},t}(),Rs=zs,Ws=function(t){function e(e,r,i,n,o){t.call(this,e),this.predicate=r,this.source=i,this.yieldIndex=n,this.thisArg=o,this.index=0}return Vs(e,t),e.prototype.notifyComplete=function(t){var e=this.destination;e.next(t),e.complete()},e.prototype._next=function(t){var e=this.predicate,r=this.thisArg,i=this.index++;try{e.call(r||this,t,i,this.source)&&this.notifyComplete(this.yieldIndex?i:t)}catch(t){this.destination.error(t)}},e.prototype._complete=function(){this.notifyComplete(this.yieldIndex?-1:void 0)},e}(dt.Subscriber),Ms={find:Ds,FindValueOperator:Rs,FindValueSubscriber:Ws},Ls={find:function(t,e){return Ms.find(t,e)(this)}};_t.Observable.prototype.find=Ls.find;var Us={findIndex:function(t,e){return function(r){return r.lift(new Ms.FindValueOperator(t,r,!0,e))}}},qs={findIndex:function(t,e){return Us.findIndex(t,e)(this)}};_t.Observable.prototype.findIndex=qs.findIndex;var Bs=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Ks={EmptyError:function(t){function e(){var e=t.call(this,"no elements in sequence");this.name=e.name="EmptyError",this.stack=e.stack,this.message=e.message}return Bs(e,t),e}(Error)},Hs=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Ys=function(t,e,r){return function(i){return i.lift(new Gs(t,e,r,i))}},Gs=function(){function t(t,e,r,i){this.predicate=t,this.resultSelector=e,this.defaultValue=r,this.source=i}return t.prototype.call=function(t,e){return e.subscribe(new Js(t,this.predicate,this.resultSelector,this.defaultValue,this.source))},t}(),Js=function(t){function e(e,r,i,n,o){t.call(this,e),this.predicate=r,this.resultSelector=i,this.defaultValue=n,this.source=o,this.index=0,this.hasCompleted=!1,this._emitted=!1}return Hs(e,t),e.prototype._next=function(t){var e=this.index++;this.predicate?this._tryPredicate(t,e):this._emit(t,e)},e.prototype._tryPredicate=function(t,e){var r;try{r=this.predicate(t,e,this.source)}catch(t){return void this.destination.error(t)}r&&this._emit(t,e)},e.prototype._emit=function(t,e){this.resultSelector?this._tryResultSelector(t,e):this._emitFinal(t)},e.prototype._tryResultSelector=function(t,e){var r;try{r=this.resultSelector(t,e)}catch(t){return void this.destination.error(t)}this._emitFinal(r)},e.prototype._emitFinal=function(t){var e=this.destination;this._emitted||(this._emitted=!0,e.next(t),e.complete(),this.hasCompleted=!0)},e.prototype._complete=function(){var t=this.destination;this.hasCompleted||void 0===this.defaultValue?this.hasCompleted||t.error(new Ks.EmptyError):(t.next(this.defaultValue),t.complete())},e}(dt.Subscriber),Xs={first:Ys},Qs={first:function(t,e,r){return Xs.first(t,e,r)(this)}};_t.Observable.prototype.first=Qs.first;var $s={MapPolyfill:function(){function t(){this.size=0,this._values=[],this._keys=[]}return t.prototype.get=function(t){var e=this._keys.indexOf(t);return-1===e?void 0:this._values[e]},t.prototype.set=function(t,e){var r=this._keys.indexOf(t);return-1===r?(this._keys.push(t),this._values.push(e),this.size++):this._values[r]=e,this},t.prototype.delete=function(t){var e=this._keys.indexOf(t);return-1!==e&&(this._values.splice(e,1),this._keys.splice(e,1),this.size--,!0)},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this.size=0},t.prototype.forEach=function(t,e){for(var r=0;r<this.size;r++)t.call(e,this._values[r],this._keys[r])},t}()},Zs={Map:Z.root.Map||$s.MapPolyfill},tc={FastMap:function(){function t(){this.values={}}return t.prototype.delete=function(t){return this.values[t]=null,!0},t.prototype.set=function(t,e){return this.values[t]=e,this},t.prototype.get=function(t){return this.values[t]},t.prototype.forEach=function(t,e){var r=this.values;for(var i in r)r.hasOwnProperty(i)&&null!==r[i]&&t.call(e,r[i],i)},t.prototype.clear=function(){this.values={}},t}()},ec=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},rc=function(t,e,r,i){return function(n){return n.lift(new ic(t,e,r,i))}},ic=function(){function t(t,e,r,i){this.keySelector=t,this.elementSelector=e,this.durationSelector=r,this.subjectSelector=i}return t.prototype.call=function(t,e){return e.subscribe(new nc(t,this.keySelector,this.elementSelector,this.durationSelector,this.subjectSelector))},t}(),nc=function(t){function e(e,r,i,n,o){t.call(this,e),this.keySelector=r,this.elementSelector=i,this.durationSelector=n,this.subjectSelector=o,this.groups=null,this.attemptedToUnsubscribe=!1,this.count=0}return ec(e,t),e.prototype._next=function(t){var e;try{e=this.keySelector(t)}catch(t){return void this.error(t)}this._group(t,e)},e.prototype._group=function(t,e){var r=this.groups;r||(r=this.groups="string"==typeof e?new tc.FastMap:new Zs.Map);var i,n=r.get(e);if(this.elementSelector)try{i=this.elementSelector(t)}catch(t){this.error(t)}else i=t;if(!n){n=this.subjectSelector?this.subjectSelector():new Et.Subject,r.set(e,n);var o=new sc(e,n,this);if(this.destination.next(o),this.durationSelector){var s=void 0;try{s=this.durationSelector(new sc(e,n))}catch(t){return void this.error(t)}this.add(s.subscribe(new oc(e,n,this)))}}n.closed||n.next(i)},e.prototype._error=function(t){var e=this.groups;e&&(e.forEach(function(e,r){e.error(t)}),e.clear()),this.destination.error(t)},e.prototype._complete=function(){var t=this.groups;t&&(t.forEach(function(t,e){t.complete()}),t.clear()),this.destination.complete()},e.prototype.removeGroup=function(t){this.groups.delete(t)},e.prototype.unsubscribe=function(){this.closed||(this.attemptedToUnsubscribe=!0,0===this.count&&t.prototype.unsubscribe.call(this))},e}(dt.Subscriber),oc=function(t){function e(e,r,i){t.call(this,r),this.key=e,this.group=r,this.parent=i}return ec(e,t),e.prototype._next=function(t){this.complete()},e.prototype._unsubscribe=function(){var t=this.parent,e=this.key;this.key=this.parent=null,t&&t.removeGroup(e)},e}(dt.Subscriber),sc=function(t){function e(e,r,i){t.call(this),this.key=e,this.groupSubject=r,this.refCountSubscription=i}return ec(e,t),e.prototype._subscribe=function(t){var e=new ct.Subscription,r=this.refCountSubscription,i=this.groupSubject;return r&&!r.closed&&e.add(new uc(r)),e.add(i.subscribe(t)),e},e}(_t.Observable),cc=sc,uc=function(t){function e(e){t.call(this),this.parent=e,e.count++}return ec(e,t),e.prototype.unsubscribe=function(){var e=this.parent;e.closed||this.closed||(t.prototype.unsubscribe.call(this),e.count-=1,0===e.count&&e.attemptedToUnsubscribe&&e.unsubscribe())},e}(ct.Subscription),ac={groupBy:rc,GroupedObservable:cc},hc={GroupedObservable:ac.GroupedObservable,groupBy:function(t,e,r,i){return ac.groupBy(t,e,r,i)(this)}};_t.Observable.prototype.groupBy=hc.groupBy;var lc=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},pc=function(){return function(t){return t.lift(new fc)}},fc=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new dc(t))},t}(),dc=function(t){function e(){t.apply(this,arguments)}return lc(e,t),e.prototype._next=function(t){mt.noop()},e}(dt.Subscriber),bc={ignoreElements:pc},yc={ignoreElements:function(){return bc.ignoreElements()(this)}};_t.Observable.prototype.ignoreElements=yc.ignoreElements;var mc=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},vc=function(){return function(t){return t.lift(new _c)}},_c=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new gc(t))},t}(),gc=function(t){function e(e){t.call(this,e)}return mc(e,t),e.prototype.notifyComplete=function(t){var e=this.destination;e.next(t),e.complete()},e.prototype._next=function(t){this.notifyComplete(!1)},e.prototype._complete=function(){this.notifyComplete(!0)},e}(dt.Subscriber),wc={isEmpty:vc},Sc={isEmpty:function(){return wc.isEmpty()(this)}};_t.Observable.prototype.isEmpty=Sc.isEmpty;var Oc=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},xc=function(t){return function(e){return e.lift(new Cc(t))}},Cc=function(){function t(t){this.durationSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new kc(t,this.durationSelector))},t}(),kc=function(t){function e(e,r){t.call(this,e),this.durationSelector=r,this.hasValue=!1}return Oc(e,t),e.prototype._next=function(t){if(this.value=t,this.hasValue=!0,!this.throttled){var e=nt.tryCatch(this.durationSelector)(t);if(e===it.errorObject)this.destination.error(it.errorObject.e);else{var r=Qt.subscribeToResult(this,e);r.closed?this.clearThrottle():this.add(this.throttled=r)}}},e.prototype.clearThrottle=function(){var t=this.value,e=this.hasValue,r=this.throttled;r&&(this.remove(r),this.throttled=null,r.unsubscribe()),e&&(this.value=null,this.hasValue=!1,this.destination.next(t))},e.prototype.notifyNext=function(t,e,r,i){this.clearThrottle()},e.prototype.notifyComplete=function(){this.clearThrottle()},e}(Kt.OuterSubscriber),jc={audit:xc},Ic={audit:function(t){return jc.audit(t)(this)}};_t.Observable.prototype.audit=Ic.audit;var Tc={auditTime:function(t,e){return void 0===e&&(e=br.async),jc.audit(function(){return Gr.timer(t,e)})}},Ec={auditTime:function(t,e){return void 0===e&&(e=br.async),Tc.auditTime(t,e)(this)}};_t.Observable.prototype.auditTime=Ec.auditTime;var Pc=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Ac=function(t,e,r){return function(i){return i.lift(new Nc(t,e,r,i))}},Nc=function(){function t(t,e,r,i){this.predicate=t,this.resultSelector=e,this.defaultValue=r,this.source=i}return t.prototype.call=function(t,e){return e.subscribe(new Fc(t,this.predicate,this.resultSelector,this.defaultValue,this.source))},t}(),Fc=function(t){function e(e,r,i,n,o){t.call(this,e),this.predicate=r,this.resultSelector=i,this.defaultValue=n,this.source=o,this.hasValue=!1,this.index=0,void 0!==n&&(this.lastValue=n,this.hasValue=!0)}return Pc(e,t),e.prototype._next=function(t){var e=this.index++;if(this.predicate)this._tryPredicate(t,e);else{if(this.resultSelector)return void this._tryResultSelector(t,e);this.lastValue=t,this.hasValue=!0}},e.prototype._tryPredicate=function(t,e){var r;try{r=this.predicate(t,e,this.source)}catch(t){return void this.destination.error(t)}if(r){if(this.resultSelector)return void this._tryResultSelector(t,e);this.lastValue=t,this.hasValue=!0}},e.prototype._tryResultSelector=function(t,e){var r;try{r=this.resultSelector(t,e)}catch(t){return void this.destination.error(t)}this.lastValue=r,this.hasValue=!0},e.prototype._complete=function(){var t=this.destination;this.hasValue?(t.next(this.lastValue),t.complete()):t.error(new Ks.EmptyError)},e}(dt.Subscriber),Vc={last:Ac},Dc={last:function(t,e,r){return Vc.last(t,e,r)(this)}};_t.Observable.prototype.last=Dc.last;var zc={letProto:function(t){return t(this)}};_t.Observable.prototype.let=zc.letProto,_t.Observable.prototype.letBind=zc.letProto;var Rc=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Wc=function(t,e){return function(r){return r.lift(new Mc(t,e,r))}},Mc=function(){function t(t,e,r){this.predicate=t,this.thisArg=e,this.source=r}return t.prototype.call=function(t,e){return e.subscribe(new Lc(t,this.predicate,this.thisArg,this.source))},t}(),Lc=function(t){function e(e,r,i,n){t.call(this,e),this.predicate=r,this.thisArg=i,this.source=n,this.index=0,this.thisArg=i||this}return Rc(e,t),e.prototype.notifyComplete=function(t){this.destination.next(t),this.destination.complete()},e.prototype._next=function(t){var e=!1;try{e=this.predicate.call(this.thisArg,t,this.index++,this.source)}catch(t){return void this.destination.error(t)}e||this.notifyComplete(!1)},e.prototype._complete=function(){this.notifyComplete(!0)},e}(dt.Subscriber),Uc={every:Wc},qc={every:function(t,e){return Uc.every(t,e)(this)}};_t.Observable.prototype.every=qc.every;var Bc={map:function(t,e){return pi.map(t,e)(this)}};_t.Observable.prototype.map=Bc.map;var Kc=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Hc=function(t){return function(e){return e.lift(new Yc(t))}},Yc=function(){function t(t){this.value=t}return t.prototype.call=function(t,e){return e.subscribe(new Gc(t,this.value))},t}(),Gc=function(t){function e(e,r){t.call(this,e),this.value=r}return Kc(e,t),e.prototype._next=function(t){this.destination.next(this.value)},e}(dt.Subscriber),Jc={mapTo:Hc},Xc={mapTo:function(t){return Jc.mapTo(t)(this)}};_t.Observable.prototype.mapTo=Xc.mapTo;var Qc=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},$c=function(){return function(t){return t.lift(new Zc)}},Zc=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new tu(t))},t}(),tu=function(t){function e(e){t.call(this,e)}return Qc(e,t),e.prototype._next=function(t){this.destination.next(me.Notification.createNext(t))},e.prototype._error=function(t){var e=this.destination;e.next(me.Notification.createError(t)),e.complete()},e.prototype._complete=function(){var t=this.destination;t.next(me.Notification.createComplete()),t.complete()},e}(dt.Subscriber),eu={materialize:$c},ru={materialize:function(){return eu.materialize()(this)}};_t.Observable.prototype.materialize=ru.materialize;var iu=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},nu=function(t,e){var r=!1;return arguments.length>=2&&(r=!0),function(i){return i.lift(new ou(t,e,r))}},ou=function(){function t(t,e,r){void 0===r&&(r=!1),this.accumulator=t,this.seed=e,this.hasSeed=r}return t.prototype.call=function(t,e){return e.subscribe(new su(t,this.accumulator,this.seed,this.hasSeed))},t}(),su=function(t){function e(e,r,i,n){t.call(this,e),this.accumulator=r,this._seed=i,this.hasSeed=n,this.index=0}return iu(e,t),Object.defineProperty(e.prototype,"seed",{get:function(){return this._seed},set:function(t){this.hasSeed=!0,this._seed=t},enumerable:!0,configurable:!0}),e.prototype._next=function(t){if(this.hasSeed)return this._tryNext(t);this.seed=t,this.destination.next(t)},e.prototype._tryNext=function(t){var e,r=this.index++;try{e=this.accumulator(this.seed,t,r)}catch(t){this.destination.error(t)}this.seed=e,this.destination.next(e)},e}(dt.Subscriber),cu={scan:nu},uu=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},au=function(t){return function(e){return 0===t?new Lt.EmptyObservable:e.lift(new hu(t))}},hu=function(){function t(t){if(this.total=t,this.total<0)throw new ys.ArgumentOutOfRangeError}return t.prototype.call=function(t,e){return e.subscribe(new lu(t,this.total))},t}(),lu=function(t){function e(e,r){t.call(this,e),this.total=r,this.ring=new Array,this.count=0}return uu(e,t),e.prototype._next=function(t){var e=this.ring,r=this.total,i=this.count++;if(e.length<r)e.push(t);else{e[i%r]=t}},e.prototype._complete=function(){var t=this.destination,e=this.count;if(e>0)for(var r=this.count>=this.total?this.total:this.count,i=this.ring,n=0;n<r;n++){var o=e++%r;t.next(i[o])}t.complete()},e}(dt.Subscriber),pu={takeLast:au},fu={reduce:function(t,e){return arguments.length>=2?function(r){return vt.pipe(cu.scan(t,e),pu.takeLast(1),lo.defaultIfEmpty(e))(r)}:function(e){return vt.pipe(cu.scan(function(e,r,i){return t(e,r,i+1)}),pu.takeLast(1))(e)}}},du={max:function(t){var e="function"==typeof t?function(e,r){return t(e,r)>0?e:r}:function(t,e){return t>e?t:e};return fu.reduce(e)}},bu={max:function(t){return du.max(t)(this)}};_t.Observable.prototype.max=bu.max,_t.Observable.prototype.merge=_r.merge;var yu={mergeAll:function(t){return void 0===t&&(t=Number.POSITIVE_INFINITY),De.mergeAll(t)(this)}};_t.Observable.prototype.mergeAll=yu.mergeAll;var mu={mergeMap:function(t,e,r){return void 0===r&&(r=Number.POSITIVE_INFINITY),Fe.mergeMap(t,e,r)(this)}};_t.Observable.prototype.mergeMap=mu.mergeMap,_t.Observable.prototype.flatMap=mu.mergeMap;var vu=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},_u=function(t,e,r){return void 0===r&&(r=Number.POSITIVE_INFINITY),"number"==typeof e&&(r=e,e=null),function(i){return i.lift(new gu(t,e,r))}},gu=function(){function t(t,e,r){void 0===r&&(r=Number.POSITIVE_INFINITY),this.ish=t,this.resultSelector=e,this.concurrent=r}return t.prototype.call=function(t,e){return e.subscribe(new Su(t,this.ish,this.resultSelector,this.concurrent))},t}(),wu=gu,Su=function(t){function e(e,r,i,n){void 0===n&&(n=Number.POSITIVE_INFINITY),t.call(this,e),this.ish=r,this.resultSelector=i,this.concurrent=n,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}return vu(e,t),e.prototype._next=function(t){if(this.active<this.concurrent){var e=this.resultSelector,r=this.index++,i=this.ish,n=this.destination;this.active++,this._innerSub(i,n,e,t,r)}else this.buffer.push(t)},e.prototype._innerSub=function(t,e,r,i,n){this.add(Qt.subscribeToResult(this,t,i,n))},e.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete()},e.prototype.notifyNext=function(t,e,r,i,n){var o=this.resultSelector,s=this.destination;o?this.trySelectResult(t,e,r,i):s.next(e)},e.prototype.trySelectResult=function(t,e,r,i){var n,o=this.resultSelector,s=this.destination;try{n=o(t,e,r,i)}catch(t){return void s.error(t)}s.next(n)},e.prototype.notifyError=function(t){this.destination.error(t)},e.prototype.notifyComplete=function(t){var e=this.buffer;this.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},e}(Kt.OuterSubscriber),Ou={mergeMapTo:_u,MergeMapToOperator:wu,MergeMapToSubscriber:Su},xu={mergeMapTo:function(t,e,r){return void 0===r&&(r=Number.POSITIVE_INFINITY),Ou.mergeMapTo(t,e,r)(this)}};_t.Observable.prototype.flatMapTo=xu.mergeMapTo,_t.Observable.prototype.mergeMapTo=xu.mergeMapTo;var Cu=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},ku=function(t,e,r){return void 0===r&&(r=Number.POSITIVE_INFINITY),function(i){return i.lift(new ju(t,e,r))}},ju=function(){function t(t,e,r){this.accumulator=t,this.seed=e,this.concurrent=r}return t.prototype.call=function(t,e){return e.subscribe(new Tu(t,this.accumulator,this.seed,this.concurrent))},t}(),Iu=ju,Tu=function(t){function e(e,r,i,n){t.call(this,e),this.accumulator=r,this.acc=i,this.concurrent=n,this.hasValue=!1,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}return Cu(e,t),e.prototype._next=function(t){if(this.active<this.concurrent){var e=this.index++,r=nt.tryCatch(this.accumulator)(this.acc,t),i=this.destination;r===it.errorObject?i.error(it.errorObject.e):(this.active++,this._innerSub(r,t,e))}else this.buffer.push(t)},e.prototype._innerSub=function(t,e,r){this.add(Qt.subscribeToResult(this,t,e,r))},e.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&(!1===this.hasValue&&this.destination.next(this.acc),this.destination.complete())},e.prototype.notifyNext=function(t,e,r,i,n){var o=this.destination;this.acc=e,this.hasValue=!0,o.next(e)},e.prototype.notifyComplete=function(t){var e=this.buffer;this.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&(!1===this.hasValue&&this.destination.next(this.acc),this.destination.complete())},e}(Kt.OuterSubscriber),Eu={mergeScan:ku,MergeScanOperator:Iu,MergeScanSubscriber:Tu},Pu={mergeScan:function(t,e,r){return void 0===r&&(r=Number.POSITIVE_INFINITY),Eu.mergeScan(t,e,r)(this)}};_t.Observable.prototype.mergeScan=Pu.mergeScan;var Au={min:function(t){var e="function"==typeof t?function(e,r){return t(e,r)<0?e:r}:function(t,e){return t<e?t:e};return fu.reduce(e)}},Nu={min:function(t){return Au.min(t)(this)}};_t.Observable.prototype.min=Nu.min;var Fu=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Vu=function(){return function(t){return t.lift(new Du(t))}},Du=function(){function t(t){this.connectable=t}return t.prototype.call=function(t,e){var r=this.connectable;r._refCount++;var i=new zu(t,r),n=e.subscribe(i);return i.closed||(i.connection=r.connect()),n},t}(),zu=function(t){function e(e,r){t.call(this,e),this.connectable=r}return Fu(e,t),e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._refCount;if(e<=0)this.connection=null;else if(t._refCount=e-1,e>1)this.connection=null;else{var r=this.connection,i=t._connection;this.connection=null,!i||r&&i!==r||i.unsubscribe()}}else this.connection=null},e}(dt.Subscriber),Ru={refCount:Vu},Wu=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Mu=function(t){function e(e,r){t.call(this),this.source=e,this.subjectFactory=r,this._refCount=0,this._isComplete=!1}return Wu(e,t),e.prototype._subscribe=function(t){return this.getSubject().subscribe(t)},e.prototype.getSubject=function(){var t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject},e.prototype.connect=function(){var t=this._connection;return t||(this._isComplete=!1,(t=this._connection=new ct.Subscription).add(this.source.subscribe(new Bu(this.getSubject(),this))),t.closed?(this._connection=null,t=ct.Subscription.EMPTY):this._connection=t),t},e.prototype.refCount=function(){return Ru.refCount()(this)},e}(_t.Observable),Lu=Mu,Uu=Mu.prototype,qu={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:Uu._subscribe},_isComplete:{value:Uu._isComplete,writable:!0},getSubject:{value:Uu.getSubject},connect:{value:Uu.connect},refCount:{value:Uu.refCount}},Bu=function(t){function e(e,r){t.call(this,e),this.connectable=r}return Wu(e,t),e.prototype._error=function(e){this._unsubscribe(),t.prototype._error.call(this,e)},e.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}},e}(Et.SubjectSubscriber),Ku=(function(){function t(t){this.connectable=t}t.prototype.call=function(t,e){var r=this.connectable;r._refCount++;var i=new Ku(t,r),n=e.subscribe(i);return i.closed||(i.connection=r.connect()),n}}(),function(t){function e(e,r){t.call(this,e),this.connectable=r}return Wu(e,t),e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._refCount;if(e<=0)this.connection=null;else if(t._refCount=e-1,e>1)this.connection=null;else{var r=this.connection,i=t._connection;this.connection=null,!i||r&&i!==r||i.unsubscribe()}}else this.connection=null},e}(dt.Subscriber)),Hu={ConnectableObservable:Lu,connectableObservableDescriptor:qu},Yu=function(t,e){return function(r){var i;if(i="function"==typeof t?t:function(){return t},"function"==typeof e)return r.lift(new Gu(i,e));var n=Object.create(r,Hu.connectableObservableDescriptor);return n.source=r,n.subjectFactory=i,n}},Gu=function(){function t(t,e){this.subjectFactory=t,this.selector=e}return t.prototype.call=function(t,e){var r=this.selector,i=this.subjectFactory(),n=r(i).subscribe(t);return n.add(e.subscribe(i)),n},t}(),Ju={multicast:Yu,MulticastOperator:Gu},Xu={multicast:function(t,e){return Ju.multicast(t,e)(this)}};_t.Observable.prototype.multicast=Xu.multicast;var Qu={observeOn:function(t,e){return void 0===e&&(e=0),Ce.observeOn(t,e)(this)}};_t.Observable.prototype.observeOn=Qu.observeOn;var $u={onErrorResumeNext:function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return Fr.onErrorResumeNext.apply(void 0,t)(this)}};_t.Observable.prototype.onErrorResumeNext=$u.onErrorResumeNext;var Zu=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},ta=function(){return function(t){return t.lift(new ea)}},ea=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new ra(t))},t}(),ra=function(t){function e(e){t.call(this,e),this.hasPrev=!1}return Zu(e,t),e.prototype._next=function(t){this.hasPrev?this.destination.next([this.prev,t]):this.hasPrev=!0,this.prev=t},e}(dt.Subscriber),ia={pairwise:ta},na={pairwise:function(){return ia.pairwise()(this)}};_t.Observable.prototype.pairwise=na.pairwise;var oa={not:function(t,e){function r(){return!r.pred.apply(r.thisArg,arguments)}return r.pred=t,r.thisArg=e,r}},sa={partition:function(t,e){return function(r){return[js.filter(t,e)(r),js.filter(oa.not(t,e))(r)]}}},ca={partition:function(t,e){return sa.partition(t,e)(this)}};_t.Observable.prototype.partition=ca.partition;var ua={pluck:function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var r=t.length;if(0===r)throw new Error("list of properties cannot be empty.");return function(e){return pi.map(function(t,e){return function(r){for(var i=r,n=0;n<e;n++){var o=i[t[n]];if(void 0===o)return;i=o}return i}}(t,r))(e)}}},aa={pluck:function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return ua.pluck.apply(void 0,t)(this)}};_t.Observable.prototype.pluck=aa.pluck;var ha={publish:function(t){return t?Ju.multicast(function(){return new Et.Subject},t):Ju.multicast(new Et.Subject)}},la={publish:function(t){return ha.publish(t)(this)}};_t.Observable.prototype.publish=la.publish;var pa=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},fa=function(t){function e(e){t.call(this),this._value=e}return pa(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),e.prototype._subscribe=function(e){var r=t.prototype._subscribe.call(this,e);return r&&!r.closed&&e.next(this._value),r},e.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new wt.ObjectUnsubscribedError;return this._value},e.prototype.next=function(e){t.prototype.next.call(this,this._value=e)},e}(Et.Subject),da={BehaviorSubject:fa},ba={publishBehavior:function(t){return function(e){return Ju.multicast(new da.BehaviorSubject(t))(e)}}},ya={publishBehavior:function(t){return ba.publishBehavior(t)(this)}};_t.Observable.prototype.publishBehavior=ya.publishBehavior;var ma={publishReplay:function(t,e,r,i){r&&"function"!=typeof r&&(i=r);var n="function"==typeof r?r:void 0,o=new Ri.ReplaySubject(t,e,i);return function(t){return Ju.multicast(function(){return o},n)(t)}}},va={publishReplay:function(t,e,r,i){return ma.publishReplay(t,e,r,i)(this)}};_t.Observable.prototype.publishReplay=va.publishReplay;var _a={publishLast:function(){return function(t){return Ju.multicast(new At.AsyncSubject)(t)}}},ga={publishLast:function(){return _a.publishLast()(this)}};_t.Observable.prototype.publishLast=ga.publishLast;var wa={race:function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return function(e){return 1===t.length&&et.isArray(t[0])&&(t=t[0]),e.lift.call(kr.race.apply(void 0,[e].concat(t)))}}},Sa={raceStatic:kr.race,race:function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return wa.race.apply(void 0,t)(this)}};_t.Observable.prototype.race=Sa.race;var Oa={reduce:function(t,e){return arguments.length>=2?fu.reduce(t,e)(this):fu.reduce(t)(this)}};_t.Observable.prototype.reduce=Oa.reduce;var xa=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Ca=function(t){return void 0===t&&(t=-1),function(e){return 0===t?new Lt.EmptyObservable:t<0?e.lift(new ka(-1,e)):e.lift(new ka(t-1,e))}},ka=function(){function t(t,e){this.count=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new ja(t,this.count,this.source))},t}(),ja=function(t){function e(e,r,i){t.call(this,e),this.count=r,this.source=i}return xa(e,t),e.prototype.complete=function(){if(!this.isStopped){var e=this.source,r=this.count;if(0===r)return t.prototype.complete.call(this);r>-1&&(this.count=r-1),e.subscribe(this._unsubscribeAndRecycle())}},e}(dt.Subscriber),Ia={repeat:Ca},Ta={repeat:function(t){return void 0===t&&(t=-1),Ia.repeat(t)(this)}};_t.Observable.prototype.repeat=Ta.repeat;var Ea=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Pa=function(t){return function(e){return e.lift(new Aa(t))}},Aa=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){return e.subscribe(new Na(t,this.notifier,e))},t}(),Na=function(t){function e(e,r,i){t.call(this,e),this.notifier=r,this.source=i,this.sourceIsBeingSubscribedTo=!0}return Ea(e,t),e.prototype.notifyNext=function(t,e,r,i,n){this.sourceIsBeingSubscribedTo=!0,this.source.subscribe(this)},e.prototype.notifyComplete=function(e){if(!1===this.sourceIsBeingSubscribedTo)return t.prototype.complete.call(this)},e.prototype.complete=function(){if(this.sourceIsBeingSubscribedTo=!1,!this.isStopped){if(this.retries){if(this.retriesSubscription.closed)return t.prototype.complete.call(this)}else this.subscribeToRetries();this._unsubscribeAndRecycle(),this.notifications.next()}},e.prototype._unsubscribe=function(){var t=this.notifications,e=this.retriesSubscription;t&&(t.unsubscribe(),this.notifications=null),e&&(e.unsubscribe(),this.retriesSubscription=null),this.retries=null},e.prototype._unsubscribeAndRecycle=function(){var e=this.notifications,r=this.retries,i=this.retriesSubscription;return this.notifications=null,this.retries=null,this.retriesSubscription=null,t.prototype._unsubscribeAndRecycle.call(this),this.notifications=e,this.retries=r,this.retriesSubscription=i,this},e.prototype.subscribeToRetries=function(){this.notifications=new Et.Subject;var e=nt.tryCatch(this.notifier)(this.notifications);if(e===it.errorObject)return t.prototype.complete.call(this);this.retries=e,this.retriesSubscription=Qt.subscribeToResult(this,e)},e}(Kt.OuterSubscriber),Fa={repeatWhen:Pa},Va={repeatWhen:function(t){return Fa.repeatWhen(t)(this)}};_t.Observable.prototype.repeatWhen=Va.repeatWhen;var Da=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},za=function(t){return void 0===t&&(t=-1),function(e){return e.lift(new Ra(t,e))}},Ra=function(){function t(t,e){this.count=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new Wa(t,this.count,this.source))},t}(),Wa=function(t){function e(e,r,i){t.call(this,e),this.count=r,this.source=i}return Da(e,t),e.prototype.error=function(e){if(!this.isStopped){var r=this.source,i=this.count;if(0===i)return t.prototype.error.call(this,e);i>-1&&(this.count=i-1),r.subscribe(this._unsubscribeAndRecycle())}},e}(dt.Subscriber),Ma={retry:za},La={retry:function(t){return void 0===t&&(t=-1),Ma.retry(t)(this)}};_t.Observable.prototype.retry=La.retry;var Ua=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},qa=function(t){return function(e){return e.lift(new Ba(t,e))}},Ba=function(){function t(t,e){this.notifier=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new Ka(t,this.notifier,this.source))},t}(),Ka=function(t){function e(e,r,i){t.call(this,e),this.notifier=r,this.source=i}return Ua(e,t),e.prototype.error=function(e){if(!this.isStopped){var r=this.errors,i=this.retries,n=this.retriesSubscription;if(i)this.errors=null,this.retriesSubscription=null;else{if(r=new Et.Subject,(i=nt.tryCatch(this.notifier)(r))===it.errorObject)return t.prototype.error.call(this,it.errorObject.e);n=Qt.subscribeToResult(this,i)}this._unsubscribeAndRecycle(),this.errors=r,this.retries=i,this.retriesSubscription=n,r.next(e)}},e.prototype._unsubscribe=function(){var t=this.errors,e=this.retriesSubscription;t&&(t.unsubscribe(),this.errors=null),e&&(e.unsubscribe(),this.retriesSubscription=null),this.retries=null},e.prototype.notifyNext=function(t,e,r,i,n){var o=this.errors,s=this.retries,c=this.retriesSubscription;this.errors=null,this.retries=null,this.retriesSubscription=null,this._unsubscribeAndRecycle(),this.errors=o,this.retries=s,this.retriesSubscription=c,this.source.subscribe(this)},e}(Kt.OuterSubscriber),Ha={retryWhen:qa},Ya={retryWhen:function(t){return Ha.retryWhen(t)(this)}};_t.Observable.prototype.retryWhen=Ya.retryWhen;var Ga=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Ja=function(t){return function(e){return e.lift(new Xa(t))}},Xa=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){var r=new Qa(t),i=e.subscribe(r);return i.add(Qt.subscribeToResult(r,this.notifier)),i},t}(),Qa=function(t){function e(){t.apply(this,arguments),this.hasValue=!1}return Ga(e,t),e.prototype._next=function(t){this.value=t,this.hasValue=!0},e.prototype.notifyNext=function(t,e,r,i,n){this.emitValue()},e.prototype.notifyComplete=function(){this.emitValue()},e.prototype.emitValue=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.value))},e}(Kt.OuterSubscriber),$a={sample:Ja},Za={sample:function(t){return $a.sample(t)(this)}};_t.Observable.prototype.sample=Za.sample;var th=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},eh=function(t,e){return void 0===e&&(e=br.async),function(r){return r.lift(new rh(t,e))}},rh=function(){function t(t,e){this.period=t,this.scheduler=e}return t.prototype.call=function(t,e){return e.subscribe(new ih(t,this.period,this.scheduler))},t}(),ih=function(t){function e(e,r,i){t.call(this,e),this.period=r,this.scheduler=i,this.hasValue=!1,this.add(i.schedule(M,r,{subscriber:this,period:r}))}return th(e,t),e.prototype._next=function(t){this.lastValue=t,this.hasValue=!0},e.prototype.notifyNext=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.lastValue))},e}(dt.Subscriber),nh={sampleTime:eh},oh={sampleTime:function(t,e){return void 0===e&&(e=br.async),nh.sampleTime(t,e)(this)}};_t.Observable.prototype.sampleTime=oh.sampleTime;var sh={scan:function(t,e){return arguments.length>=2?cu.scan(t,e)(this):cu.scan(t)(this)}};_t.Observable.prototype.scan=sh.scan;var ch=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},uh=function(t,e){return function(r){return r.lift(new ah(t,e))}},ah=function(){function t(t,e){this.compareTo=t,this.comparor=e}return t.prototype.call=function(t,e){return e.subscribe(new lh(t,this.compareTo,this.comparor))},t}(),hh=ah,lh=function(t){function e(e,r,i){t.call(this,e),this.compareTo=r,this.comparor=i,this._a=[],this._b=[],this._oneComplete=!1,this.add(r.subscribe(new fh(e,this)))}return ch(e,t),e.prototype._next=function(t){this._oneComplete&&0===this._b.length?this.emit(!1):(this._a.push(t),this.checkValues())},e.prototype._complete=function(){this._oneComplete?this.emit(0===this._a.length&&0===this._b.length):this._oneComplete=!0},e.prototype.checkValues=function(){for(var t=this._a,e=this._b,r=this.comparor;t.length>0&&e.length>0;){var i=t.shift(),n=e.shift(),o=!1;r?(o=nt.tryCatch(r)(i,n))===it.errorObject&&this.destination.error(it.errorObject.e):o=i===n,o||this.emit(!1)}},e.prototype.emit=function(t){var e=this.destination;e.next(t),e.complete()},e.prototype.nextB=function(t){this._oneComplete&&0===this._a.length?this.emit(!1):(this._b.push(t),this.checkValues())},e}(dt.Subscriber),ph=lh,fh=function(t){function e(e,r){t.call(this,e),this.parent=r}return ch(e,t),e.prototype._next=function(t){this.parent.nextB(t)},e.prototype._error=function(t){this.parent.error(t)},e.prototype._complete=function(){this.parent._complete()},e}(dt.Subscriber),dh={sequenceEqual:uh,SequenceEqualOperator:hh,SequenceEqualSubscriber:ph},bh={sequenceEqual:function(t,e){return dh.sequenceEqual(t,e)(this)}};_t.Observable.prototype.sequenceEqual=bh.sequenceEqual;var yh={share:function(){return function(t){return Ru.refCount()(Ju.multicast(L)(t))}}},mh={share:function(){return yh.share()(this)}};_t.Observable.prototype.share=mh.share;var vh={shareReplay:function(t,e,r){return function(i){return i.lift(function(t,e,r){var i,n,o=0,s=!1,c=!1;return function(u){o++,i&&!s||(s=!1,i=new Ri.ReplaySubject(t,e,r),n=u.subscribe({next:function(t){i.next(t)},error:function(t){s=!0,i.error(t)},complete:function(){c=!0,i.complete()}}));var a=i.subscribe(this);return function(){o--,a.unsubscribe(),n&&0===o&&c&&n.unsubscribe()}}}(t,e,r))}}},_h={shareReplay:function(t,e,r){return vh.shareReplay(t,e,r)(this)}};_t.Observable.prototype.shareReplay=_h.shareReplay;var gh=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},wh=function(t){return function(e){return e.lift(new Sh(t,e))}},Sh=function(){function t(t,e){this.predicate=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new Oh(t,this.predicate,this.source))},t}(),Oh=function(t){function e(e,r,i){t.call(this,e),this.predicate=r,this.source=i,this.seenValue=!1,this.index=0}return gh(e,t),e.prototype.applySingleValue=function(t){this.seenValue?this.destination.error("Sequence contains more than one element"):(this.seenValue=!0,this.singleValue=t)},e.prototype._next=function(t){var e=this.index++;this.predicate?this.tryNext(t,e):this.applySingleValue(t)},e.prototype.tryNext=function(t,e){try{this.predicate(t,e,this.source)&&this.applySingleValue(t)}catch(t){this.destination.error(t)}},e.prototype._complete=function(){var t=this.destination;this.index>0?(t.next(this.seenValue?this.singleValue:void 0),t.complete()):t.error(new Ks.EmptyError)},e}(dt.Subscriber),xh={single:wh},Ch={single:function(t){return xh.single(t)(this)}};_t.Observable.prototype.single=Ch.single;var kh=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},jh=function(t){return function(e){return e.lift(new Ih(t))}},Ih=function(){function t(t){this.total=t}return t.prototype.call=function(t,e){return e.subscribe(new Th(t,this.total))},t}(),Th=function(t){function e(e,r){t.call(this,e),this.total=r,this.count=0}return kh(e,t),e.prototype._next=function(t){++this.count>this.total&&this.destination.next(t)},e}(dt.Subscriber),Eh={skip:jh},Ph={skip:function(t){return Eh.skip(t)(this)}};_t.Observable.prototype.skip=Ph.skip;var Ah=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Nh=function(t){return function(e){return e.lift(new Fh(t))}},Fh=function(){function t(t){if(this._skipCount=t,this._skipCount<0)throw new ys.ArgumentOutOfRangeError}return t.prototype.call=function(t,e){return 0===this._skipCount?e.subscribe(new dt.Subscriber(t)):e.subscribe(new Vh(t,this._skipCount))},t}(),Vh=function(t){function e(e,r){t.call(this,e),this._skipCount=r,this._count=0,this._ring=new Array(r)}return Ah(e,t),e.prototype._next=function(t){var e=this._skipCount,r=this._count++;if(r<e)this._ring[r]=t;else{var i=r%e,n=this._ring,o=n[i];n[i]=t,this.destination.next(o)}},e}(dt.Subscriber),Dh={skipLast:Nh},zh={skipLast:function(t){return Dh.skipLast(t)(this)}};_t.Observable.prototype.skipLast=zh.skipLast;var Rh=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Wh=function(t){return function(e){return e.lift(new Mh(t))}},Mh=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){return e.subscribe(new Lh(t,this.notifier))},t}(),Lh=function(t){function e(e,r){t.call(this,e),this.hasValue=!1,this.isInnerStopped=!1,this.add(Qt.subscribeToResult(this,r))}return Rh(e,t),e.prototype._next=function(e){this.hasValue&&t.prototype._next.call(this,e)},e.prototype._complete=function(){this.isInnerStopped?t.prototype._complete.call(this):this.unsubscribe()},e.prototype.notifyNext=function(t,e,r,i,n){this.hasValue=!0},e.prototype.notifyComplete=function(){this.isInnerStopped=!0,this.isStopped&&t.prototype._complete.call(this)},e}(Kt.OuterSubscriber),Uh={skipUntil:Wh},qh={skipUntil:function(t){return Uh.skipUntil(t)(this)}};_t.Observable.prototype.skipUntil=qh.skipUntil;var Bh=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Kh=function(t){return function(e){return e.lift(new Hh(t))}},Hh=function(){function t(t){this.predicate=t}return t.prototype.call=function(t,e){return e.subscribe(new Yh(t,this.predicate))},t}(),Yh=function(t){function e(e,r){t.call(this,e),this.predicate=r,this.skipping=!0,this.index=0}return Bh(e,t),e.prototype._next=function(t){var e=this.destination;this.skipping&&this.tryCallPredicate(t),this.skipping||e.next(t)},e.prototype.tryCallPredicate=function(t){try{var e=this.predicate(t,this.index++);this.skipping=Boolean(e)}catch(t){this.destination.error(t)}},e}(dt.Subscriber),Gh={skipWhile:Kh},Jh={skipWhile:function(t){return Gh.skipWhile(t)(this)}};_t.Observable.prototype.skipWhile=Jh.skipWhile;var Xh={startWith:function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return function(e){var r=t[t.length-1];zt.isScheduler(r)?t.pop():r=null;var i=t.length;return 1===i?Re.concat(new Wt.ScalarObservable(t[0],r),e):i>1?Re.concat(new qt.ArrayObservable(t,r),e):Re.concat(new Lt.EmptyObservable(r),e)}}},Qh={startWith:function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return Xh.startWith.apply(void 0,t)(this)}};_t.Observable.prototype.startWith=Qh.startWith;var $h=function(){function t(t){if(this.root=t,t.setImmediate&&"function"==typeof t.setImmediate)this.setImmediate=t.setImmediate.bind(t),this.clearImmediate=t.clearImmediate.bind(t);else{this.nextHandle=1,this.tasksByHandle={},this.currentlyRunningATask=!1,this.canUseProcessNextTick()?this.setImmediate=this.createProcessNextTickSetImmediate():this.canUsePostMessage()?this.setImmediate=this.createPostMessageSetImmediate():this.canUseMessageChannel()?this.setImmediate=this.createMessageChannelSetImmediate():this.canUseReadyStateChange()?this.setImmediate=this.createReadyStateChangeSetImmediate():this.setImmediate=this.createSetTimeoutSetImmediate();var e=function t(e){delete t.instance.tasksByHandle[e]};e.instance=this,this.clearImmediate=e}}return t.prototype.identify=function(t){return this.root.Object.prototype.toString.call(t)},t.prototype.canUseProcessNextTick=function(){return"[object process]"===this.identify(this.root.process)},t.prototype.canUseMessageChannel=function(){return Boolean(this.root.MessageChannel)},t.prototype.canUseReadyStateChange=function(){var t=this.root.document;return Boolean(t&&"onreadystatechange"in t.createElement("script"))},t.prototype.canUsePostMessage=function(){var t=this.root;if(t.postMessage&&!t.importScripts){var e=!0,r=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=r,e}return!1},t.prototype.partiallyApplied=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var i=function t(){var e=t.handler,r=t.args;"function"==typeof e?e.apply(void 0,r):new Function(""+e)()};return i.handler=t,i.args=e,i},t.prototype.addFromSetImmediateArguments=function(t){return this.tasksByHandle[this.nextHandle]=this.partiallyApplied.apply(void 0,t),this.nextHandle++},t.prototype.createProcessNextTickSetImmediate=function(){var t=function t(){var e=t.instance,r=e.addFromSetImmediateArguments(arguments);return e.root.process.nextTick(e.partiallyApplied(e.runIfPresent,r)),r};return t.instance=this,t},t.prototype.createPostMessageSetImmediate=function(){var t=this.root,e="setImmediate$"+t.Math.random()+"$",r=function r(i){var n=r.instance;i.source===t&&"string"==typeof i.data&&0===i.data.indexOf(e)&&n.runIfPresent(+i.data.slice(e.length))};r.instance=this,t.addEventListener("message",r,!1);var i=function t(){var e=t.messagePrefix,r=t.instance,i=r.addFromSetImmediateArguments(arguments);return r.root.postMessage(e+i,"*"),i};return i.instance=this,i.messagePrefix=e,i},t.prototype.runIfPresent=function(t){if(this.currentlyRunningATask)this.root.setTimeout(this.partiallyApplied(this.runIfPresent,t),0);else{var e=this.tasksByHandle[t];if(e){this.currentlyRunningATask=!0;try{e()}finally{this.clearImmediate(t),this.currentlyRunningATask=!1}}}},t.prototype.createMessageChannelSetImmediate=function(){var t=this,e=new this.root.MessageChannel;e.port1.onmessage=function(e){var r=e.data;t.runIfPresent(r)};var r=function t(){var e=t.channel,r=t.instance.addFromSetImmediateArguments(arguments);return e.port2.postMessage(r),r};return r.channel=e,r.instance=this,r},t.prototype.createReadyStateChangeSetImmediate=function(){var t=function t(){var e=t.instance,r=e.root.document,i=r.documentElement,n=e.addFromSetImmediateArguments(arguments),o=r.createElement("script");return o.onreadystatechange=function(){e.runIfPresent(n),o.onreadystatechange=null,i.removeChild(o),o=null},i.appendChild(o),n};return t.instance=this,t},t.prototype.createSetTimeoutSetImmediate=function(){var t=function t(){var e=t.instance,r=e.addFromSetImmediateArguments(arguments);return e.root.setTimeout(e.partiallyApplied(e.runIfPresent,r),0),r};return t.instance=this,t},t}(),Zh={ImmediateDefinition:$h,Immediate:new $h(Z.root)},tl=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},el={AsapAction:function(t){function e(e,r){t.call(this,e,r),this.scheduler=e,this.work=r}return tl(e,t),e.prototype.requestAsyncId=function(e,r,i){return void 0===i&&(i=0),null!==i&&i>0?t.prototype.requestAsyncId.call(this,e,r,i):(e.actions.push(this),e.scheduled||(e.scheduled=Zh.Immediate.setImmediate(e.flush.bind(e,null))))},e.prototype.recycleAsyncId=function(e,r,i){if(void 0===i&&(i=0),null!==i&&i>0||null===i&&this.delay>0)return t.prototype.recycleAsyncId.call(this,e,r,i);0===e.actions.length&&(Zh.Immediate.clearImmediate(r),e.scheduled=void 0)},e}(lr.AsyncAction)},rl=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},il={asap:new({AsapScheduler:function(t){function e(){t.apply(this,arguments)}return rl(e,t),e.prototype.flush=function(t){this.active=!0,this.scheduled=void 0;var e,r=this.actions,i=-1,n=r.length;t=t||r.shift();do{if(e=t.execute(t.state,t.delay))break}while(++i<n&&(t=r.shift()));if(this.active=!1,e){for(;++i<n&&(t=r.shift());)t.unsubscribe();throw e}},e}(dr.AsyncScheduler)}.AsapScheduler)(el.AsapAction)},nl=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},ol={SubscribeOnObservable:function(t){function e(e,r,i){void 0===r&&(r=0),void 0===i&&(i=il.asap),t.call(this),this.source=e,this.delayTime=r,this.scheduler=i,(!cr.isNumeric(r)||r<0)&&(this.delayTime=0),i&&"function"==typeof i.schedule||(this.scheduler=il.asap)}return nl(e,t),e.create=function(t,r,i){return void 0===r&&(r=0),void 0===i&&(i=il.asap),new e(t,r,i)},e.dispatch=function(t){var e=t.source,r=t.subscriber;return this.add(e.subscribe(r))},e.prototype._subscribe=function(t){var r=this.delayTime,i=this.source;return this.scheduler.schedule(e.dispatch,r,{source:i,subscriber:t})},e}(_t.Observable)},sl=function(t,e){return void 0===e&&(e=0),function(r){return r.lift(new cl(t,e))}},cl=function(){function t(t,e){this.scheduler=t,this.delay=e}return t.prototype.call=function(t,e){return new ol.SubscribeOnObservable(e,this.delay,this.scheduler).subscribe(t)},t}(),ul={subscribeOn:sl},al={subscribeOn:function(t,e){return void 0===e&&(e=0),ul.subscribeOn(t,e)(this)}};_t.Observable.prototype.subscribeOn=al.subscribeOn;var hl=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},ll=function(t,e){return function(r){return r.lift(new pl(t,e))}},pl=function(){function t(t,e){this.project=t,this.resultSelector=e}return t.prototype.call=function(t,e){return e.subscribe(new fl(t,this.project,this.resultSelector))},t}(),fl=function(t){function e(e,r,i){t.call(this,e),this.project=r,this.resultSelector=i,this.index=0}return hl(e,t),e.prototype._next=function(t){var e,r=this.index++;try{e=this.project(t,r)}catch(t){return void this.destination.error(t)}this._innerSub(e,t,r)},e.prototype._innerSub=function(t,e,r){var i=this.innerSubscription;i&&i.unsubscribe(),this.add(this.innerSubscription=Qt.subscribeToResult(this,t,e,r))},e.prototype._complete=function(){var e=this.innerSubscription;e&&!e.closed||t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){this.innerSubscription=null},e.prototype.notifyComplete=function(e){this.remove(e),this.innerSubscription=null,this.isStopped&&t.prototype._complete.call(this)},e.prototype.notifyNext=function(t,e,r,i,n){this.resultSelector?this._tryNotifyNext(t,e,r,i):this.destination.next(e)},e.prototype._tryNotifyNext=function(t,e,r,i){var n;try{n=this.resultSelector(t,e,r,i)}catch(t){return void this.destination.error(t)}this.destination.next(n)},e}(Kt.OuterSubscriber),dl={switchMap:ll},bl={switchAll:function(){return dl.switchMap(Ve.identity)}},yl={_switch:function(){return bl.switchAll()(this)}};_t.Observable.prototype.switch=yl._switch,_t.Observable.prototype._switch=yl._switch;var ml={switchMap:function(t,e){return dl.switchMap(t,e)(this)}};_t.Observable.prototype.switchMap=ml.switchMap;var vl=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},_l=function(t,e){return function(r){return r.lift(new gl(t,e))}},gl=function(){function t(t,e){this.observable=t,this.resultSelector=e}return t.prototype.call=function(t,e){return e.subscribe(new wl(t,this.observable,this.resultSelector))},t}(),wl=function(t){function e(e,r,i){t.call(this,e),this.inner=r,this.resultSelector=i,this.index=0}return vl(e,t),e.prototype._next=function(t){var e=this.innerSubscription;e&&e.unsubscribe(),this.add(this.innerSubscription=Qt.subscribeToResult(this,this.inner,t,this.index++))},e.prototype._complete=function(){var e=this.innerSubscription;e&&!e.closed||t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){this.innerSubscription=null},e.prototype.notifyComplete=function(e){this.remove(e),this.innerSubscription=null,this.isStopped&&t.prototype._complete.call(this)},e.prototype.notifyNext=function(t,e,r,i,n){var o=this.resultSelector,s=this.destination;o?this.tryResultSelector(t,e,r,i):s.next(e)},e.prototype.tryResultSelector=function(t,e,r,i){var n,o=this.resultSelector,s=this.destination;try{n=o(t,e,r,i)}catch(t){return void s.error(t)}s.next(n)},e}(Kt.OuterSubscriber),Sl={switchMapTo:_l},Ol={switchMapTo:function(t,e){return Sl.switchMapTo(t,e)(this)}};_t.Observable.prototype.switchMapTo=Ol.switchMapTo;var xl=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Cl=function(t){return function(e){return 0===t?new Lt.EmptyObservable:e.lift(new kl(t))}},kl=function(){function t(t){if(this.total=t,this.total<0)throw new ys.ArgumentOutOfRangeError}return t.prototype.call=function(t,e){return e.subscribe(new jl(t,this.total))},t}(),jl=function(t){function e(e,r){t.call(this,e),this.total=r,this.count=0}return xl(e,t),e.prototype._next=function(t){var e=this.total,r=++this.count;r<=e&&(this.destination.next(t),r===e&&(this.destination.complete(),this.unsubscribe()))},e}(dt.Subscriber),Il={take:Cl},Tl={take:function(t){return Il.take(t)(this)}};_t.Observable.prototype.take=Tl.take;var El={takeLast:function(t){return pu.takeLast(t)(this)}};_t.Observable.prototype.takeLast=El.takeLast;var Pl=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Al=function(t){return function(e){return e.lift(new Nl(t))}},Nl=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){return e.subscribe(new Fl(t,this.notifier))},t}(),Fl=function(t){function e(e,r){t.call(this,e),this.notifier=r,this.add(Qt.subscribeToResult(this,r))}return Pl(e,t),e.prototype.notifyNext=function(t,e,r,i,n){this.complete()},e.prototype.notifyComplete=function(){},e}(Kt.OuterSubscriber),Vl={takeUntil:Al},Dl={takeUntil:function(t){return Vl.takeUntil(t)(this)}};_t.Observable.prototype.takeUntil=Dl.takeUntil;var zl=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Rl=function(t){return function(e){return e.lift(new Wl(t))}},Wl=function(){function t(t){this.predicate=t}return t.prototype.call=function(t,e){return e.subscribe(new Ml(t,this.predicate))},t}(),Ml=function(t){function e(e,r){t.call(this,e),this.predicate=r,this.index=0}return zl(e,t),e.prototype._next=function(t){var e,r=this.destination;try{e=this.predicate(t,this.index++)}catch(t){return void r.error(t)}this.nextOrComplete(t,e)},e.prototype.nextOrComplete=function(t,e){var r=this.destination;Boolean(e)?r.next(t):r.complete()},e}(dt.Subscriber),Ll={takeWhile:Rl},Ul={takeWhile:function(t){return Ll.takeWhile(t)(this)}};_t.Observable.prototype.takeWhile=Ul.takeWhile;var ql=l(function(t,e){var r=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)};e.defaultThrottleConfig={leading:!0,trailing:!1},e.throttle=function(t,r){return void 0===r&&(r=e.defaultThrottleConfig),function(e){return e.lift(new i(t,r.leading,r.trailing))}};var i=function(){function t(t,e,r){this.durationSelector=t,this.leading=e,this.trailing=r}return t.prototype.call=function(t,e){return e.subscribe(new n(t,this.durationSelector,this.leading,this.trailing))},t}(),n=function(t){function e(e,r,i,n){t.call(this,e),this.destination=e,this.durationSelector=r,this._leading=i,this._trailing=n,this._hasTrailingValue=!1}return r(e,t),e.prototype._next=function(t){if(this.throttled)this._trailing&&(this._hasTrailingValue=!0,this._trailingValue=t);else{var e=this.tryDurationSelector(t);e&&this.add(this.throttled=Qt.subscribeToResult(this,e)),this._leading&&(this.destination.next(t),this._trailing&&(this._hasTrailingValue=!0,this._trailingValue=t))}},e.prototype.tryDurationSelector=function(t){try{return this.durationSelector(t)}catch(t){return this.destination.error(t),null}},e.prototype._unsubscribe=function(){var t=this.throttled;this._trailingValue=null,this._hasTrailingValue=!1,t&&(this.remove(t),this.throttled=null,t.unsubscribe())},e.prototype._sendTrailing=function(){var t=this.destination,e=this.throttled,r=this._trailing,i=this._trailingValue,n=this._hasTrailingValue;e&&r&&n&&(t.next(i),this._trailingValue=null,this._hasTrailingValue=!1)},e.prototype.notifyNext=function(t,e,r,i,n){this._sendTrailing(),this._unsubscribe()},e.prototype.notifyComplete=function(){this._sendTrailing(),this._unsubscribe()},e}(Kt.OuterSubscriber)}),Bl={throttle:function(t,e){return void 0===e&&(e=ql.defaultThrottleConfig),ql.throttle(t,e)(this)}};_t.Observable.prototype.throttle=Bl.throttle;var Kl=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Hl=function(t,e,r){return void 0===e&&(e=br.async),void 0===r&&(r=ql.defaultThrottleConfig),function(i){return i.lift(new Yl(t,e,r.leading,r.trailing))}},Yl=function(){function t(t,e,r,i){this.duration=t,this.scheduler=e,this.leading=r,this.trailing=i}return t.prototype.call=function(t,e){return e.subscribe(new Gl(t,this.duration,this.scheduler,this.leading,this.trailing))},t}(),Gl=function(t){function e(e,r,i,n,o){t.call(this,e),this.duration=r,this.scheduler=i,this.leading=n,this.trailing=o,this._hasTrailingValue=!1,this._trailingValue=null}return Kl(e,t),e.prototype._next=function(t){this.throttled?this.trailing&&(this._trailingValue=t,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(U,this.duration,{subscriber:this})),this.leading&&this.destination.next(t))},e.prototype.clearThrottle=function(){var t=this.throttled;t&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),t.unsubscribe(),this.remove(t),this.throttled=null)},e}(dt.Subscriber),Jl={throttleTime:Hl},Xl={throttleTime:function(t,e,r){return void 0===e&&(e=br.async),void 0===r&&(r=ql.defaultThrottleConfig),Jl.throttleTime(t,e,r)(this)}};_t.Observable.prototype.throttleTime=Xl.throttleTime;var Ql=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},$l=function(t){return void 0===t&&(t=br.async),function(e){return e.lift(new ep(t))}},Zl=function(){return function(t,e){this.value=t,this.interval=e}}(),tp=Zl,ep=function(){function t(t){this.scheduler=t}return t.prototype.call=function(t,e){return e.subscribe(new rp(t,this.scheduler))},t}(),rp=function(t){function e(e,r){t.call(this,e),this.scheduler=r,this.lastTime=0,this.lastTime=r.now()}return Ql(e,t),e.prototype._next=function(t){var e=this.scheduler.now(),r=e-this.lastTime;this.lastTime=e,this.destination.next(new Zl(t,r))},e}(dt.Subscriber),ip={timeInterval:$l,TimeInterval:tp},np={TimeInterval:ip.TimeInterval,timeInterval:function(t){return void 0===t&&(t=br.async),ip.timeInterval(t)(this)}};_t.Observable.prototype.timeInterval=np.timeInterval;var op=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},sp={TimeoutError:function(t){function e(){var e=t.call(this,"Timeout has occurred");this.name=e.name="TimeoutError",this.stack=e.stack,this.message=e.message}return op(e,t),e}(Error)},cp=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},up=function(t,e){void 0===e&&(e=br.async);var r=Hr.isDate(t),i=r?+t-e.now():Math.abs(t);return function(t){return t.lift(new ap(i,r,e,new sp.TimeoutError))}},ap=function(){function t(t,e,r,i){this.waitFor=t,this.absoluteTimeout=e,this.scheduler=r,this.errorInstance=i}return t.prototype.call=function(t,e){return e.subscribe(new hp(t,this.absoluteTimeout,this.waitFor,this.scheduler,this.errorInstance))},t}(),hp=function(t){function e(e,r,i,n,o){t.call(this,e),this.absoluteTimeout=r,this.waitFor=i,this.scheduler=n,this.errorInstance=o,this.action=null,this.scheduleTimeout()}return cp(e,t),e.dispatchTimeout=function(t){t.error(t.errorInstance)},e.prototype.scheduleTimeout=function(){var t=this.action;t?this.action=t.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(e.dispatchTimeout,this.waitFor,this))},e.prototype._next=function(e){this.absoluteTimeout||this.scheduleTimeout(),t.prototype._next.call(this,e)},e.prototype._unsubscribe=function(){this.action=null,this.scheduler=null,this.errorInstance=null},e}(dt.Subscriber),lp={timeout:up},pp={timeout:function(t,e){return void 0===e&&(e=br.async),lp.timeout(t,e)(this)}};_t.Observable.prototype.timeout=pp.timeout;var fp=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},dp=function(t,e,r){return void 0===r&&(r=br.async),function(i){var n=Hr.isDate(t),o=n?+t-r.now():Math.abs(t);return i.lift(new bp(o,n,e,r))}},bp=function(){function t(t,e,r,i){this.waitFor=t,this.absoluteTimeout=e,this.withObservable=r,this.scheduler=i}return t.prototype.call=function(t,e){return e.subscribe(new yp(t,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},t}(),yp=function(t){function e(e,r,i,n,o){t.call(this,e),this.absoluteTimeout=r,this.waitFor=i,this.withObservable=n,this.scheduler=o,this.action=null,this.scheduleTimeout()}return fp(e,t),e.dispatchTimeout=function(t){var e=t.withObservable;t._unsubscribeAndRecycle(),t.add(Qt.subscribeToResult(t,e))},e.prototype.scheduleTimeout=function(){var t=this.action;t?this.action=t.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(e.dispatchTimeout,this.waitFor,this))},e.prototype._next=function(e){this.absoluteTimeout||this.scheduleTimeout(),t.prototype._next.call(this,e)},e.prototype._unsubscribe=function(){this.action=null,this.scheduler=null,this.withObservable=null},e}(Kt.OuterSubscriber),mp={timeoutWith:dp},vp={timeoutWith:function(t,e,r){return void 0===r&&(r=br.async),mp.timeoutWith(t,e,r)(this)}};_t.Observable.prototype.timeoutWith=vp.timeoutWith;var _p=function(t){return void 0===t&&(t=br.async),pi.map(function(e){return new gp(e,t.now())})},gp=function(){return function(t,e){this.value=t,this.timestamp=e}}(),wp={timestamp:_p,Timestamp:gp},Sp={timestamp:function(t){return void 0===t&&(t=br.async),wp.timestamp(t)(this)}};_t.Observable.prototype.timestamp=Sp.timestamp;var Op={toArray:function(){return fu.reduce(q,[])}},xp={toArray:function(){return Op.toArray()(this)}};_t.Observable.prototype.toArray=xp.toArray;var Cp=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},kp=function(t){return function(e){return e.lift(new jp(t))}},jp=function(){function t(t){this.windowBoundaries=t}return t.prototype.call=function(t,e){var r=new Ip(t),i=e.subscribe(r);return i.closed||r.add(Qt.subscribeToResult(r,this.windowBoundaries)),i},t}(),Ip=function(t){function e(e){t.call(this,e),this.window=new Et.Subject,e.next(this.window)}return Cp(e,t),e.prototype.notifyNext=function(t,e,r,i,n){this.openWindow()},e.prototype.notifyError=function(t,e){this._error(t)},e.prototype.notifyComplete=function(t){this._complete()},e.prototype._next=function(t){this.window.next(t)},e.prototype._error=function(t){this.window.error(t),this.destination.error(t)},e.prototype._complete=function(){this.window.complete(),this.destination.complete()},e.prototype._unsubscribe=function(){this.window=null},e.prototype.openWindow=function(){var t=this.window;t&&t.complete();var e=this.destination,r=this.window=new Et.Subject;e.next(r)},e}(Kt.OuterSubscriber),Tp={window:kp},Ep={window:function(t){return Tp.window(t)(this)}};_t.Observable.prototype.window=Ep.window;var Pp=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Ap=function(t,e){return void 0===e&&(e=0),function(r){return r.lift(new Np(t,e))}},Np=function(){function t(t,e){this.windowSize=t,this.startWindowEvery=e}return t.prototype.call=function(t,e){return e.subscribe(new Fp(t,this.windowSize,this.startWindowEvery))},t}(),Fp=function(t){function e(e,r,i){t.call(this,e),this.destination=e,this.windowSize=r,this.startWindowEvery=i,this.windows=[new Et.Subject],this.count=0,e.next(this.windows[0])}return Pp(e,t),e.prototype._next=function(t){for(var e=this.startWindowEvery>0?this.startWindowEvery:this.windowSize,r=this.destination,i=this.windowSize,n=this.windows,o=n.length,s=0;s<o&&!this.closed;s++)n[s].next(t);var c=this.count-i+1;if(c>=0&&c%e==0&&!this.closed&&n.shift().complete(),++this.count%e==0&&!this.closed){var u=new Et.Subject;n.push(u),r.next(u)}},e.prototype._error=function(t){var e=this.windows;if(e)for(;e.length>0&&!this.closed;)e.shift().error(t);this.destination.error(t)},e.prototype._complete=function(){var t=this.windows;if(t)for(;t.length>0&&!this.closed;)t.shift().complete();this.destination.complete()},e.prototype._unsubscribe=function(){this.count=0,this.windows=null},e}(dt.Subscriber),Vp={windowCount:Ap},Dp={windowCount:function(t,e){return void 0===e&&(e=0),Vp.windowCount(t,e)(this)}};_t.Observable.prototype.windowCount=Dp.windowCount;var zp=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Rp=function(t){var e=br.async,r=null,i=Number.POSITIVE_INFINITY;return zt.isScheduler(arguments[3])&&(e=arguments[3]),zt.isScheduler(arguments[2])?e=arguments[2]:cr.isNumeric(arguments[2])&&(i=arguments[2]),zt.isScheduler(arguments[1])?e=arguments[1]:cr.isNumeric(arguments[1])&&(r=arguments[1]),function(n){return n.lift(new Wp(t,r,i,e))}},Wp=function(){function t(t,e,r,i){this.windowTimeSpan=t,this.windowCreationInterval=e,this.maxWindowSize=r,this.scheduler=i}return t.prototype.call=function(t,e){return e.subscribe(new Lp(t,this.windowTimeSpan,this.windowCreationInterval,this.maxWindowSize,this.scheduler))},t}(),Mp=function(t){function e(){t.apply(this,arguments),this._numberOfNextedValues=0}return zp(e,t),e.prototype.next=function(e){this._numberOfNextedValues++,t.prototype.next.call(this,e)},Object.defineProperty(e.prototype,"numberOfNextedValues",{get:function(){return this._numberOfNextedValues},enumerable:!0,configurable:!0}),e}(Et.Subject),Lp=function(t){function e(e,r,i,n,o){t.call(this,e),this.destination=e,this.windowTimeSpan=r,this.windowCreationInterval=i,this.maxWindowSize=n,this.scheduler=o,this.windows=[];var s=this.openWindow();if(null!==i&&i>=0){var c={subscriber:this,window:s,context:null},u={windowTimeSpan:r,windowCreationInterval:i,subscriber:this,scheduler:o};this.add(o.schedule(H,r,c)),this.add(o.schedule(K,i,u))}else{var a={subscriber:this,window:s,windowTimeSpan:r};this.add(o.schedule(B,r,a))}}return zp(e,t),e.prototype._next=function(t){for(var e=this.windows,r=e.length,i=0;i<r;i++){var n=e[i];n.closed||(n.next(t),n.numberOfNextedValues>=this.maxWindowSize&&this.closeWindow(n))}},e.prototype._error=function(t){for(var e=this.windows;e.length>0;)e.shift().error(t);this.destination.error(t)},e.prototype._complete=function(){for(var t=this.windows;t.length>0;){var e=t.shift();e.closed||e.complete()}this.destination.complete()},e.prototype.openWindow=function(){var t=new Mp;this.windows.push(t);return this.destination.next(t),t},e.prototype.closeWindow=function(t){t.complete();var e=this.windows;e.splice(e.indexOf(t),1)},e}(dt.Subscriber),Up={windowTime:Rp},qp={windowTime:function(t){var e=br.async,r=null,i=Number.POSITIVE_INFINITY;return zt.isScheduler(arguments[3])&&(e=arguments[3]),zt.isScheduler(arguments[2])?e=arguments[2]:cr.isNumeric(arguments[2])&&(i=arguments[2]),zt.isScheduler(arguments[1])?e=arguments[1]:cr.isNumeric(arguments[1])&&(r=arguments[1]),Up.windowTime(t,r,i,e)(this)}};_t.Observable.prototype.windowTime=qp.windowTime;var Bp=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Kp=function(t,e){return function(r){return r.lift(new Hp(t,e))}},Hp=function(){function t(t,e){this.openings=t,this.closingSelector=e}return t.prototype.call=function(t,e){return e.subscribe(new Yp(t,this.openings,this.closingSelector))},t}(),Yp=function(t){function e(e,r,i){t.call(this,e),this.openings=r,this.closingSelector=i,this.contexts=[],this.add(this.openSubscription=Qt.subscribeToResult(this,r,r))}return Bp(e,t),e.prototype._next=function(t){var e=this.contexts;if(e)for(var r=e.length,i=0;i<r;i++)e[i].window.next(t)},e.prototype._error=function(e){var r=this.contexts;if(this.contexts=null,r)for(var i=r.length,n=-1;++n<i;){var o=r[n];o.window.error(e),o.subscription.unsubscribe()}t.prototype._error.call(this,e)},e.prototype._complete=function(){var e=this.contexts;if(this.contexts=null,e)for(var r=e.length,i=-1;++i<r;){var n=e[i];n.window.complete(),n.subscription.unsubscribe()}t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){var t=this.contexts;if(this.contexts=null,t)for(var e=t.length,r=-1;++r<e;){var i=t[r];i.window.unsubscribe(),i.subscription.unsubscribe()}},e.prototype.notifyNext=function(t,e,r,i,n){if(t===this.openings){var o=this.closingSelector,s=nt.tryCatch(o)(e);if(s===it.errorObject)return this.error(it.errorObject.e);var c=new Et.Subject,u=new ct.Subscription,a={window:c,subscription:u};this.contexts.push(a);var h=Qt.subscribeToResult(this,s,a);h.closed?this.closeWindow(this.contexts.length-1):(h.context=a,u.add(h)),this.destination.next(c)}else this.closeWindow(this.contexts.indexOf(t))},e.prototype.notifyError=function(t){this.error(t)},e.prototype.notifyComplete=function(t){t!==this.openSubscription&&this.closeWindow(this.contexts.indexOf(t.context))},e.prototype.closeWindow=function(t){if(-1!==t){var e=this.contexts,r=e[t],i=r.window,n=r.subscription;e.splice(t,1),i.complete(),n.unsubscribe()}},e}(Kt.OuterSubscriber),Gp={windowToggle:Kp},Jp={windowToggle:function(t,e){return Gp.windowToggle(t,e)(this)}};_t.Observable.prototype.windowToggle=Jp.windowToggle;var Xp=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Qp=function(t){return function(e){return e.lift(new $p(t))}},$p=function(){function t(t){this.closingSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new Zp(t,this.closingSelector))},t}(),Zp=function(t){function e(e,r){t.call(this,e),this.destination=e,this.closingSelector=r,this.openWindow()}return Xp(e,t),e.prototype.notifyNext=function(t,e,r,i,n){this.openWindow(n)},e.prototype.notifyError=function(t,e){this._error(t)},e.prototype.notifyComplete=function(t){this.openWindow(t)},e.prototype._next=function(t){this.window.next(t)},e.prototype._error=function(t){this.window.error(t),this.destination.error(t),this.unsubscribeClosingNotification()},e.prototype._complete=function(){this.window.complete(),this.destination.complete(),this.unsubscribeClosingNotification()},e.prototype.unsubscribeClosingNotification=function(){this.closingNotification&&this.closingNotification.unsubscribe()},e.prototype.openWindow=function(t){void 0===t&&(t=null),t&&(this.remove(t),t.unsubscribe());var e=this.window;e&&e.complete();var r=this.window=new Et.Subject;this.destination.next(r);var i=nt.tryCatch(this.closingSelector)();if(i===it.errorObject){var n=it.errorObject.e;this.destination.error(n),this.window.error(n)}else this.add(this.closingNotification=Qt.subscribeToResult(this,i))},e}(Kt.OuterSubscriber),tf={windowWhen:Qp},ef={windowWhen:function(t){return tf.windowWhen(t)(this)}};_t.Observable.prototype.windowWhen=ef.windowWhen;var rf=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},nf=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return function(e){var r;"function"==typeof t[t.length-1]&&(r=t.pop());var i=t;return e.lift(new of(i,r))}},of=function(){function t(t,e){this.observables=t,this.project=e}return t.prototype.call=function(t,e){return e.subscribe(new sf(t,this.observables,this.project))},t}(),sf=function(t){function e(e,r,i){t.call(this,e),this.observables=r,this.project=i,this.toRespond=[];var n=r.length;this.values=new Array(n);for(var o=0;o<n;o++)this.toRespond.push(o);for(o=0;o<n;o++){var s=r[o];this.add(Qt.subscribeToResult(this,s,s,o))}}return rf(e,t),e.prototype.notifyNext=function(t,e,r,i,n){this.values[r]=e;var o=this.toRespond;if(o.length>0){var s=o.indexOf(r);-1!==s&&o.splice(s,1)}},e.prototype.notifyComplete=function(){},e.prototype._next=function(t){if(0===this.toRespond.length){var e=[t].concat(this.values);this.project?this._tryProject(e):this.destination.next(e)}},e.prototype._tryProject=function(t){var e;try{e=this.project.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(Kt.OuterSubscriber),cf={withLatestFrom:nf},uf={withLatestFrom:function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return cf.withLatestFrom.apply(void 0,t)(this)}};_t.Observable.prototype.withLatestFrom=uf.withLatestFrom;var af={zipProto:function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return oi.zip.apply(void 0,t)(this)}};_t.Observable.prototype.zip=af.zipProto;var hf={zipAll:function(t){return function(e){return e.lift(new oi.ZipOperator(t))}}},lf={zipAll:function(t){return hf.zipAll(t)(this)}};_t.Observable.prototype.zipAll=lf.zipAll;var pf={SubscriptionLog:function(){return function(t,e){void 0===e&&(e=Number.POSITIVE_INFINITY),this.subscribedFrame=t,this.unsubscribedFrame=e}}()},ff={SubscriptionLoggable:function(){function t(){this.subscriptions=[]}return t.prototype.logSubscribedFrame=function(){return this.subscriptions.push(new pf.SubscriptionLog(this.scheduler.now())),this.subscriptions.length-1},t.prototype.logUnsubscribedFrame=function(t){var e=this.subscriptions,r=e[t];e[t]=new pf.SubscriptionLog(r.subscribedFrame,this.scheduler.now())},t}()},df={applyMixins:function(t,e){for(var r=0,i=e.length;r<i;r++)for(var n=e[r],o=Object.getOwnPropertyNames(n.prototype),s=0,c=o.length;s<c;s++){var u=o[s];t.prototype[u]=n.prototype[u]}}},bf=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},yf=function(t){function e(e,r){t.call(this,function(t){var e=this,r=e.logSubscribedFrame();return t.add(new ct.Subscription(function(){e.logUnsubscribedFrame(r)})),e.scheduleMessages(t),t}),this.messages=e,this.subscriptions=[],this.scheduler=r}return bf(e,t),e.prototype.scheduleMessages=function(t){for(var e=this.messages.length,r=0;r<e;r++){var i=this.messages[r];t.add(this.scheduler.schedule(function(t){var e=t.message,r=t.subscriber;e.notification.observe(r)},i.frame,{message:i,subscriber:t}))}},e}(_t.Observable),mf=yf;df.applyMixins(yf,[ff.SubscriptionLoggable]);var vf={ColdObservable:mf},_f=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},gf=function(t){function e(e,r){t.call(this),this.messages=e,this.subscriptions=[],this.scheduler=r}return _f(e,t),e.prototype._subscribe=function(e){var r=this,i=r.logSubscribedFrame();return e.add(new ct.Subscription(function(){r.logUnsubscribedFrame(i)})),t.prototype._subscribe.call(this,e)},e.prototype.setup=function(){for(var t=this,e=t.messages.length,r=0;r<e;r++)!function(){var e=t.messages[r];t.scheduler.schedule(function(){e.notification.observe(t)},e.frame)}()},e}(Et.Subject),wf=gf;df.applyMixins(gf,[ff.SubscriptionLoggable]);var Sf={HotObservable:wf},Of=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},xf=function(t){function e(e,r){var i=this;void 0===e&&(e=Cf),void 0===r&&(r=Number.POSITIVE_INFINITY),t.call(this,e,function(){return i.frame}),this.maxFrames=r,this.frame=0,this.index=-1}return Of(e,t),e.prototype.flush=function(){for(var t,e,r=this.actions,i=this.maxFrames;(e=r.shift())&&(this.frame=e.delay)<=i&&!(t=e.execute(e.state,e.delay)););if(t){for(;e=r.shift();)e.unsubscribe();throw t}},e.frameTimeFactor=10,e}(dr.AsyncScheduler),Cf=function(t){function e(e,r,i){void 0===i&&(i=e.index+=1),t.call(this,e,r),this.scheduler=e,this.work=r,this.index=i,this.active=!0,this.index=e.index=i}return Of(e,t),e.prototype.schedule=function(r,i){if(void 0===i&&(i=0),!this.id)return t.prototype.schedule.call(this,r,i);this.active=!1;var n=new e(this.scheduler,this.work);return this.add(n),n.schedule(r,i)},e.prototype.requestAsyncId=function(t,r,i){void 0===i&&(i=0),this.delay=t.frame+i;var n=t.actions;return n.push(this),n.sort(e.sortActions),!0},e.prototype.recycleAsyncId=function(t,e,r){void 0===r&&(r=0)},e.prototype._execute=function(e,r){if(!0===this.active)return t.prototype._execute.call(this,e,r)},e.sortActions=function(t,e){return t.delay===e.delay?t.index===e.index?0:t.index>e.index?1:-1:t.delay>e.delay?1:-1},e}(lr.AsyncAction),kf={VirtualTimeScheduler:xf,VirtualAction:Cf},jf=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},If=750,Tf=(function(t){function e(e){t.call(this,kf.VirtualAction,If),this.assertDeepEqual=e,this.hotObservables=[],this.coldObservables=[],this.flushTests=[]}jf(e,t),e.prototype.createTime=function(t){var r=t.indexOf("|");if(-1===r)throw new Error('marble diagram for time should have a completion marker "|"');return r*e.frameTimeFactor},e.prototype.createColdObservable=function(t,r,i){if(-1!==t.indexOf("^"))throw new Error('cold observable cannot have subscription offset "^"');if(-1!==t.indexOf("!"))throw new Error('cold observable cannot have unsubscription marker "!"');var n=e.parseMarbles(t,r,i),o=new vf.ColdObservable(n,this);return this.coldObservables.push(o),o},e.prototype.createHotObservable=function(t,r,i){if(-1!==t.indexOf("!"))throw new Error('hot observable cannot have unsubscription marker "!"');var n=e.parseMarbles(t,r,i),o=new Sf.HotObservable(n,this);return this.hotObservables.push(o),o},e.prototype.materializeInnerObservable=function(t,e){var r=this,i=[];return t.subscribe(function(t){i.push({frame:r.frame-e,notification:me.Notification.createNext(t)})},function(t){i.push({frame:r.frame-e,notification:me.Notification.createError(t)})},function(){i.push({frame:r.frame-e,notification:me.Notification.createComplete()})}),i},e.prototype.expectObservable=function(t,r){var i=this;void 0===r&&(r=null);var n,o=[],s={actual:o,ready:!1},c=e.parseMarblesAsSubscriptions(r).unsubscribedFrame;return this.schedule(function(){n=t.subscribe(function(t){var e=t;t instanceof _t.Observable&&(e=i.materializeInnerObservable(e,i.frame)),o.push({frame:i.frame,notification:me.Notification.createNext(e)})},function(t){o.push({frame:i.frame,notification:me.Notification.createError(t)})},function(){o.push({frame:i.frame,notification:me.Notification.createComplete()})})},0),c!==Number.POSITIVE_INFINITY&&this.schedule(function(){return n.unsubscribe()},c),this.flushTests.push(s),{toBe:function(t,r,i){s.ready=!0,s.expected=e.parseMarbles(t,r,i,!0)}}},e.prototype.expectSubscriptions=function(t){var r={actual:t,ready:!1};return this.flushTests.push(r),{toBe:function(t){var i="string"==typeof t?[t]:t;r.ready=!0,r.expected=i.map(function(t){return e.parseMarblesAsSubscriptions(t)})}}},e.prototype.flush=function(){for(var e=this.hotObservables;e.length>0;)e.shift().setup();t.prototype.flush.call(this);for(var r=this.flushTests.filter(function(t){return t.ready});r.length>0;){var i=r.shift();this.assertDeepEqual(i.actual,i.expected)}},e.parseMarblesAsSubscriptions=function(t){if("string"!=typeof t)return new pf.SubscriptionLog(Number.POSITIVE_INFINITY);for(var e=t.length,r=-1,i=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,o=0;o<e;o++){var s=o*this.frameTimeFactor,c=t[o];switch(c){case"-":case" ":break;case"(":r=s;break;case")":r=-1;break;case"^":if(i!==Number.POSITIVE_INFINITY)throw new Error("found a second subscription point '^' in a subscription marble diagram. There can only be one.");i=r>-1?r:s;break;case"!":if(n!==Number.POSITIVE_INFINITY)throw new Error("found a second subscription point '^' in a subscription marble diagram. There can only be one.");n=r>-1?r:s;break;default:throw new Error("there can only be '^' and '!' markers in a subscription marble diagram. Found instead '"+c+"'.")}}return n<0?new pf.SubscriptionLog(i):new pf.SubscriptionLog(i,n)},e.parseMarbles=function(t,e,r,i){if(void 0===i&&(i=!1),-1!==t.indexOf("!"))throw new Error('conventional marble diagrams cannot have the unsubscription marker "!"');for(var n=t.length,o=[],s=t.indexOf("^"),c=-1===s?0:s*-this.frameTimeFactor,u="object"!=typeof e?function(t){return t}:function(t){return i&&e[t]instanceof vf.ColdObservable?e[t].messages:e[t]},a=-1,h=0;h<n;h++){var l=h*this.frameTimeFactor+c,p=void 0,f=t[h];switch(f){case"-":case" ":break;case"(":a=l;break;case")":a=-1;break;case"|":p=me.Notification.createComplete();break;case"^":break;case"#":p=me.Notification.createError(r||"error");break;default:p=me.Notification.createNext(u(f))}p&&o.push({frame:a>-1?a:l,notification:p})}return o}}(kf.VirtualTimeScheduler),function(){return function(t){t.requestAnimationFrame?(this.cancelAnimationFrame=t.cancelAnimationFrame.bind(t),this.requestAnimationFrame=t.requestAnimationFrame.bind(t)):t.mozRequestAnimationFrame?(this.cancelAnimationFrame=t.mozCancelAnimationFrame.bind(t),this.requestAnimationFrame=t.mozRequestAnimationFrame.bind(t)):t.webkitRequestAnimationFrame?(this.cancelAnimationFrame=t.webkitCancelAnimationFrame.bind(t),this.requestAnimationFrame=t.webkitRequestAnimationFrame.bind(t)):t.msRequestAnimationFrame?(this.cancelAnimationFrame=t.msCancelAnimationFrame.bind(t),this.requestAnimationFrame=t.msRequestAnimationFrame.bind(t)):t.oRequestAnimationFrame?(this.cancelAnimationFrame=t.oCancelAnimationFrame.bind(t),this.requestAnimationFrame=t.oRequestAnimationFrame.bind(t)):(this.cancelAnimationFrame=t.clearTimeout.bind(t),this.requestAnimationFrame=function(e){return t.setTimeout(e,1e3/60)})}}()),Ef={RequestAnimationFrameDefinition:Tf,AnimationFrame:new Tf(Z.root)},Pf=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Af={AnimationFrameAction:function(t){function e(e,r){t.call(this,e,r),this.scheduler=e,this.work=r}return Pf(e,t),e.prototype.requestAsyncId=function(e,r,i){return void 0===i&&(i=0),null!==i&&i>0?t.prototype.requestAsyncId.call(this,e,r,i):(e.actions.push(this),e.scheduled||(e.scheduled=Ef.AnimationFrame.requestAnimationFrame(e.flush.bind(e,null))))},e.prototype.recycleAsyncId=function(e,r,i){if(void 0===i&&(i=0),null!==i&&i>0||null===i&&this.delay>0)return t.prototype.recycleAsyncId.call(this,e,r,i);0===e.actions.length&&(Ef.AnimationFrame.cancelAnimationFrame(r),e.scheduled=void 0)},e}(lr.AsyncAction)},Nf=Y&&Y.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Ff=(new({AnimationFrameScheduler:function(t){function e(){t.apply(this,arguments)}return Nf(e,t),e.prototype.flush=function(t){this.active=!0,this.scheduled=void 0;var e,r=this.actions,i=-1,n=r.length;t=t||r.shift();do{if(e=t.execute(t.state,t.delay))break}while(++i<n&&(t=r.shift()));if(this.active=!1,e){for(;++i<n&&(t=r.shift());)t.unsubscribe();throw e}},e}(dr.AsyncScheduler)}.AnimationFrameScheduler)(Af.AnimationFrameAction),_t.Observable),Vf=function(){return function(){this.stsServer="https://localhost:44318",this.redirect_url="https://localhost:44311",this.client_id="angularclient",this.response_type="id_token token",this.resource="",this.scope="openid email profile",this.post_logout_redirect_uri="https://localhost:44311/unauthorized",this.start_checksession=!1,this.silent_renew=!0,this.startup_route="/dataeventrecords",this.forbidden_route="/forbidden",this.unauthorized_route="/unauthorized",this.auto_userinfo=!0,this.log_console_warning_active=!0,this.log_console_debug_active=!1,this.max_id_token_iat_offset_allowed_in_seconds=3,this.override_well_known_configuration=!1,this.override_well_known_configuration_url="https://localhost:44386/wellknownconfiguration.json",this.storage="undefined"!=typeof Storage?sessionStorage:null}}(),Df=function(){return function(){}}(),zf=function(){function t(t){this.defaultConfig=t}return Object.defineProperty(t.prototype,"stsServer",{get:function(){return this.openIDImplicitFlowConfiguration.stsServer||this.defaultConfig.stsServer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"redirect_url",{get:function(){return this.openIDImplicitFlowConfiguration.redirect_url||this.defaultConfig.redirect_url},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"client_id",{get:function(){return this.openIDImplicitFlowConfiguration.client_id||this.defaultConfig.client_id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"response_type",{get:function(){return this.openIDImplicitFlowConfiguration.response_type||this.defaultConfig.response_type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resource",{get:function(){return this.openIDImplicitFlowConfiguration.resource||this.defaultConfig.resource},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scope",{get:function(){return this.openIDImplicitFlowConfiguration.scope||this.defaultConfig.scope},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"post_logout_redirect_uri",{get:function(){return this.openIDImplicitFlowConfiguration.post_logout_redirect_uri||this.defaultConfig.post_logout_redirect_uri},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"start_checksession",{get:function(){return void 0!==this.openIDImplicitFlowConfiguration.start_checksession?this.openIDImplicitFlowConfiguration.start_checksession:this.defaultConfig.start_checksession},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"silent_renew",{get:function(){return void 0!==this.openIDImplicitFlowConfiguration.silent_renew?this.openIDImplicitFlowConfiguration.silent_renew:this.defaultConfig.silent_renew},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"startup_route",{get:function(){return this.openIDImplicitFlowConfiguration.startup_route||this.defaultConfig.startup_route},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"forbidden_route",{get:function(){return this.openIDImplicitFlowConfiguration.forbidden_route||this.defaultConfig.forbidden_route},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"unauthorized_route",{get:function(){return this.openIDImplicitFlowConfiguration.unauthorized_route||this.defaultConfig.unauthorized_route},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"auto_userinfo",{get:function(){return void 0!==this.openIDImplicitFlowConfiguration.auto_userinfo?this.openIDImplicitFlowConfiguration.auto_userinfo:this.defaultConfig.auto_userinfo},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"log_console_warning_active",{get:function(){return void 0!==this.openIDImplicitFlowConfiguration.log_console_warning_active?this.openIDImplicitFlowConfiguration.log_console_warning_active:this.defaultConfig.log_console_warning_active},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"log_console_debug_active",{get:function(){return void 0!==this.openIDImplicitFlowConfiguration.log_console_debug_active?this.openIDImplicitFlowConfiguration.log_console_debug_active:this.defaultConfig.log_console_debug_active},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"max_id_token_iat_offset_allowed_in_seconds",{get:function(){return this.openIDImplicitFlowConfiguration.max_id_token_iat_offset_allowed_in_seconds||this.defaultConfig.max_id_token_iat_offset_allowed_in_seconds},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"override_well_known_configuration",{get:function(){return void 0!==this.openIDImplicitFlowConfiguration.override_well_known_configuration?this.openIDImplicitFlowConfiguration.override_well_known_configuration:this.defaultConfig.override_well_known_configuration},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"override_well_known_configuration_url",{get:function(){return this.openIDImplicitFlowConfiguration.override_well_known_configuration_url||this.defaultConfig.override_well_known_configuration_url},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"storage",{get:function(){return this.openIDImplicitFlowConfiguration.storage||this.defaultConfig.storage},enumerable:!0,configurable:!0}),t.prototype.init=function(t){this.openIDImplicitFlowConfiguration=t},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:Vf}]},t}(),Rf=function(){function t(){}return t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[]},t}(),Wf=function(){function t(t){this.authConfiguration=t,this.hasStorage="undefined"!=typeof Storage}return t.prototype.read=function(t){if(this.hasStorage)return JSON.parse(this.authConfiguration.storage.getItem(t))},t.prototype.write=function(t,e){this.hasStorage&&this.authConfiguration.storage.setItem(t,JSON.stringify(e))},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:zf}]},t}(),Mf=function(){function t(t,e){this.authConfiguration=t,this.oidcSecurityStorage=e,this.storage_auth_result="authorizationResult",this.storage_access_token="authorizationData",this.storage_id_token="authorizationDataIdToken",this.storage_is_authorized="_isAuthorized",this.storage_user_data="userData",this.storage_auth_nonce="authNonce",this.storage_auth_state_control="authStateControl",this.storage_well_known_endpoints="wellknownendpoints",this.storage_session_state="session_state",this.storage_silent_renew_running="storage_silent_renew_running",this.storage_custom_request_params="storage_custom_request_params"}return t.prototype.setupModule=function(){},t.prototype.retrieve=function(t){return this.oidcSecurityStorage.read(t)},t.prototype.store=function(t,e){this.oidcSecurityStorage.write(t,e)},t.prototype.resetStorageData=function(t){t||(this.store(this.storage_auth_result,""),this.store(this.storage_session_state,""),this.store(this.storage_silent_renew_running,""),this.store(this.storage_is_authorized,!1),this.store(this.storage_access_token,""),this.store(this.storage_id_token,""),this.store(this.storage_user_data,""))},t.prototype.getAccessToken=function(){return this.retrieve(this.storage_access_token)},t.prototype.getIdToken=function(){return this.retrieve(this.storage_id_token)},t.prototype.logError=function(t){console.error(t)},t.prototype.logWarning=function(t){this.authConfiguration.log_console_warning_active&&console.warn(t)},t.prototype.logDebug=function(t){this.authConfiguration.log_console_debug_active&&console.log(t)},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:zf},{type:Rf}]},t}(),Lf=function(){function t(t){this.oidcSecurityCommon=t}return t.prototype.isTokenExpired=function(t,e){var r;return r=this.getPayloadFromToken(t,!1),!this.validate_id_token_exp_not_expired(r,e)},t.prototype.validate_id_token_exp_not_expired=function(t,e){var r=this.getTokenExpirationDate(t);return e=e||0,null!==r&&r.valueOf()>(new Date).valueOf()+1e3*e},t.prototype.validate_required_id_token=function(t){var e=!0;return t.hasOwnProperty("iss")||(e=!1,this.oidcSecurityCommon.logWarning("iss is missing, this is required in the id_token")),t.hasOwnProperty("sub")||(e=!1,this.oidcSecurityCommon.logWarning("sub is missing, this is required in the id_token")),t.hasOwnProperty("aud")||(e=!1,this.oidcSecurityCommon.logWarning("aud is missing, this is required in the id_token")),t.hasOwnProperty("exp")||(e=!1,this.oidcSecurityCommon.logWarning("exp is missing, this is required in the id_token")),t.hasOwnProperty("iat")||(e=!1,this.oidcSecurityCommon.logWarning("iat is missing, this is required in the id_token")),e},t.prototype.validate_id_token_iat_max_offset=function(t,e){if(!t.hasOwnProperty("iat"))return!1;var r=new Date(0);return r.setUTCSeconds(t.iat),e=e||0,null!==r&&(this.oidcSecurityCommon.logDebug("validate_id_token_iat_max_offset: "+((new Date).valueOf()-r.valueOf())+" < "+1e3*e),(new Date).valueOf()-r.valueOf()<1e3*e)},t.prototype.validate_id_token_nonce=function(t,e){return t.nonce===e||(this.oidcSecurityCommon.logDebug("Validate_id_token_nonce failed, dataIdToken.nonce: "+t.nonce+" local_nonce:"+e),!1)},t.prototype.validate_id_token_iss=function(t,e){return t.iss===e||(this.oidcSecurityCommon.logDebug("Validate_id_token_iss failed, dataIdToken.iss: "+t.iss+" authWellKnownEndpoints issuer:"+e),!1)},t.prototype.validate_id_token_aud=function(t,e){return t.aud===e||(this.oidcSecurityCommon.logDebug("Validate_id_token_aud failed, dataIdToken.aud: "+t.aud+" client_id:"+e),!1)},t.prototype.validateStateFromHashCallback=function(t,e){return t===e||(this.oidcSecurityCommon.logDebug("ValidateStateFromHashCallback failed, state: "+t+" local_state:"+e),!1)},t.prototype.validate_userdata_sub_id_token=function(t,e){return t===e||(this.oidcSecurityCommon.logDebug("validate_userdata_sub_id_token failed, id_token_sub: "+t+" userdata_sub:"+e),!1)},t.prototype.getPayloadFromToken=function(t,e){var r={};if(void 0!==t){var i=t.split(".")[1];if(e)return i;void 0!==i&&(r=JSON.parse(this.urlBase64Decode(i)))}return r},t.prototype.getHeaderFromToken=function(t,e){var r={};if(void 0!==t){var i=t.split(".")[0];if(e)return i;void 0!==i&&(r=JSON.parse(this.urlBase64Decode(i)))}return r},t.prototype.getSignatureFromToken=function(t,e){var r={};if(void 0!==t){var i=t.split(".")[2];if(e)return i;void 0!==i&&(console.log(this.urlBase64Decode(i)),r=JSON.parse(this.urlBase64Decode(i)))}return r},t.prototype.validate_signature_id_token=function(t,e){if(!e||!e.keys)return!1;var r=this.getHeaderFromToken(t,!1),i=r.kid;if("RS256"!==r.alg)return this.oidcSecurityCommon.logWarning("Only RS256 supported"),!1;var n=!1;if(r.hasOwnProperty("kid"))for(var o=0,s=e.keys;o<s.length;o++){if((f=s[o]).kid===i){d=h.KEYUTIL.getKey(f);return(n=h.KJUR.jws.JWS.verify(t,d,["RS256"]))||this.oidcSecurityCommon.logWarning("incorrect Signature, validation failed for id_token"),n}}else{for(var c=0,u=0,a=e.keys;u<a.length;u++){"RSA"===(f=a[u]).kty&&"sig"===f.use&&(c+=1)}if(0===c)return this.oidcSecurityCommon.logWarning("no keys found, incorrect Signature, validation failed for id_token"),!1;if(c>1)return this.oidcSecurityCommon.logWarning("no ID Token kid claim in JOSE header and multiple supplied in jwks_uri"),!1;for(var l=0,p=e.keys;l<p.length;l++){var f;if("RSA"===(f=p[l]).kty&&"sig"===f.use){var d=h.KEYUTIL.getKey(f);return(n=h.KJUR.jws.JWS.verify(t,d,["RS256"]))||this.oidcSecurityCommon.logWarning("incorrect Signature, validation failed for id_token"),n}}}return n},t.prototype.config_validate_response_type=function(t){return"id_token token"===t||"id_token"===t||(this.oidcSecurityCommon.logWarning("module configure incorrect, invalid response_type:"+t),!1)},t.prototype.validate_id_token_at_hash=function(t,e){this.oidcSecurityCommon.logDebug("From the server:"+e);var r=this.generate_at_hash(""+t);if(this.oidcSecurityCommon.logDebug("client validation not decoded:"+r),r===e)return!0;var i=this.generate_at_hash(""+decodeURIComponent(t));return this.oidcSecurityCommon.logDebug("-gen access--"+i),i===e},t.prototype.generate_at_hash=function(t){var e=h.KJUR.crypto.Util.hashString(t,"sha256"),r=e.substr(0,e.length/2);return h.hextob64u(r)},t.prototype.getTokenExpirationDate=function(t){if(!t.hasOwnProperty("exp"))return new Date;var e=new Date(0);return e.setUTCSeconds(t.exp),e},t.prototype.urlBase64Decode=function(t){if(void 0!==t&&null!==t){var e=t.replace("-","+").replace("_","/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:console.log("Illegal base64url string!")}return window.atob(e)}},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:Mf}]},t}(),Uf=function(){function t(t,r,n){var o=this;this.http=t,this.authConfiguration=r,this.oidcSecurityCommon=n,this.onWellKnownEndpointsLoaded=new e.EventEmitter(!0),this.getWellKnownEndpoints=function(){var t=new i.Headers;t.append("Accept","application/json");var e=o.authConfiguration.stsServer+"/.well-known/openid-configuration";return o.authConfiguration.override_well_known_configuration&&(e=o.authConfiguration.override_well_known_configuration_url),o.http.get(e,{headers:t}).map(function(t){return t.json()})}}return t.prototype.setupModule=function(){var t=this,e=this.oidcSecurityCommon.retrieve(this.oidcSecurityCommon.storage_well_known_endpoints);this.oidcSecurityCommon.logDebug(e),e&&""!==e?(this.oidcSecurityCommon.logDebug("AuthWellKnownEndpoints already defined"),this.issuer=e.issuer,this.jwks_uri=e.jwks_uri,this.authorization_endpoint=e.authorization_endpoint,this.token_endpoint=e.token_endpoint,this.userinfo_endpoint=e.userinfo_endpoint,e.end_session_endpoint&&(this.end_session_endpoint=e.end_session_endpoint),e.check_session_iframe&&(this.check_session_iframe=e.check_session_iframe),e.revocation_endpoint&&(this.revocation_endpoint=e.revocation_endpoint),e.introspection_endpoint&&(this.introspection_endpoint=e.introspection_endpoint),this.onWellKnownEndpointsLoaded.emit()):(this.oidcSecurityCommon.logDebug("AuthWellKnownEndpoints first time, get from the server"),this.getWellKnownEndpoints().subscribe(function(e){t.issuer=e.issuer,t.jwks_uri=e.jwks_uri,t.authorization_endpoint=e.authorization_endpoint,t.token_endpoint=e.token_endpoint,t.userinfo_endpoint=e.userinfo_endpoint,e.end_session_endpoint&&(t.end_session_endpoint=e.end_session_endpoint),e.check_session_iframe&&(t.check_session_iframe=e.check_session_iframe),e.revocation_endpoint&&(t.revocation_endpoint=e.revocation_endpoint),e.introspection_endpoint&&(t.introspection_endpoint=e.introspection_endpoint),t.oidcSecurityCommon.store(t.oidcSecurityCommon.storage_well_known_endpoints,e),t.oidcSecurityCommon.logDebug(e),t.onWellKnownEndpointsLoaded.emit()}))},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:i.Http},{type:zf},{type:Mf}]},t.propDecorators={onWellKnownEndpointsLoaded:[{type:e.Output}]},t}(),qf=function(){function t(t,r,i){this.authConfiguration=t,this.oidcSecurityCommon=r,this.authWellKnownEndpoints=i,this.onCheckSessionChanged=new e.EventEmitter(!0)}return t.prototype.init=function(){var t=this;return window.parent.document.getElementById("myiFrameForCheckSession")?Ff.empty():(this.sessionIframe=window.document.createElement("iframe"),this.sessionIframe.id="myiFrameForCheckSession",this.oidcSecurityCommon.logDebug(this.sessionIframe),this.sessionIframe.style.display="none",this.sessionIframe.src=this.authWellKnownEndpoints.check_session_iframe,window.document.body.appendChild(this.sessionIframe),this.iframeMessageEvent=this.messageHandler.bind(this),window.addEventListener("message",this.iframeMessageEvent,!1),Ff.create(function(e){t.sessionIframe.onload=function(){e.next(t),e.complete()}}))},t.prototype.pollServerSession=function(t){var e,r=this;e=Ff.timer(3e3,3e3).timeInterval().pluck("interval").take(1e4);try{e.subscribe(function(){r.oidcSecurityCommon.logDebug(r.sessionIframe);r.oidcSecurityCommon.retrieve(r.oidcSecurityCommon.storage_session_state)})}catch(t){}},t.prototype.messageHandler=function(t){t.origin===this.authConfiguration.stsServer&&t.source===this.sessionIframe.contentWindow&&("error"===t.data?this.oidcSecurityCommon.logWarning("error from checksession messageHandler"):"changed"===t.data?this.onCheckSessionChanged.emit():this.oidcSecurityCommon.logDebug(t.data+" from checksession messageHandler"))},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:zf},{type:Mf},{type:Uf}]},t.propDecorators={onCheckSessionChanged:[{type:e.Output}]},t}(),Bf=function(){function t(t){this.oidcSecurityCommon=t}return t.prototype.initRenew=function(){var t=window.parent.document.getElementById("myiFrameForSilentRenew"),e=window.document.getElementById("myiFrameForSilentRenew");t?this.sessionIframe=t:e&&(this.sessionIframe=e),e||t||(this.sessionIframe=window.document.createElement("iframe"),this.sessionIframe.id="myiFrameForSilentRenew",this.oidcSecurityCommon.logDebug(this.sessionIframe),this.sessionIframe.style.display="none",window.document.body.appendChild(this.sessionIframe))},t.prototype.startRenew=function(t){var e=this;return new Promise(function(r,i){var n=window.parent.document.getElementById("myiFrameForSilentRenew"),o=window.document.getElementById("myiFrameForSilentRenew");n?e.sessionIframe=n:o&&(e.sessionIframe=o),e.oidcSecurityCommon.logDebug("startRenew for URL:"+t),e.sessionIframe.src=t,e.sessionIframe.onload=function(){r()}})},t.prototype.silentLogout=function(t){var e=this;return new Promise(function(r,i){var n=window.parent.document.getElementById("myiFrameForSilentRenew"),o=window.document.getElementById("myiFrameForSilentRenew");n?e.sessionIframe=n:o&&(e.sessionIframe=o),e.oidcSecurityCommon.logDebug("startRenew for URL:"+t),e.sessionIframe.src=t,e.sessionIframe.onload=function(){r()}})},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:Mf}]},t}(),Kf=function(){function t(t,e,r,n){var o=this;this.http=t,this.authConfiguration=e,this.oidcSecurityCommon=r,this.authWellKnownEndpoints=n,this.userData="",this.getIdentityUserData=function(){var t=new i.Headers;t.append("Accept","application/json");var e=o.oidcSecurityCommon.getAccessToken();return""!==e&&t.append("Authorization","Bearer "+decodeURIComponent(e)),o.http.get(o.authWellKnownEndpoints.userinfo_endpoint,{headers:t,body:""}).map(function(t){/^[\],:{}\s]*$/.test(t._body.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))&&(o.userData=t.json())})}}return t.prototype.initUserData=function(){var t=this;return this.getIdentityUserData().map(function(e){void 0!==e&&null!==e&&(t.userData=e)})},t.prototype.handleError=function(t){this.oidcSecurityCommon.logError(t)},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:i.Http},{type:zf},{type:Mf},{type:Uf}]},t}(),Hf=function(){function t(t,r,i,n,o,s,c,u,a){this.platformId=t,this.http=r,this.authConfiguration=i,this.router=n,this.oidcSecurityCheckSession=o,this.oidcSecuritySilentRenew=s,this.oidcSecurityUserService=c,this.oidcSecurityCommon=u,this.authWellKnownEndpoints=a,this.onModuleSetup=new e.EventEmitter(!0),this._isAuthorized=new fa(!1),this._userData=new fa(""),this._isLoading=new fa(!1),this.source_mobile=Ff.timer(3e4,3e4).timeInterval().pluck("interval").take(1e4),this.source_browser=Ff.timer(3e3,3e3).timeInterval().pluck("interval").take(1e4)}return t.prototype.setupModule=function(t){var e=this;this.authConfiguration.init(t),this.oidcSecurityValidation=new Lf(this.oidcSecurityCommon),this.oidcSecurityCheckSession.onCheckSessionChanged.subscribe(function(){e.onCheckSessionChanged()}),this.authWellKnownEndpoints.onWellKnownEndpointsLoaded.subscribe(function(){e.onWellKnownEndpointsLoaded()}),this.oidcSecurityCommon.setupModule(),""!==this.oidcSecurityCommon.retrieve(this.oidcSecurityCommon.storage_user_data)&&this.setUserData(this.oidcSecurityCommon.retrieve(this.oidcSecurityCommon.storage_user_data)),""!==this.oidcSecurityCommon.retrieve(this.oidcSecurityCommon.storage_is_authorized)&&this.setIsAuthorized(this.oidcSecurityCommon.retrieve(this.oidcSecurityCommon.storage_is_authorized)),this.oidcSecurityCommon.logDebug("STS server: "+this.authConfiguration.stsServer),r.isPlatformBrowser(this.platformId)&&(this.authWellKnownEndpoints.setupModule(),this.authConfiguration.silent_renew&&this.oidcSecuritySilentRenew.initRenew(),this.authConfiguration.start_checksession&&this.oidcSecurityCheckSession.init().subscribe(function(){e.oidcSecurityCheckSession.pollServerSession(e.authConfiguration.client_id)})),this.moduleSetup=!0,this.onModuleSetup.emit()},t.prototype.getUserData=function(){return this._userData.asObservable()},t.prototype.setUserData=function(t){this.oidcSecurityCommon.store(this.oidcSecurityCommon.storage_user_data,t),this._userData.next(t)},t.prototype.getIsAuthorized=function(){return this._isAuthorized.asObservable()},t.prototype.setIsAuthorized=function(t){this._isAuthorizedValue=t,this._isAuthorized.next(t)},t.prototype.getIsLoading=function(){return this._isLoading.asObservable()},t.prototype.setIsLoading=function(t){this._isLoadingValue=t,this._isLoading.next(t)},t.prototype.getToken=function(){if(!this._isAuthorizedValue)return"";var t=this.oidcSecurityCommon.getAccessToken();return decodeURIComponent(t)},t.prototype.getIdToken=function(){if(!this._isAuthorizedValue)return"";var t=this.oidcSecurityCommon.getIdToken();return decodeURIComponent(t)},t.prototype.getPayloadFromIdToken=function(t){void 0===t&&(t=!1);var e=this.getIdToken();return this.oidcSecurityValidation.getPayloadFromToken(e,t)},t.prototype.setCustomRequestParameters=function(t){this.oidcSecurityCommon.store(this.oidcSecurityCommon.storage_custom_request_params,t)},t.prototype.getRefreshSessionUrl=function(){var t=this.oidcSecurityCommon.retrieve(this.oidcSecurityCommon.storage_well_known_endpoints);if(t&&""!==t&&(this.authWellKnownEndpointsLoaded=!0),this.authWellKnownEndpointsLoaded){if(this.oidcSecurityValidation.config_validate_response_type(this.authConfiguration.response_type)){this.oidcSecurityCommon.logDebug("BEGIN Authorize, no auth data");var e="N"+Math.random()+Date.now(),r=Date.now()+""+Math.random();this.oidcSecurityCommon.store(this.oidcSecurityCommon.storage_auth_state_control,r),this.oidcSecurityCommon.store(this.oidcSecurityCommon.storage_auth_nonce,e),this.oidcSecurityCommon.logDebug("AuthorizedController created. local state: "+this.oidcSecurityCommon.retrieve(this.oidcSecurityCommon.storage_auth_state_control));return this.createAuthorizeUrl(e,r,this.authWellKnownEndpoints.authorization_endpoint)}}else this.oidcSecurityCommon.logError("Well known endpoints must be loaded before user can login!")},t.prototype.authorize=function(t){void 0===t&&(t="local");var e=this.oidcSecurityCommon.retrieve(this.oidcSecurityCommon.storage_well_known_endpoints);if(e&&""!==e&&(this.authWellKnownEndpointsLoaded=!0),this.authWellKnownEndpointsLoaded){if(this.oidcSecurityValidation.config_validate_response_type(this.authConfiguration.response_type)){this.resetAuthorizationData(!1),this.oidcSecurityCommon.logDebug("BEGIN Authorize, no auth data");var r="N"+Math.random()+Date.now(),i=Date.now()+""+Math.random();this.oidcSecurityCommon.store(this.oidcSecurityCommon.storage_auth_state_control,i),this.oidcSecurityCommon.store(this.oidcSecurityCommon.storage_auth_nonce,r),this.oidcSecurityCommon.logDebug("AuthorizedController created. local state: "+this.oidcSecurityCommon.retrieve(this.oidcSecurityCommon.storage_auth_state_control));var n=this.createAuthorizeUrl(r,i,this.authWellKnownEndpoints.authorization_endpoint);n=n+"&authenticationScheme="+t,window.location.href=n}}else this.oidcSecurityCommon.logError("Well known endpoints must be loaded before user can login!")},t.prototype.authorizeWithPopup=function(t){void 0===t&&(t="local"),this._popupFor="login";var e=this.oidcSecurityCommon.retrieve(this.oidcSecurityCommon.storage_well_known_endpoints);if(e&&""!==e&&(this.authWellKnownEndpointsLoaded=!0),this.authWellKnownEndpointsLoaded){if(this.oidcSecurityValidation.config_validate_response_type(this.authConfiguration.response_type)){this.resetAuthorizationData(!1),this.oidcSecurityCommon.logDebug("BEGIN Authorize, no auth data");var r="N"+Math.random()+Date.now(),i=Date.now()+""+Math.random();this.oidcSecurityCommon.store(this.oidcSecurityCommon.storage_auth_state_control,i),this.oidcSecurityCommon.store(this.oidcSecurityCommon.storage_auth_nonce,r),this.oidcSecurityCommon.logDebug("AuthorizedController created. local state: "+this.oidcSecurityCommon.retrieve(this.oidcSecurityCommon.storage_auth_state_control));var n=this.createAuthorizeUrl(r,i,this.authWellKnownEndpoints.authorization_endpoint);n=n+"&authenticationScheme="+t,"afterRegistration"===this._popupFor?this._popup.location.href=n:this.popup(n,"QPONS' AUTHORIZATION PAGE",800,800)}}else this.oidcSecurityCommon.logError("Well known endpoints must be loaded before user can login!")},t.prototype.authorizeWithWebview=function(t){void 0===t&&(t="local"),this._popupFor="login";var e=this.oidcSecurityCommon.retrieve(this.oidcSecurityCommon.storage_well_known_endpoints);if(e&&""!==e&&(this.authWellKnownEndpointsLoaded=!0),this.authWellKnownEndpointsLoaded){if(this.oidcSecurityValidation.config_validate_response_type(this.authConfiguration.response_type)){this.resetAuthorizationData(!1),this.oidcSecurityCommon.logDebug("BEGIN Authorize, no auth data");var r="N"+Math.random()+Date.now(),i=Date.now()+""+Math.random();this.oidcSecurityCommon.store(this.oidcSecurityCommon.storage_auth_state_control,i),this.oidcSecurityCommon.store(this.oidcSecurityCommon.storage_auth_nonce,r),this.oidcSecurityCommon.logDebug("AuthorizedController created. local state: "+this.oidcSecurityCommon.retrieve(this.oidcSecurityCommon.storage_auth_state_control));var n=this.createAuthorizeUrl(r,i,this.authWellKnownEndpoints.authorization_endpoint);n=n+"&authenticationScheme="+t,"afterRegistration"===this._popupFor?this._popup.location.href=n:this.webview(n,"_blank")}}else this.oidcSecurityCommon.logError("Well known endpoints must be loaded before user can login!")},t.prototype.popup=function(t,e,r,i){var n;this.CheckForPopupClosedInterval=2e3;var o=void 0!==window.screenLeft?window.screenLeft:0,s=void 0!==window.screenTop?window.screenTop:0,c=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:window.screen.width;n+="toolbar=no,location=no,directories=no,status=no",n+=",menubar=no,scrollbars=no,resizable=no,copyhistory=no",n+=",width="+r,n+=",height="+i,n+=",top="+((window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:window.screen.height)/2-i/2+s),n+=",left="+(c/2-r/2+o),this._popup=window.open(t,e,n),"login"===this._popupFor?this._checkForPopupClosedTimer=window.setInterval(this._checkForPopupClosed.bind(this),this.CheckForPopupClosedInterval):"logout"===this._popupFor&&(this._checkForPopupClosedTimer=window.setInterval(this._checkForLogoutPopupClosed.bind(this),this.CheckForPopupClosedInterval))},t.prototype.webview=function(t,e,r){var i=this;void 0===r&&(r="location=yes,status=yes"),this.CheckForPopupClosedInterval=2e3,this._popup=window.open(t,e,r),this._popup.addEventListener("loadstart",function(e){var r=e.url,n=r.split("/");if(n=n[n.length-1],"-1"!==r.indexOf("#")){var o=t.split("#")[1].split("&").reduce(function(t,e){var r=e.split("=");return t[r[0]]=r[1],t},{});void 0!==o.id_token&&(i._popup.close(),i.authorizedCallbackForWebview(o))}"login"===n&&i.authorizeWithWebview()})},t.prototype.silentRenewForWebview=function(t){var e=this;this.CheckForPopupClosedInterval=2e3,this._popup=window.open(t,"_blank","hidden=yes"),this._popup.addEventListener("loadstart",function(t){var r=t.url,i=r.split("/");i=i[i.length-1],"-1"!==r.indexOf("#")&&(e._popup.close(),e.authorizedCallbackForWebview(r)),"login"===i&&e.authorizeWithWebview()})},t.prototype.popup_cleanup=function(){window.clearInterval(this._checkForPopupClosedTimer),this._checkForPopupClosedTimer=null,this._popup=null},t.prototype._checkForPopupClosed=function(){try{if("about:blank"!==this._popup.location.href&&void 0!==this._popup.location.href){var t=this._popup.location.href.split("/");"login"!==(t=t[t.length-1])?(this._popup.close(),this._popup&&!this._popup.closed||(this.authorizedCallbackForPopup(),this.popup_cleanup())):!this._popup||this._popup.closed?this.popup_cleanup():(this._popupFor="afterRegistration",this.authorizeWithPopup())}}catch(t){}},t.prototype._checkForLogoutPopupClosed=function(){try{"about:blank"!==this._popup.location.href&&(this._popup.close(),this._popup&&!this._popup.closed||this.popup_cleanup())}catch(t){}},t.prototype.authorizedCallbackForWebview=function(t){var e=this;this.setIsLoading(!0);var r="running"===this.oidcSecurityCommon.retrieve(this.oidcSecurityCommon.storage_silent_renew_running);this.oidcSecurityCommon.logDebug("BEGIN authorizedCallback, no auth data"),this.resetAuthorizationData(r),this.oidcSecurityCommon.store(this.oidcSecurityCommon.storage_auth_result,t),this.oidcSecurityCommon.logDebug(t),this.oidcSecurityCommon.logDebug("authorizedCallback created, begin token validation");var i,n="",o="",s=!1;this.getSigningKeys().subscribe(function(c){if(e.jwtKeys=c,!t.error)if(e.oidcSecurityValidation.validateStateFromHashCallback(t.state,e.oidcSecurityCommon.retrieve(e.oidcSecurityCommon.storage_auth_state_control))){"id_token token"===e.authConfiguration.response_type&&(n=t.access_token),o=t.id_token;i=e.oidcSecurityValidation.getPayloadFromToken(o,!1),e.oidcSecurityValidation.getHeaderFromToken(o,!1),e.oidcSecurityValidation.validate_signature_id_token(o,e.jwtKeys)?e.oidcSecurityValidation.validate_id_token_nonce(i,e.oidcSecurityCommon.retrieve(e.oidcSecurityCommon.storage_auth_nonce))?e.oidcSecurityValidation.validate_required_id_token(i)?e.oidcSecurityValidation.validate_id_token_iat_max_offset(i,e.authConfiguration.max_id_token_iat_offset_allowed_in_seconds)?e.oidcSecurityValidation.validate_id_token_iss(i,e.authWellKnownEndpoints.issuer)?e.oidcSecurityValidation.validate_id_token_aud(i,e.authConfiguration.client_id)?e.oidcSecurityValidation.validate_id_token_exp_not_expired(i)?"id_token token"===e.authConfiguration.response_type?e.oidcSecurityValidation.validate_id_token_at_hash(n,i.at_hash)||!n?(s=!0,e.successful_validation()):e.oidcSecurityCommon.logWarning("authorizedCallback incorrect at_hash"):(s=!0,e.successful_validation()):e.oidcSecurityCommon.logWarning("authorizedCallback token expired"):e.oidcSecurityCommon.logWarning("authorizedCallback incorrect aud"):e.oidcSecurityCommon.logWarning("authorizedCallback incorrect iss does not match authWellKnownEndpoints issuer"):e.oidcSecurityCommon.logWarning("authorizedCallback Validation, iat rejected id_token was issued too far away from the current time"):e.oidcSecurityCommon.logDebug("authorizedCallback Validation, one of the REQUIRED properties missing from id_token"):e.oidcSecurityCommon.logWarning("authorizedCallback incorrect nonce"):e.oidcSecurityCommon.logDebug("authorizedCallback Signature validation failed id_token")}else e.oidcSecurityCommon.logWarning("authorizedCallback incorrect state");e.oidcSecurityCommon.store(e.oidcSecurityCommon.storage_silent_renew_running,""),s?(e.setAuthorizationData(n,o),e.authConfiguration.auto_userinfo?e.getUserinfo(r,t,o,i).subscribe(function(t){t?(e.setIsLoading(!1),e.router.navigate([e.authConfiguration.startup_route])):e.setIsLoading(!1)}):(e.setIsLoading(!1),e.router.navigate([e.authConfiguration.startup_route]))):(e.oidcSecurityCommon.logDebug("authorizedCallback, token(s) validation failed, resetting"),e.resetAuthorizationData(!1),e.setIsLoading(!1),e.router.navigate([e.authConfiguration.unauthorized_route]))})},t.prototype.authorizedCallbackForPopup=function(){var t=this;this.setIsLoading(!0);var e="running"===this.oidcSecurityCommon.retrieve(this.oidcSecurityCommon.storage_silent_renew_running);this.oidcSecurityCommon.logDebug("BEGIN authorizedCallback, no auth data"),this.resetAuthorizationData(e);var r=this._popup.location.hash.substr(1).split("&").reduce(function(t,e){var r=e.split("=");return t[r[0]]=r[1],t},{});this.oidcSecurityCommon.store(this.oidcSecurityCommon.storage_auth_result,r),this.oidcSecurityCommon.logDebug(r),this.oidcSecurityCommon.logDebug("authorizedCallback created, begin token validation");var i,n="",o="",s=!1;this.getSigningKeys().subscribe(function(c){if(t.jwtKeys=c,!r.error)if(t.oidcSecurityValidation.validateStateFromHashCallback(r.state,t.oidcSecurityCommon.retrieve(t.oidcSecurityCommon.storage_auth_state_control))){"id_token token"===t.authConfiguration.response_type&&(n=r.access_token),o=r.id_token;i=t.oidcSecurityValidation.getPayloadFromToken(o,!1),t.oidcSecurityValidation.getHeaderFromToken(o,!1),t.oidcSecurityValidation.validate_signature_id_token(o,t.jwtKeys)?t.oidcSecurityValidation.validate_id_token_nonce(i,t.oidcSecurityCommon.retrieve(t.oidcSecurityCommon.storage_auth_nonce))?t.oidcSecurityValidation.validate_required_id_token(i)?t.oidcSecurityValidation.validate_id_token_iat_max_offset(i,t.authConfiguration.max_id_token_iat_offset_allowed_in_seconds)?t.oidcSecurityValidation.validate_id_token_iss(i,t.authWellKnownEndpoints.issuer)?t.oidcSecurityValidation.validate_id_token_aud(i,t.authConfiguration.client_id)?t.oidcSecurityValidation.validate_id_token_exp_not_expired(i)?"id_token token"===t.authConfiguration.response_type?t.oidcSecurityValidation.validate_id_token_at_hash(n,i.at_hash)||!n?(s=!0,t.successful_validation()):t.oidcSecurityCommon.logWarning("authorizedCallback incorrect at_hash"):(s=!0,t.successful_validation()):t.oidcSecurityCommon.logWarning("authorizedCallback token expired"):t.oidcSecurityCommon.logWarning("authorizedCallback incorrect aud"):t.oidcSecurityCommon.logWarning("authorizedCallback incorrect iss does not match authWellKnownEndpoints issuer"):t.oidcSecurityCommon.logWarning("authorizedCallback Validation, iat rejected id_token was issued too far away from the current time"):t.oidcSecurityCommon.logDebug("authorizedCallback Validation, one of the REQUIRED properties missing from id_token"):t.oidcSecurityCommon.logWarning("authorizedCallback incorrect nonce"):t.oidcSecurityCommon.logDebug("authorizedCallback Signature validation failed id_token")}else t.oidcSecurityCommon.logWarning("authorizedCallback incorrect state");t.oidcSecurityCommon.store(t.oidcSecurityCommon.storage_silent_renew_running,""),s?(t.setAuthorizationData(n,o),t.authConfiguration.auto_userinfo?t.getUserinfo(e,r,o,i).subscribe(function(e){e?(t.setIsLoading(!1),t.router.navigate([t.authConfiguration.startup_route])):t.setIsLoading(!1)}):(t.setIsLoading(!1),t.router.navigate([t.authConfiguration.startup_route]))):(t.oidcSecurityCommon.logDebug("authorizedCallback, token(s) validation failed, resetting"),t.resetAuthorizationData(!1),t.setIsLoading(!1),t.router.navigate([t.authConfiguration.unauthorized_route]))})},t.prototype.authorizedCallback=function(){var t=this,e="running"===this.oidcSecurityCommon.retrieve(this.oidcSecurityCommon.storage_silent_renew_running);this.oidcSecurityCommon.logDebug("BEGIN authorizedCallback, no auth data"),this.resetAuthorizationData(e);var r=window.location.hash.substr(1).split("&").reduce(function(t,e){var r=e.split("=");return t[r[0]]=r[1],t},{});this.oidcSecurityCommon.store(this.oidcSecurityCommon.storage_auth_result,r),this.oidcSecurityCommon.logDebug(r),this.oidcSecurityCommon.logDebug("authorizedCallback created, begin token validation");var i,n="",o="",s=!1;this.getSigningKeys().subscribe(function(c){if(t.jwtKeys=c,!r.error)if(t.oidcSecurityValidation.validateStateFromHashCallback(r.state,t.oidcSecurityCommon.retrieve(t.oidcSecurityCommon.storage_auth_state_control))){"id_token token"===t.authConfiguration.response_type&&(n=r.access_token),o=r.id_token;i=t.oidcSecurityValidation.getPayloadFromToken(o,!1),t.oidcSecurityValidation.getHeaderFromToken(o,!1),t.oidcSecurityValidation.validate_signature_id_token(o,t.jwtKeys)?t.oidcSecurityValidation.validate_id_token_nonce(i,t.oidcSecurityCommon.retrieve(t.oidcSecurityCommon.storage_auth_nonce))?t.oidcSecurityValidation.validate_required_id_token(i)?t.oidcSecurityValidation.validate_id_token_iat_max_offset(i,t.authConfiguration.max_id_token_iat_offset_allowed_in_seconds)?t.oidcSecurityValidation.validate_id_token_iss(i,t.authWellKnownEndpoints.issuer)?t.oidcSecurityValidation.validate_id_token_aud(i,t.authConfiguration.client_id)?t.oidcSecurityValidation.validate_id_token_exp_not_expired(i)?"id_token token"===t.authConfiguration.response_type?t.oidcSecurityValidation.validate_id_token_at_hash(n,i.at_hash)||!n?(s=!0,t.successful_validation()):t.oidcSecurityCommon.logWarning("authorizedCallback incorrect at_hash"):(s=!0,t.successful_validation()):t.oidcSecurityCommon.logWarning("authorizedCallback token expired"):t.oidcSecurityCommon.logWarning("authorizedCallback incorrect aud"):t.oidcSecurityCommon.logWarning("authorizedCallback incorrect iss does not match authWellKnownEndpoints issuer"):t.oidcSecurityCommon.logWarning("authorizedCallback Validation, iat rejected id_token was issued too far away from the current time"):t.oidcSecurityCommon.logDebug("authorizedCallback Validation, one of the REQUIRED properties missing from id_token"):t.oidcSecurityCommon.logWarning("authorizedCallback incorrect nonce"):t.oidcSecurityCommon.logDebug("authorizedCallback Signature validation failed id_token")}else t.oidcSecurityCommon.logWarning("authorizedCallback incorrect state");t.oidcSecurityCommon.store(t.oidcSecurityCommon.storage_silent_renew_running,""),s?(t.setAuthorizationData(n,o),t.authConfiguration.auto_userinfo?t.getUserinfo(e,r,o,i).subscribe(function(e){e&&t.router.navigate([t.authConfiguration.startup_route])}):t.router.navigate([t.authConfiguration.startup_route])):(t.oidcSecurityCommon.logDebug("authorizedCallback, token(s) validation failed, resetting"),t.resetAuthorizationData(!1),t.router.navigate([t.authConfiguration.unauthorized_route]))})},t.prototype.refreshSessionCallback=function(t){var e=this;return new Promise(function(r,i){var n="running"===e.oidcSecurityCommon.retrieve(e.oidcSecurityCommon.storage_silent_renew_running);e.oidcSecurityCommon.logDebug("BEGIN authorizedCallback, no auth data"),e.resetAuthorizationData(n);var o=t.split("&").reduce(function(t,e){var r=e.split("=");return t[r[0]]=r[1],t},{});e.oidcSecurityCommon.store(e.oidcSecurityCommon.storage_auth_result,o),e.oidcSecurityCommon.logDebug(o),e.oidcSecurityCommon.logDebug("authorizedCallback created, begin token validation");var s,c="",u="",a=!1;e.getSigningKeys().subscribe(function(t){if(e.jwtKeys=t,!o.error)if(e.oidcSecurityValidation.validateStateFromHashCallback(o.state,e.oidcSecurityCommon.retrieve(e.oidcSecurityCommon.storage_auth_state_control))){"id_token token"===e.authConfiguration.response_type&&(c=o.access_token),u=o.id_token;s=e.oidcSecurityValidation.getPayloadFromToken(u,!1),e.oidcSecurityValidation.getHeaderFromToken(u,!1),e.oidcSecurityValidation.validate_signature_id_token(u,e.jwtKeys)?e.oidcSecurityValidation.validate_id_token_nonce(s,e.oidcSecurityCommon.retrieve(e.oidcSecurityCommon.storage_auth_nonce))?e.oidcSecurityValidation.validate_required_id_token(s)?e.oidcSecurityValidation.validate_id_token_iat_max_offset(s,e.authConfiguration.max_id_token_iat_offset_allowed_in_seconds)?e.oidcSecurityValidation.validate_id_token_iss(s,e.authWellKnownEndpoints.issuer)?e.oidcSecurityValidation.validate_id_token_aud(s,e.authConfiguration.client_id)?e.oidcSecurityValidation.validate_id_token_exp_not_expired(s)?"id_token token"===e.authConfiguration.response_type?e.oidcSecurityValidation.validate_id_token_at_hash(c,s.at_hash)||!c?(a=!0,e.successful_validation()):e.oidcSecurityCommon.logWarning("authorizedCallback incorrect at_hash"):(a=!0,e.successful_validation()):e.oidcSecurityCommon.logWarning("authorizedCallback token expired"):e.oidcSecurityCommon.logWarning("authorizedCallback incorrect aud"):e.oidcSecurityCommon.logWarning("authorizedCallback incorrect iss does not match authWellKnownEndpoints issuer"):e.oidcSecurityCommon.logWarning("authorizedCallback Validation, iat rejected id_token was issued too far away from the current time"):e.oidcSecurityCommon.logDebug("authorizedCallback Validation, one of the REQUIRED properties missing from id_token"):e.oidcSecurityCommon.logWarning("authorizedCallback incorrect nonce"):e.oidcSecurityCommon.logDebug("authorizedCallback Signature validation failed id_token")}else e.oidcSecurityCommon.logWarning("authorizedCallback incorrect state");e.oidcSecurityCommon.store(e.oidcSecurityCommon.storage_silent_renew_running,""),a?(e.setAuthorizationData(c,u),e.authConfiguration.auto_userinfo?e.getUserinfo(n,o,u,s).subscribe(function(t){t?r():i()}):i()):(e.oidcSecurityCommon.logDebug("authorizedCallback, token(s) validation failed, resetting"),e.resetAuthorizationData(!1),i())})})},t.prototype.getUserinfo=function(t,e,r,i){var n=this;return void 0===t&&(t=!1),e=e||this.oidcSecurityCommon.retrieve(this.oidcSecurityCommon.storage_auth_result),r=r||this.oidcSecurityCommon.retrieve(this.oidcSecurityCommon.storage_id_token),i=i||this.oidcSecurityValidation.getPayloadFromToken(r,!1),new Ff(function(r){"id_token token"===n.authConfiguration.response_type?t?(n.oidcSecurityCommon.store(n.oidcSecurityCommon.storage_session_state,e.session_state),r.next(!0),r.complete()):n.oidcSecurityUserService.initUserData().subscribe(function(){n.oidcSecurityCommon.logDebug("authorizedCallback id_token token flow"),n.oidcSecurityValidation.validate_userdata_sub_id_token(i.sub,n.oidcSecurityUserService.userData.sub)?(n.setUserData(n.oidcSecurityUserService.userData),n.oidcSecurityCommon.logDebug(n.oidcSecurityCommon.retrieve(n.oidcSecurityCommon.storage_access_token)),n.oidcSecurityCommon.logDebug(n.oidcSecurityUserService.userData),n.oidcSecurityCommon.store(n.oidcSecurityCommon.storage_session_state,e.session_state),r.next(!0)):(n.oidcSecurityCommon.logWarning("authorizedCallback, User data sub does not match sub in id_token"),n.oidcSecurityCommon.logDebug("authorizedCallback, token(s) validation failed, resetting"),n.resetAuthorizationData(!1),r.next(!1)),r.complete()}):(n.oidcSecurityCommon.logDebug("authorizedCallback id_token flow"),n.oidcSecurityCommon.logDebug(n.oidcSecurityCommon.retrieve(n.oidcSecurityCommon.storage_access_token)),n.oidcSecurityUserService.userData=i,n.setUserData(n.oidcSecurityUserService.userData),n.oidcSecurityCommon.store(n.oidcSecurityCommon.storage_session_state,e.session_state),r.next(!0),r.complete())})},t.prototype.logoff=function(){var t=this;return new Promise(function(e,r){if(t.oidcSecurityCommon.logDebug("BEGIN Authorize, no auth data"),t.authWellKnownEndpoints.end_session_endpoint){var i=t.authWellKnownEndpoints.end_session_endpoint,n=t.oidcSecurityCommon.retrieve(t.oidcSecurityCommon.storage_id_token),o=t.authConfiguration.post_logout_redirect_uri,s=i+"?id_token_hint="+encodeURI(n)+"&post_logout_redirect_uri="+encodeURI(o);t.resetAuthorizationData(!1),t.authConfiguration.start_checksession&&t.checkSessionChanged?(t.oidcSecurityCommon.logDebug("only local login cleaned up, server session has changed"),e()):t.oidcSecuritySilentRenew.silentLogout(s).then(function(t){e()})}else t.resetAuthorizationData(!1),t.oidcSecurityCommon.logDebug("only local login cleaned up, no end_session_endpoint"),e()})},t.prototype.successful_validation=function(){this.oidcSecurityCommon.store(this.oidcSecurityCommon.storage_auth_nonce,""),this.oidcSecurityCommon.store(this.oidcSecurityCommon.storage_auth_state_control,""),this.oidcSecurityCommon.logDebug("AuthorizedCallback token(s) validated, continue")},t.prototype.refreshSession=function(){var t=this;return new Promise(function(e,r){t.oidcSecurityCommon.logDebug("BEGIN refresh session Authorize");var i="N"+Math.random()+Date.now(),n=Date.now()+""+Math.random();t.oidcSecurityCommon.store(t.oidcSecurityCommon.storage_auth_state_control,n),t.oidcSecurityCommon.store(t.oidcSecurityCommon.storage_auth_nonce,i),t.oidcSecurityCommon.logDebug("RefreshSession created. adding myautostate: "+t.oidcSecurityCommon.retrieve(t.oidcSecurityCommon.storage_auth_state_control));var o=t.createAuthorizeUrl(i,n,t.authWellKnownEndpoints.authorization_endpoint);t.oidcSecurityCommon.store(t.oidcSecurityCommon.storage_silent_renew_running,"running"),t.oidcSecuritySilentRenew.startRenew(o).then(function(t){e()},function(t){r()})})},t.prototype.refreshSessionWithWebview=function(){this.oidcSecurityCommon.logDebug("BEGIN refresh session Authorize");var t="N"+Math.random()+Date.now(),e=Date.now()+""+Math.random();this.oidcSecurityCommon.store(this.oidcSecurityCommon.storage_auth_state_control,e),this.oidcSecurityCommon.store(this.oidcSecurityCommon.storage_auth_nonce,t),this.oidcSecurityCommon.logDebug("RefreshSession created. adding myautostate: "+this.oidcSecurityCommon.retrieve(this.oidcSecurityCommon.storage_auth_state_control));var r=this.createAuthorizeUrl(t,e,this.authWellKnownEndpoints.authorization_endpoint);this.oidcSecurityCommon.store(this.oidcSecurityCommon.storage_silent_renew_running,"running"),this.silentRenewForWebview(r)},t.prototype.setAuthorizationData=function(t,e){""!==this.oidcSecurityCommon.retrieve(this.oidcSecurityCommon.storage_access_token)&&this.oidcSecurityCommon.store(this.oidcSecurityCommon.storage_access_token,""),this.oidcSecurityCommon.logDebug(t),this.oidcSecurityCommon.logDebug(e),this.oidcSecurityCommon.logDebug("storing to storage, getting the roles"),this.oidcSecurityCommon.store(this.oidcSecurityCommon.storage_access_token,t),this.oidcSecurityCommon.store(this.oidcSecurityCommon.storage_id_token,e),this.setIsAuthorized(!0),this.oidcSecurityCommon.store(this.oidcSecurityCommon.storage_is_authorized,!0)},t.prototype.createAuthorizeUrl=function(t,e,r){var n=r.split("?"),o=n[0],s=new i.URLSearchParams(n[1]);s.set("client_id",this.authConfiguration.client_id),s.set("redirect_uri",this.authConfiguration.redirect_url),s.set("response_type",this.authConfiguration.response_type),s.set("scope",this.authConfiguration.scope),s.set("nonce",t),s.set("state",e);var c=Object.assign({},this.oidcSecurityCommon.retrieve(this.oidcSecurityCommon.storage_custom_request_params));return Object.keys(c).forEach(function(t){s.set(t,c[t])}),o+"?"+s},t.prototype.getAuthorizeData=function(t,e,r){return{client_id:this.authConfiguration.client_id,redirect_uri:this.authConfiguration.redirect_url,response_type:this.authConfiguration.response_type,scope:this.authConfiguration.scope,nonce:t,state:e}},t.prototype.resetAuthorizationData=function(t){t||(this.setIsAuthorized(!1),this.oidcSecurityCommon.resetStorageData(t),this.checkSessionChanged=!1)},t.prototype.handleError=function(t){if(this.oidcSecurityCommon.logError(t),403===t.status)this.router.navigate([this.authConfiguration.forbidden_route]);else if(401===t.status){var e=this.oidcSecurityCommon.retrieve(this.oidcSecurityCommon.storage_silent_renew_running);this.resetAuthorizationData(e),this.router.navigate([this.authConfiguration.unauthorized_route])}},t.prototype.onCheckSessionChanged=function(){this.oidcSecurityCommon.logDebug("onCheckSessionChanged"),this.checkSessionChanged=!0},t.prototype.onWellKnownEndpointsLoaded=function(){this.oidcSecurityCommon.logDebug("onWellKnownEndpointsLoaded"),this.authWellKnownEndpointsLoaded=!0},t.prototype.runGetSigningKeys=function(){var t=this;this.getSigningKeys().subscribe(function(e){return t.jwtKeys=e},function(e){return t.errorMessage=e})},t.prototype.getSigningKeys=function(){return this.oidcSecurityCommon.logDebug("jwks_uri: "+this.authWellKnownEndpoints.jwks_uri),this.http.get(this.authWellKnownEndpoints.jwks_uri).map(this.extractData).catch(this.handleErrorGetSigningKeys)},t.prototype.extractData=function(t){return t.json()},t.prototype.handleErrorGetSigningKeys=function(t){var e;if(t instanceof i.Response){var r=t.json()||{},n=r.error||JSON.stringify(r);e=t.status+" - "+(t.statusText||"")+" "+n}else e=t.message?t.message:t.toString();return console.error(e),Ff.throw(e)},t.prototype.runTokenValidationForBrowser=function(){var t=this;return new Promise(function(e,r){t.subscription=t.source_browser.subscribe(function(){t._isAuthorizedValue||t.resetAuthorizationData(!1)},function(e){t.oidcSecurityCommon.logError("Error: "+e)},function(){t.oidcSecurityCommon.logDebug("Completed")}),e()})},t.prototype.runTokenValidationForMobile=function(){var t=this;return new Promise(function(e,r){if(t.subscription.unsubscribe(),t.subscription=t.source_mobile.subscribe(function(){if(t._isAuthorizedValue){var e=t.oidcSecurityCommon.retrieve(t.oidcSecurityCommon.storage_id_token);""!==e&&void 0!==e&&null!==e&&(t.oidcSecurityValidation.isTokenExpired(t.oidcSecurityCommon.retrieve(t.oidcSecurityCommon.storage_id_token))?(t.oidcSecurityCommon.logDebug("IsAuthorized: id_token isTokenExpired, start silent renew if active"),t.authConfiguration.silent_renew&&t.refreshSession().then(function(t){})):t.refreshSession().then(function(t){}))}else t.resetAuthorizationData(!1)},function(e){t.oidcSecurityCommon.logError("Error: "+e)},function(){t.oidcSecurityCommon.logDebug("Completed")}),t._isAuthorizedValue){var i=t.oidcSecurityCommon.retrieve(t.oidcSecurityCommon.storage_id_token);""!==i&&void 0!==i&&null!==i?t.oidcSecurityValidation.isTokenExpired(t.oidcSecurityCommon.retrieve(t.oidcSecurityCommon.storage_id_token))?(t.oidcSecurityCommon.logDebug("IsAuthorized: id_token isTokenExpired, start silent renew if active"),t.authConfiguration.silent_renew?t.refreshSession().then(function(t){e()}):(t.resetAuthorizationData(!1),e())):t.refreshSession().then(function(t){e()}):t.refreshSession().then(function(t){e()})}else t.resetAuthorizationData(!1),e()})},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:Object,decorators:[{type:e.Inject,args:[e.PLATFORM_ID]}]},{type:i.Http},{type:zf},{type:a.Router},{type:qf},{type:Bf},{type:Kf},{type:Mf},{type:Uf}]},t.propDecorators={onModuleSetup:[{type:e.Output}]},t}(),Yf=function(){function t(){}return t.forRoot=function(e){return void 0===e&&(e={}),{ngModule:t,providers:[Hf,Lf,qf,Bf,Kf,Mf,zf,Vf,Uf,{provide:Rf,useClass:e.storage||Wf}]}},t.forChild=function(e){return void 0===e&&(e={}),{ngModule:t,providers:[Hf,Lf,qf,Bf,Kf,Mf,zf,Uf,{provide:Rf,useClass:e.storage||Wf}]}},t.decorators=[{type:e.NgModule}],t.ctorParameters=function(){return[]},t}();t.AuthModule=Yf,t.NgModule=e.NgModule,t.OidcSecurityService=Hf,t.OidcSecurityValidation=Lf,t.OidcSecurityCheckSession=qf,t.OidcSecuritySilentRenew=Bf,t.OidcSecurityUserService=Kf,t.OidcSecurityCommon=Mf,t.OidcSecurityStorage=Rf,t.BrowserStorage=Wf,t.AuthWellKnownEndpoints=Uf,t.AuthConfiguration=zf,t.OpenIDImplicitFlowConfiguration=Df,t.DefaultConfiguration=Vf,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=angular-auth-oidc-client.umd.min.js.map
